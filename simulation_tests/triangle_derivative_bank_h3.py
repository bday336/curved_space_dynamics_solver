# Triangle Derivative Bank

from numpy import *

###############
##### H3 ######
###############

## Rigid Triangle ##

## RadauIIA s2 ##

def h3rads2triex1(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a1c1 - a1n - dt*(a11*ad1c1 + a12*ad1c2)

    da1c1term   = 1.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = -a11*dt
    dad1c2term  = -a12*dt
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex2(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a1c2 - a1n - dt*(a21*ad1c1 + a22*ad1c2)

    da1c1term   = 0.
    da1c2term   = 1.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = -a21*dt
    dad1c2term  = -a22*dt
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex3(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b1c1 - b1n - dt*(a11*bd1c1 + a12*bd1c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 1.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = -a11*dt
    dbd1c2term  = -a12*dt
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex4(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b1c2 - b1n - dt*(a21*bd1c1 + a22*bd1c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 1.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = -a21*dt
    dbd1c2term  = -a22*dt
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex5(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a11*gd1c1 + a12*gd1c2) + g1c1 - g1n

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 1.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = -a11*dt
    dgd1c2term  = -a12*dt
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex6(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a21*gd1c1 + a22*gd1c2) + g1c2 - g1n

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 1.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = -a21*dt
    dgd1c2term  = -a22*dt
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex7(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a2c1 - a2n - dt*(a11*ad2c1 + a12*ad2c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 1.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = -a11*dt
    dad2c2term  = -a12*dt
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex8(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a2c2 - a2n - dt*(a21*ad2c1 + a22*ad2c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 1.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = -a21*dt
    dad2c2term  = -a22*dt
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex9(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b2c1 - b2n - dt*(a11*bd2c1 + a12*bd2c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 1.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = -a11*dt
    dbd2c2term  = -a12*dt
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex10(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b2c2 - b2n - dt*(a21*bd2c1 + a22*bd2c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 1.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = -a21*dt
    dbd2c2term  = -a22*dt
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex11(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a11*gd2c1 + a12*gd2c2) + g2c1 - g2n

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 1.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = -a11*dt
    dgd2c2term  = -a12*dt
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex12(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a21*gd2c1 + a22*gd2c2) + g2c2 - g2n

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 1.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = -a21*dt
    dgd2c2term  = -a22*dt
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex13(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a3c1 - a3n - dt*(a11*ad3c1 + a12*ad3c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 1.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = -a11*dt
    dad3c2term  = -a12*dt
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex14(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a3c2 - a3n - dt*(a21*ad3c1 + a22*ad3c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 1.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = -a21*dt
    dad3c2term  = -a22*dt
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex15(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b3c1 - b3n - dt*(a11*bd3c1 + a12*bd3c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 1.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = -a11*dt
    dbd3c2term  = -a12*dt
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex16(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b3c2 - b3n - dt*(a21*bd3c1 + a22*bd3c2)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 1.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = -a21*dt
    dbd3c2term  = -a22*dt
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex17(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a11*gd3c1 + a12*gd3c2) + g3c1 - g3n

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 1.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = -a11*dt
    dgd3c2term  = -a12*dt
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex18(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a21*gd3c1 + a22*gd3c2) + g3c2 - g3n

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 1.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = -a21*dt
    dgd3c2term  = -a22*dt
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex19(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ad1c1 - ad1n - dt*(a11*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd1c1**2.0 + gd1c1**2.0*sin(b1c1)**2.0)*sinh(2.0*a1c1)) + a12*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd1c2**2.0 + gd1c2**2.0*sin(b1c2)**2.0)*sinh(2.0*a1c2)))

    da1c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c1**2.0 + 0.5*gd1c1**2.0*sin(b1c1)**2.0)*cosh(2.0*a1c1))
    da1c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c2**2.0 + 0.5*gd1c2**2.0*sin(b1c2)**2.0)*cosh(2.0*a1c2))
    db1c1term   = -a11*dt*(1.0*gd1c1**2.0*sin(b1c1)**1.0*cos(b1c1)*sinh(2.0*a1c1) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(1.0*gd1c2**2.0*sin(b1c2)**1.0*cos(b1c2)*sinh(2.0*a1c2) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a11*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg2c1term   = -a11*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 1.
    dad1c2term  = 0.
    dbd1c1term  = -1.0*a11*bd1c1**1.0*dt*sinh(2.0*a1c1)
    dbd1c2term  = -1.0*a12*bd1c2**1.0*dt*sinh(2.0*a1c2)
    dgd1c1term  = -1.0*a11*dt*gd1c1**1.0*sin(b1c1)**2.0*sinh(2.0*a1c1)
    dgd1c2term  = -1.0*a12*dt*gd1c2**1.0*sin(b1c2)**2.0*sinh(2.0*a1c2)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a11*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = a11*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex20(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ad1c2 - ad1n - dt*(a21*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd1c1**2.0 + gd1c1**2.0*sin(b1c1)**2.0)*sinh(2.0*a1c1)) + a22*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd1c2**2.0 + gd1c2**2.0*sin(b1c2)**2.0)*sinh(2.0*a1c2)))

    da1c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c1**2.0 + 0.5*gd1c1**2.0*sin(b1c1)**2.0)*cosh(2.0*a1c1))
    da1c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c2**2.0 + 0.5*gd1c2**2.0*sin(b1c2)**2.0)*cosh(2.0*a1c2))
    db1c1term   = -a21*dt*(1.0*gd1c1**2.0*sin(b1c1)**1.0*cos(b1c1)*sinh(2.0*a1c1) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(1.0*gd1c2**2.0*sin(b1c2)**1.0*cos(b1c2)*sinh(2.0*a1c2) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a21*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg2c1term   = -a21*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 1.
    dbd1c1term  = -1.0*a21*bd1c1**1.0*dt*sinh(2.0*a1c1)
    dbd1c2term  = -1.0*a22*bd1c2**1.0*dt*sinh(2.0*a1c2)
    dgd1c1term  = -1.0*a21*dt*gd1c1**1.0*sin(b1c1)**2.0*sinh(2.0*a1c1)
    dgd1c2term  = -1.0*a22*dt*gd1c2**1.0*sin(b1c2)**2.0*sinh(2.0*a1c2)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a21*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = a21*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex21(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = bd1c1 - bd1n - dt*(a11*(-2.0*ad1c1*bd1c1/tanh(a1c1) + 0.5*gd1c1**2*sin(2.0*b1c1) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad1c2*bd1c2/tanh(a1c2) + 0.5*gd1c2**2*sin(2.0*b1c2) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))))

    da1c1term   = -a11*dt*(-2.0*ad1c1*bd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 2.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a12*dt*(-2.0*ad1c2*bd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 2.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1c1term   = -a11*dt*(1.0*gd1c1**2*cos(2.0*b1c1) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(1.0*gd1c2**2*cos(2.0*b1c2) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a11*dt*(1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a12*dt*(1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da2c1term   = -a11*dt*(lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da2c2term   = -a12*dt*(lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db2c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg2c1term   = -a11*dt*(-1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg2c2term   = -a12*dt*(-1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da3c1term   = -a11*dt*(lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a12*dt*(lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db3c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3c1term   = -a11*dt*(-1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a12*dt*(-1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dad1c1term  = 2.0*a11*bd1c1*dt/tanh(a1c1)
    dad1c2term  = 2.0*a12*bd1c2*dt/tanh(a1c2)
    dbd1c1term  = 2.0*a11*ad1c1*dt/tanh(a1c1) + 1
    dbd1c2term  = 2.0*a12*ad1c2*dt/tanh(a1c2)
    dgd1c1term  = -1.0*a11*dt*gd1c1*sin(2.0*b1c1)
    dgd1c2term  = -1.0*a12*dt*gd1c2*sin(2.0*b1c2)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a11*dt*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = a11*dt*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex22(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = bd1c2 - bd1n - dt*(a21*(-2.0*ad1c1*bd1c1/tanh(a1c1) + 0.5*gd1c1**2*sin(2.0*b1c1) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad1c2*bd1c2/tanh(a1c2) + 0.5*gd1c2**2*sin(2.0*b1c2) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))))

    da1c1term   = -a21*dt*(-2.0*ad1c1*bd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 2.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a22*dt*(-2.0*ad1c2*bd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 2.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1c1term   = -a21*dt*(1.0*gd1c1**2*cos(2.0*b1c1) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(1.0*gd1c2**2*cos(2.0*b1c2) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a21*dt*(1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a22*dt*(1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da2c1term   = -a21*dt*(lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da2c2term   = -a22*dt*(lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db2c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg2c1term   = -a21*dt*(-1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg2c2term   = -a22*dt*(-1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da3c1term   = -a21*dt*(lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a22*dt*(lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db3c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3c1term   = -a21*dt*(-1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a22*dt*(-1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dad1c1term  = 2.0*a21*bd1c1*dt/tanh(a1c1)
    dad1c2term  = 2.0*a22*bd1c2*dt/tanh(a1c2)
    dbd1c1term  = 2.0*a21*ad1c1*dt/tanh(a1c1)
    dbd1c2term  = 2.0*a22*ad1c2*dt/tanh(a1c2) + 1
    dgd1c1term  = -1.0*a21*dt*gd1c1*sin(2.0*b1c1)
    dgd1c2term  = -1.0*a22*dt*gd1c2*sin(2.0*b1c2)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a21*dt*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = a21*dt*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex23(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a11*(-2.0*ad1c1*gd1c1/tanh(a1c1) - 2.0*bd1c1*gd1c1/tan(b1c1) - lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad1c2*gd1c2/tanh(a1c2) - 2.0*bd1c2*gd1c2/tan(b1c2) - lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))) + gd1c1 - gd1n

    da1c1term   = -a11*dt*(-2.0*ad1c1*gd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 1.0*lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-2.0)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-2.0)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(-2.0*ad1c2*gd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 1.0*lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-2.0)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-2.0)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(-2.0*bd1c1*gd1c1*(-tan(b1c1)**2 - 1)/tan(b1c1)**2 + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam1c1*sin(b1c1)**(-2.0)*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-2.0)*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(-2.0*bd1c2*gd1c2*(-tan(b1c2)**2 - 1)/tan(b1c2)**2 + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam1c2*sin(b1c2)**(-2.0)*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-2.0)*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a11*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*cosh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*cosh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg2c1term   = -a11*dt*(lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*cosh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*cosh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 2.0*a11*dt*gd1c1/tanh(a1c1)
    dad1c2term  = 2.0*a12*dt*gd1c2/tanh(a1c2)
    dbd1c1term  = 2.0*a11*dt*gd1c1/tan(b1c1)
    dbd1c2term  = 2.0*a12*dt*gd1c2/tan(b1c2)
    dgd1c1term  = -a11*dt*(-2.0*ad1c1/tanh(a1c1) - 2.0*bd1c1/tan(b1c1)) + 1
    dgd1c2term  = -a12*dt*(-2.0*ad1c2/tanh(a1c2) - 2.0*bd1c2/tan(b1c2))
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a11*dt*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = a11*dt*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex24(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a21*(-2.0*ad1c1*gd1c1/tanh(a1c1) - 2.0*bd1c1*gd1c1/tan(b1c1) - lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad1c2*gd1c2/tanh(a1c2) - 2.0*bd1c2*gd1c2/tan(b1c2) - lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))) + gd1c2 - gd1n

    da1c1term   = -a21*dt*(-2.0*ad1c1*gd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 1.0*lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-2.0)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-2.0)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(-2.0*ad1c2*gd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 1.0*lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-2.0)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-2.0)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(-2.0*bd1c1*gd1c1*(-tan(b1c1)**2 - 1)/tan(b1c1)**2 + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam1c1*sin(b1c1)**(-2.0)*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-2.0)*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(-2.0*bd1c2*gd1c2*(-tan(b1c2)**2 - 1)/tan(b1c2)**2 + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam1c2*sin(b1c2)**(-2.0)*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-2.0)*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a21*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*cosh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*cosh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg2c1term   = -a21*dt*(lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*cosh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*cosh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 2.0*a21*dt*gd1c1/tanh(a1c1)
    dad1c2term  = 2.0*a22*dt*gd1c2/tanh(a1c2)
    dbd1c1term  = 2.0*a21*dt*gd1c1/tan(b1c1)
    dbd1c2term  = 2.0*a22*dt*gd1c2/tan(b1c2)
    dgd1c1term  = -a21*dt*(-2.0*ad1c1/tanh(a1c1) - 2.0*bd1c1/tan(b1c1))
    dgd1c2term  = -a22*dt*(-2.0*ad1c2/tanh(a1c2) - 2.0*bd1c2/tan(b1c2)) + 1
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a21*dt*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = a21*dt*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex25(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ad2c1 - ad2n - dt*(a11*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd2c1**2.0 + gd2c1**2.0*sin(b2c1)**2.0)*sinh(2.0*a2c1)) + a12*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd2c2**2.0 + gd2c2**2.0*sin(b2c2)**2.0)*sinh(2.0*a2c2)))

    da1c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg1c1term   = -a11*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c1**2.0 + 0.5*gd2c1**2.0*sin(b2c1)**2.0)*cosh(2.0*a2c1))
    da2c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c2**2.0 + 0.5*gd2c2**2.0*sin(b2c2)**2.0)*cosh(2.0*a2c2))
    db2c1term   = -a11*dt*(1.0*gd2c1**2.0*sin(b2c1)**1.0*cos(b2c1)*sinh(2.0*a2c1) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(1.0*gd2c2**2.0*sin(b2c2)**1.0*cos(b2c2)*sinh(2.0*a2c2) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a11*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 1.
    dad2c2term  = 0.
    dbd2c1term  = -1.0*a11*bd2c1**1.0*dt*sinh(2.0*a2c1)
    dbd2c2term  = -1.0*a12*bd2c2**1.0*dt*sinh(2.0*a2c2)
    dgd2c1term  = -1.0*a11*dt*gd2c1**1.0*sin(b2c1)**2.0*sinh(2.0*a2c1)
    dgd2c2term  = -1.0*a12*dt*gd2c2**1.0*sin(b2c2)**2.0*sinh(2.0*a2c2)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a11*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = a11*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex26(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ad2c2 - ad2n - dt*(a21*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd2c1**2.0 + gd2c1**2.0*sin(b2c1)**2.0)*sinh(2.0*a2c1)) + a22*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd2c2**2.0 + gd2c2**2.0*sin(b2c2)**2.0)*sinh(2.0*a2c2)))

    da1c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg1c1term   = -a21*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c1**2.0 + 0.5*gd2c1**2.0*sin(b2c1)**2.0)*cosh(2.0*a2c1))
    da2c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c2**2.0 + 0.5*gd2c2**2.0*sin(b2c2)**2.0)*cosh(2.0*a2c2))
    db2c1term   = -a21*dt*(1.0*gd2c1**2.0*sin(b2c1)**1.0*cos(b2c1)*sinh(2.0*a2c1) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(1.0*gd2c2**2.0*sin(b2c2)**1.0*cos(b2c2)*sinh(2.0*a2c2) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a21*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 1.
    dbd2c1term  = -1.0*a21*bd2c1**1.0*dt*sinh(2.0*a2c1)
    dbd2c2term  = -1.0*a22*bd2c2**1.0*dt*sinh(2.0*a2c2)
    dgd2c1term  = -1.0*a21*dt*gd2c1**1.0*sin(b2c1)**2.0*sinh(2.0*a2c1)
    dgd2c2term  = -1.0*a22*dt*gd2c2**1.0*sin(b2c2)**2.0*sinh(2.0*a2c2)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a21*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = a21*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex27(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = bd2c1 - bd2n - dt*(a11*(-2.0*ad2c1*bd2c1/tanh(a2c1) + 0.5*gd2c1**2*sin(2.0*b2c1) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad2c2*bd2c2/tanh(a2c2) + 0.5*gd2c2**2*sin(2.0*b2c2) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))))

    da1c1term   = -a11*dt*(lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da1c2term   = -a12*dt*(lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db1c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg1c1term   = -a11*dt*(1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg1c2term   = -a12*dt*(1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da2c1term   = -a11*dt*(-2.0*ad2c1*bd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 + 2.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a12*dt*(-2.0*ad2c2*bd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 + 2.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2c1term   = -a11*dt*(1.0*gd2c1**2*cos(2.0*b2c1) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(1.0*gd2c2**2*cos(2.0*b2c2) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a11*dt*(-1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a12*dt*(-1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3c1term   = -a11*dt*(lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a12*dt*(lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3c1term   = -a11*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a12*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3c1term   = -a11*dt*(-1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a12*dt*(-1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 2.0*a11*bd2c1*dt/tanh(a2c1)
    dad2c2term  = 2.0*a12*bd2c2*dt/tanh(a2c2)
    dbd2c1term  = 2.0*a11*ad2c1*dt/tanh(a2c1) + 1
    dbd2c2term  = 2.0*a12*ad2c2*dt/tanh(a2c2)
    dgd2c1term  = -1.0*a11*dt*gd2c1*sin(2.0*b2c1)
    dgd2c2term  = -1.0*a12*dt*gd2c2*sin(2.0*b2c2)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a11*dt*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = a11*dt*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex28(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = bd2c2 - bd2n - dt*(a21*(-2.0*ad2c1*bd2c1/tanh(a2c1) + 0.5*gd2c1**2*sin(2.0*b2c1) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad2c2*bd2c2/tanh(a2c2) + 0.5*gd2c2**2*sin(2.0*b2c2) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))))

    da1c1term   = -a21*dt*(lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da1c2term   = -a22*dt*(lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db1c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg1c1term   = -a21*dt*(1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg1c2term   = -a22*dt*(1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da2c1term   = -a21*dt*(-2.0*ad2c1*bd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 + 2.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a22*dt*(-2.0*ad2c2*bd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 + 2.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2c1term   = -a21*dt*(1.0*gd2c1**2*cos(2.0*b2c1) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(1.0*gd2c2**2*cos(2.0*b2c2) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a21*dt*(-1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a22*dt*(-1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3c1term   = -a21*dt*(lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a22*dt*(lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3c1term   = -a21*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a22*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3c1term   = -a21*dt*(-1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a22*dt*(-1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 2.0*a21*bd2c1*dt/tanh(a2c1)
    dad2c2term  = 2.0*a22*bd2c2*dt/tanh(a2c2)
    dbd2c1term  = 2.0*a21*ad2c1*dt/tanh(a2c1)
    dbd2c2term  = 2.0*a22*ad2c2*dt/tanh(a2c2) + 1
    dgd2c1term  = -1.0*a21*dt*gd2c1*sin(2.0*b2c1)
    dgd2c2term  = -1.0*a22*dt*gd2c2*sin(2.0*b2c2)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = a21*dt*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = a21*dt*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex29(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a11*(-2.0*ad2c1*gd2c1/tanh(a2c1) - 2.0*bd2c1*gd2c1/tan(b2c1) + lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad2c2*gd2c2/tanh(a2c2) - 2.0*bd2c2*gd2c2/tan(b2c2) + lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))) + gd2c1 - gd2n

    da1c1term   = -a11*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a2c1)**(-1.0)*cosh(a1c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a2c2)**(-1.0)*cosh(a1c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(-lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(-lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg1c1term   = -a11*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-2.0*ad2c1*gd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-2.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-2.0)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(-2.0*ad2c2*gd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-2.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-2.0)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(-2.0*bd2c1*gd2c1*(-tan(b2c1)**2 - 1)/tan(b2c1)**2 - lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-2.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-2.0)*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(-2.0*bd2c2*gd2c2*(-tan(b2c2)**2 - 1)/tan(b2c2)**2 - lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-2.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-2.0)*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a11*dt*(-lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(-lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*cosh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*cosh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 2.0*a11*dt*gd2c1/tanh(a2c1)
    dad2c2term  = 2.0*a12*dt*gd2c2/tanh(a2c2)
    dbd2c1term  = 2.0*a11*dt*gd2c1/tan(b2c1)
    dbd2c2term  = 2.0*a12*dt*gd2c2/tan(b2c2)
    dgd2c1term  = -a11*dt*(-2.0*ad2c1/tanh(a2c1) - 2.0*bd2c1/tan(b2c1)) + 1
    dgd2c2term  = -a12*dt*(-2.0*ad2c2/tanh(a2c2) - 2.0*bd2c2/tan(b2c2))
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = -a11*dt*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = -a12*dt*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = a11*dt*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex30(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a21*(-2.0*ad2c1*gd2c1/tanh(a2c1) - 2.0*bd2c1*gd2c1/tan(b2c1) + lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad2c2*gd2c2/tanh(a2c2) - 2.0*bd2c2*gd2c2/tan(b2c2) + lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))) + gd2c2 - gd2n

    da1c1term   = -a21*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a2c1)**(-1.0)*cosh(a1c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a2c2)**(-1.0)*cosh(a1c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(-lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(-lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg1c1term   = -a21*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-2.0*ad2c1*gd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-2.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-2.0)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(-2.0*ad2c2*gd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-2.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-2.0)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(-2.0*bd2c1*gd2c1*(-tan(b2c1)**2 - 1)/tan(b2c1)**2 - lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-2.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-2.0)*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(-2.0*bd2c2*gd2c2*(-tan(b2c2)**2 - 1)/tan(b2c2)**2 - lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-2.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-2.0)*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a21*dt*(-lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(-lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*cosh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*cosh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 2.0*a21*dt*gd2c1/tanh(a2c1)
    dad2c2term  = 2.0*a22*dt*gd2c2/tanh(a2c2)
    dbd2c1term  = 2.0*a21*dt*gd2c1/tan(b2c1)
    dbd2c2term  = 2.0*a22*dt*gd2c2/tan(b2c2)
    dgd2c1term  = -a21*dt*(-2.0*ad2c1/tanh(a2c1) - 2.0*bd2c1/tan(b2c1))
    dgd2c2term  = -a22*dt*(-2.0*ad2c2/tanh(a2c2) - 2.0*bd2c2/tan(b2c2)) + 1
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = -a21*dt*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = -a22*dt*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = a21*dt*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex31(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ad3c1 - ad3n - dt*(a11*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd3c1**2.0 + gd3c1**2.0*sin(b3c1)**2.0)*sinh(2.0*a3c1)) + a12*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd3c2**2.0 + gd3c2**2.0*sin(b3c2)**2.0)*sinh(2.0*a3c2)))

    da1c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a11*dt*(-lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(-lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a11*dt*(-lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(-lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c1**2.0 + 0.5*gd3c1**2.0*sin(b3c1)**2.0)*cosh(2.0*a3c1))
    da3c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c2**2.0 + 0.5*gd3c2**2.0*sin(b3c2)**2.0)*cosh(2.0*a3c2))
    db3c1term   = -a11*dt*(1.0*gd3c1**2.0*sin(b3c1)**1.0*cos(b3c1)*sinh(2.0*a3c1) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(1.0*gd3c2**2.0*sin(b3c2)**1.0*cos(b3c2)*sinh(2.0*a3c2) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 1.
    dad3c2term  = 0.
    dbd3c1term  = -1.0*a11*bd3c1**1.0*dt*sinh(2.0*a3c1)
    dbd3c2term  = -1.0*a12*bd3c2**1.0*dt*sinh(2.0*a3c2)
    dgd3c1term  = -1.0*a11*dt*gd3c1**1.0*sin(b3c1)**2.0*sinh(2.0*a3c1)
    dgd3c2term  = -1.0*a12*dt*gd3c2**1.0*sin(b3c2)**2.0*sinh(2.0*a3c2)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = a11*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = a11*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex32(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ad3c2 - ad3n - dt*(a21*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd3c1**2.0 + gd3c1**2.0*sin(b3c1)**2.0)*sinh(2.0*a3c1)) + a22*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd3c2**2.0 + gd3c2**2.0*sin(b3c2)**2.0)*sinh(2.0*a3c2)))

    da1c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a21*dt*(-lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(-lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a21*dt*(-lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(-lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c1**2.0 + 0.5*gd3c1**2.0*sin(b3c1)**2.0)*cosh(2.0*a3c1))
    da3c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c2**2.0 + 0.5*gd3c2**2.0*sin(b3c2)**2.0)*cosh(2.0*a3c2))
    db3c1term   = -a21*dt*(1.0*gd3c1**2.0*sin(b3c1)**1.0*cos(b3c1)*sinh(2.0*a3c1) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(1.0*gd3c2**2.0*sin(b3c2)**1.0*cos(b3c2)*sinh(2.0*a3c2) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 1.
    dbd3c1term  = -1.0*a21*bd3c1**1.0*dt*sinh(2.0*a3c1)
    dbd3c2term  = -1.0*a22*bd3c2**1.0*dt*sinh(2.0*a3c2)
    dgd3c1term  = -1.0*a21*dt*gd3c1**1.0*sin(b3c1)**2.0*sinh(2.0*a3c1)
    dgd3c2term  = -1.0*a22*dt*gd3c2**1.0*sin(b3c2)**2.0*sinh(2.0*a3c2)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = a21*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = a21*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex33(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = bd3c1 - bd3n - dt*(a11*(-2.0*ad3c1*bd3c1/tanh(a3c1) + 0.5*gd3c1**2*sin(2.0*b3c1) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad3c2*bd3c2/tanh(a3c2) + 0.5*gd3c2**2*sin(2.0*b3c2) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))))

    da1c1term   = -a11*dt*(lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a12*dt*(lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1c1term   = -a11*dt*(1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a12*dt*(1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da2c1term   = -a11*dt*(lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a12*dt*(lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2c1term   = -a11*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a12*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2c1term   = -a11*dt*(1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a12*dt*(1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3c1term   = -a11*dt*(-2.0*ad3c1*bd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 + 2.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 2.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a12*dt*(-2.0*ad3c2*bd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 + 2.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 2.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3c1term   = -a11*dt*(1.0*gd3c1**2*cos(2.0*b3c1) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a12*dt*(1.0*gd3c2**2*cos(2.0*b3c2) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3c1term   = -a11*dt*(-1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a12*dt*(-1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 2.0*a11*bd3c1*dt/tanh(a3c1)
    dad3c2term  = 2.0*a12*bd3c2*dt/tanh(a3c2)
    dbd3c1term  = 2.0*a11*ad3c1*dt/tanh(a3c1) + 1
    dbd3c2term  = 2.0*a12*ad3c2*dt/tanh(a3c2)
    dgd3c1term  = -1.0*a11*dt*gd3c1*sin(2.0*b3c1)
    dgd3c2term  = -1.0*a12*dt*gd3c2*sin(2.0*b3c2)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = a11*dt*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = a11*dt*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex34(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = bd3c2 - bd3n - dt*(a21*(-2.0*ad3c1*bd3c1/tanh(a3c1) + 0.5*gd3c1**2*sin(2.0*b3c1) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad3c2*bd3c2/tanh(a3c2) + 0.5*gd3c2**2*sin(2.0*b3c2) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))))

    da1c1term   = -a21*dt*(lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a22*dt*(lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1c1term   = -a21*dt*(1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a22*dt*(1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da2c1term   = -a21*dt*(lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a22*dt*(lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2c1term   = -a21*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a22*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2c1term   = -a21*dt*(1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a22*dt*(1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3c1term   = -a21*dt*(-2.0*ad3c1*bd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 + 2.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 2.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a22*dt*(-2.0*ad3c2*bd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 + 2.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 2.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3c1term   = -a21*dt*(1.0*gd3c1**2*cos(2.0*b3c1) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a22*dt*(1.0*gd3c2**2*cos(2.0*b3c2) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3c1term   = -a21*dt*(-1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a22*dt*(-1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 2.0*a21*bd3c1*dt/tanh(a3c1)
    dad3c2term  = 2.0*a22*bd3c2*dt/tanh(a3c2)
    dbd3c1term  = 2.0*a21*ad3c1*dt/tanh(a3c1)
    dbd3c2term  = 2.0*a22*ad3c2*dt/tanh(a3c2) + 1
    dgd3c1term  = -1.0*a21*dt*gd3c1*sin(2.0*b3c1)
    dgd3c2term  = -1.0*a22*dt*gd3c2*sin(2.0*b3c2)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = a21*dt*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = a21*dt*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex35(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a11*(-2.0*ad3c1*gd3c1/tanh(a3c1) - 2.0*bd3c1*gd3c1/tan(b3c1) + lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad3c2*gd3c2/tanh(a3c2) - 2.0*bd3c2*gd3c2/tan(b3c2) + lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))) + gd3c1 - gd3n

    da1c1term   = -a11*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a1c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a1c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(-lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(-lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a11*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a2c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a2c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(-lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(-lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a11*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-2.0*ad3c1*gd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-2.0*ad3c2*gd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(-2.0*bd3c1*gd3c1*(-tan(b3c1)**2 - 1)/tan(b3c1)**2 - lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-2.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-2.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(-2.0*bd3c2*gd3c2*(-tan(b3c2)**2 - 1)/tan(b3c2)**2 - lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-2.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-2.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a11*dt*(-lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(-lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 2.0*a11*dt*gd3c1/tanh(a3c1)
    dad3c2term  = 2.0*a12*dt*gd3c2/tanh(a3c2)
    dbd3c1term  = 2.0*a11*dt*gd3c1/tan(b3c1)
    dbd3c2term  = 2.0*a12*dt*gd3c2/tan(b3c2)
    dgd3c1term  = -a11*dt*(-2.0*ad3c1/tanh(a3c1) - 2.0*bd3c1/tan(b3c1)) + 1
    dgd3c2term  = -a12*dt*(-2.0*ad3c2/tanh(a3c2) - 2.0*bd3c2/tan(b3c2))
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = -a11*dt*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = -a12*dt*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = -a11*dt*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = -a12*dt*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex36(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a21*(-2.0*ad3c1*gd3c1/tanh(a3c1) - 2.0*bd3c1*gd3c1/tan(b3c1) + lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad3c2*gd3c2/tanh(a3c2) - 2.0*bd3c2*gd3c2/tan(b3c2) + lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))) + gd3c2 - gd3n

    da1c1term   = -a21*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a1c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a1c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(-lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(-lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1c1term   = -a21*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a2c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a2c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(-lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(-lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2c1term   = -a21*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-2.0*ad3c1*gd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-2.0*ad3c2*gd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(-2.0*bd3c1*gd3c1*(-tan(b3c1)**2 - 1)/tan(b3c1)**2 - lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-2.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-2.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(-2.0*bd3c2*gd3c2*(-tan(b3c2)**2 - 1)/tan(b3c2)**2 - lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-2.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-2.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3c1term   = -a21*dt*(-lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(-lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 2.0*a21*dt*gd3c1/tanh(a3c1)
    dad3c2term  = 2.0*a22*dt*gd3c2/tanh(a3c2)
    dbd3c1term  = 2.0*a21*dt*gd3c1/tan(b3c1)
    dbd3c2term  = 2.0*a22*dt*gd3c2/tan(b3c2)
    dgd3c1term  = -a21*dt*(-2.0*ad3c1/tanh(a3c1) - 2.0*bd3c1/tan(b3c1))
    dgd3c2term  = -a22*dt*(-2.0*ad3c2/tanh(a3c2) - 2.0*bd3c2/tan(b3c2)) + 1
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = -a21*dt*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = -a22*dt*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam3c1term = -a21*dt*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = -a22*dt*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex37(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -leq1 + arccosh(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))

    da1c1term   = 0.
    da1c2term   = (-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2 - 1)
    db1c1term   = 0.
    db1c2term   = (sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2 - 1)
    dg1c1term   = 0.
    dg1c2term   = sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2 - 1)
    da2c1term   = 0.
    da2c2term   = (-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2 - 1)
    db2c1term   = 0.
    db2c2term   = (-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2 - 1)
    dg2c1term   = 0.
    dg2c2term   = -sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2 - 1)
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex38(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*sinh(a1c2)*cosh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)

    da1c1term   = 0.
    da1c2term   = -((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*sinh(a1c2)*cosh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))/(2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + ((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*cosh(a1c2)*cosh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*sinh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*cosh(a1c2))*sinh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    db1c1term   = 0.
    db1c2term   = -((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*sinh(a1c2)*cosh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0/(2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + (-ad2c2*(-sin(b1c2)*cos(b2c2) + sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2))*sinh(a1c2)*cosh(a2c2) + (-ad1c2*(-sin(b1c2)*cos(b2c2) + sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2))*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*cos(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(g1c2 - g2c2)*cos(b1c2) - (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*sin(b1c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    dg1c1term   = 0.
    dg1c2term   = -1.0*((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*sinh(a1c2)*cosh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2) + (ad2c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + (ad1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*cosh(a1c2) + (bd2c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2) + (bd1c2*sin(g1c2 - g2c2)*cos(b1c2) + (gd1c2 - gd2c2)*sin(b1c2)*cos(g1c2 - g2c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    da2c1term   = 0.
    da2c2term   = ((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*sinh(a1c2)*sinh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*sinh(a1c2))*cosh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1) - ((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*sinh(a1c2)*cosh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))/(2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2))
    db2c1term   = 0.
    db2c2term   = -((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*sinh(a1c2)*cosh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0/(2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + (-ad2c2*(sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2) - sin(b2c2)*cos(b1c2))*sinh(a1c2)*cosh(a2c2) + (-ad1c2*(sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2) - sin(b2c2)*cos(b1c2))*cosh(a1c2) + (-(bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*sin(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*cos(b2c2))*sinh(a1c2))*sinh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    dg2c1term   = 0.
    dg2c2term   = 1.0*((ad1c2 - ad2c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)))*sinh(a1c2)*cosh(a2c2) + ((-ad1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) + cos(b1c2)*cos(b2c2)) + ad2c2)*cosh(a1c2) + ((bd1c2 - bd2c2*cos(g1c2 - g2c2))*sin(b1c2)*cos(b2c2) + ((gd1c2 - gd2c2)*sin(b1c2)*sin(g1c2 - g2c2) + (-bd1c2*cos(g1c2 - g2c2) + bd2c2)*cos(b1c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2) + (-ad2c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + (-ad1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*cosh(a1c2) + (-bd2c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2) + (-bd1c2*sin(g1c2 - g2c2)*cos(b1c2) - (gd1c2 - gd2c2)*sin(b1c2)*cos(g1c2 - g2c2))*sin(b2c2))*sinh(a1c2))*sinh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    da3c1term   = 0.
    da3c2term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dad1c1term  = 0.
    dad1c2term  = ((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) - cos(b1c2)*cos(b2c2))*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    dbd1c1term  = 0.
    dbd1c2term  = (sin(b1c2)*cos(b2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2))*sinh(a1c2)*sinh(a2c2)/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    dgd1c1term  = 0.
    dgd1c2term  = sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    dad2c1term  = 0.
    dad2c2term  = ((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2) - cos(b1c2)*cos(b2c2))*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    dbd2c1term  = 0.
    dbd2c2term  = (-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2) + sin(b2c2)*cos(b1c2))*sinh(a1c2)*sinh(a2c2)/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    dgd2c1term  = 0.
    dgd2c2term  = -sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex39(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -leq2 + arccosh(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))

    da1c1term   = 0.
    da1c2term   = (-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2 - 1)
    db1c1term   = 0.
    db1c2term   = (sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2 - 1)
    dg1c1term   = 0.
    dg1c2term   = sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2 - 1)
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = (-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2 - 1)
    db3c1term   = 0.
    db3c2term   = (-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2 - 1)
    dg3c1term   = 0.
    dg3c2term   = -sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2 - 1)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex40(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*sinh(a1c2)*cosh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)

    da1c1term   = 0.
    da1c2term   = -((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*sinh(a1c2)*cosh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))/(2*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + ((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*cosh(a1c2)*cosh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*sinh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*cosh(a1c2))*sinh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    db1c1term   = 0.
    db1c2term   = -((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*sinh(a1c2)*cosh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0/(2*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + (-ad3c2*(-sin(b1c2)*cos(b3c2) + sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2))*sinh(a1c2)*cosh(a3c2) + (-ad1c2*(-sin(b1c2)*cos(b3c2) + sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2))*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*cos(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(g1c2 - g3c2)*cos(b1c2) - (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*sin(b1c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dg1c1term   = 0.
    dg1c2term   = -1.0*((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*sinh(a1c2)*cosh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2) + (ad3c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + (ad1c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*cosh(a1c2) + (bd3c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2) + (bd1c2*sin(g1c2 - g3c2)*cos(b1c2) + (gd1c2 - gd3c2)*sin(b1c2)*cos(g1c2 - g3c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    da2c1term   = 0.
    da2c2term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    da3c1term   = 0.
    da3c2term   = ((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*sinh(a1c2)*sinh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*sinh(a1c2))*cosh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1) - ((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*sinh(a1c2)*cosh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))/(2*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2))
    db3c1term   = 0.
    db3c2term   = -((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*sinh(a1c2)*cosh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0/(2*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + (-ad3c2*(sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2) - sin(b3c2)*cos(b1c2))*sinh(a1c2)*cosh(a3c2) + (-ad1c2*(sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2) - sin(b3c2)*cos(b1c2))*cosh(a1c2) + (-(bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*sin(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*cos(b3c2))*sinh(a1c2))*sinh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dg3c1term   = 0.
    dg3c2term   = 1.0*((ad1c2 - ad3c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)))*sinh(a1c2)*cosh(a3c2) + ((-ad1c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) + cos(b1c2)*cos(b3c2)) + ad3c2)*cosh(a1c2) + ((bd1c2 - bd3c2*cos(g1c2 - g3c2))*sin(b1c2)*cos(b3c2) + ((gd1c2 - gd3c2)*sin(b1c2)*sin(g1c2 - g3c2) + (-bd1c2*cos(g1c2 - g3c2) + bd3c2)*cos(b1c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2) + (-ad3c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + (-ad1c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*cosh(a1c2) + (-bd3c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2) + (-bd1c2*sin(g1c2 - g3c2)*cos(b1c2) - (gd1c2 - gd3c2)*sin(b1c2)*cos(g1c2 - g3c2))*sin(b3c2))*sinh(a1c2))*sinh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dad1c1term  = 0.
    dad1c2term  = ((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) - cos(b1c2)*cos(b3c2))*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dbd1c1term  = 0.
    dbd1c2term  = (sin(b1c2)*cos(b3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2))*sinh(a1c2)*sinh(a3c2)/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dgd1c1term  = 0.
    dgd1c2term  = sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = ((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2) - cos(b1c2)*cos(b3c2))*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dbd3c1term  = 0.
    dbd3c2term  = (-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2) + sin(b3c2)*cos(b1c2))*sinh(a1c2)*sinh(a3c2)/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dgd3c1term  = 0.
    dgd3c2term  = -sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex41(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -leq3 + arccosh(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = (-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2 - 1)
    db2c1term   = 0.
    db2c2term   = (sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2 - 1)
    dg2c1term   = 0.
    dg2c2term   = sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2 - 1)
    da3c1term   = 0.
    da3c2term   = (-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2 - 1)
    db3c1term   = 0.
    db3c2term   = (-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2 - 1)
    dg3c1term   = 0.
    dg3c2term   = -sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2 - 1)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

def h3rads2triex42(stepn,stepc1,stepc2,dt,params):
    # Set to run RadauIIA 2-stage method
    a11,a12 = [5./12., -1./12.]
    a21,a22 = [3./4., 1./4.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = ((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*sinh(a2c2)*cosh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)

    da1c1term   = 0.
    da1c2term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    da2c1term   = 0.
    da2c2term   = -((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*sinh(a2c2)*cosh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))/(2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + ((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*cosh(a2c2)*cosh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*sinh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*cosh(a2c2))*sinh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    db2c1term   = 0.
    db2c2term   = -((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*sinh(a2c2)*cosh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0/(2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + (-ad3c2*(-sin(b2c2)*cos(b3c2) + sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2))*sinh(a2c2)*cosh(a3c2) + (-ad2c2*(-sin(b2c2)*cos(b3c2) + sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2))*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*cos(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(g2c2 - g3c2)*cos(b2c2) - (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*sin(b2c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dg2c1term   = 0.
    dg2c2term   = -1.0*((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*sinh(a2c2)*cosh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2) + (ad3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + (ad2c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*cosh(a2c2) + (bd3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2) + (bd2c2*sin(g2c2 - g3c2)*cos(b2c2) + (gd2c2 - gd3c2)*sin(b2c2)*cos(g2c2 - g3c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    da3c1term   = 0
    da3c2term   = ((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*sinh(a2c2)*sinh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*sinh(a2c2))*cosh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1) - ((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*sinh(a2c2)*cosh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))/(2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2))
    db3c1term   = 0
    db3c2term   = -((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*sinh(a2c2)*cosh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0/(2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + (-ad3c2*(sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2) - sin(b3c2)*cos(b2c2))*sinh(a2c2)*cosh(a3c2) + (-ad2c2*(sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2) - sin(b3c2)*cos(b2c2))*cosh(a2c2) + (-(bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*sin(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*cos(b3c2))*sinh(a2c2))*sinh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dg3c1term   = 0
    dg3c2term   = 1.0*((ad2c2 - ad3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)))*sinh(a2c2)*cosh(a3c2) + ((-ad2c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) + cos(b2c2)*cos(b3c2)) + ad3c2)*cosh(a2c2) + ((bd2c2 - bd3c2*cos(g2c2 - g3c2))*sin(b2c2)*cos(b3c2) + ((gd2c2 - gd3c2)*sin(b2c2)*sin(g2c2 - g3c2) + (-bd2c2*cos(g2c2 - g3c2) + bd3c2)*cos(b2c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2) + (-ad3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + (-ad2c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*cosh(a2c2) + (-bd3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2) + (-bd2c2*sin(g2c2 - g3c2)*cos(b2c2) - (gd2c2 - gd3c2)*sin(b2c2)*cos(g2c2 - g3c2))*sin(b3c2))*sinh(a2c2))*sinh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dad1c1term  = 0
    dad1c2term  = 0
    dbd1c1term  = 0
    dbd1c2term  = 0
    dgd1c1term  = 0
    dgd1c2term  = 0
    dad2c1term  = 0
    dad2c2term  = ((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) - cos(b2c2)*cos(b3c2))*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dbd2c1term  = 0
    dbd2c2term  = (sin(b2c2)*cos(b3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2))*sinh(a2c2)*sinh(a3c2)/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dgd2c1term  = 0
    dgd2c2term  = sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dad3c1term  = 0
    dad3c2term  = ((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2) - cos(b2c2)*cos(b3c2))*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dbd3c1term  = 0
    dbd3c2term  = (-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2) + sin(b3c2)*cos(b2c2))*sinh(a2c2)*sinh(a3c2)/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dgd3c1term  = 0
    dgd3c2term  = -sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)
    dlam1c1term = 0
    dlam1c2term = 0
    dlam2c1term = 0
    dlam2c2term = 0
    dlam3c1term = 0
    dlam3c2term = 0

    derivterms = [da1c1term,da1c2term,
                   db1c1term,db1c2term, 
                   dg1c1term,dg1c2term, 
                   da2c1term,da2c2term, 
                   db2c1term,db2c2term, 
                   dg2c1term,dg2c2term,  
                   da3c1term,da3c2term, 
                   db3c1term,db3c2term, 
                   dg3c1term,dg3c2term, 
                   dad1c1term,dad1c2term, 
                   dbd1c1term,dbd1c2term, 
                   dgd1c1term,dgd1c2term, 
                   dad2c1term,dad2c2term, 
                   dbd2c1term,dbd2c2term, 
                   dgd2c1term,dgd2c2term, 
                   dad3c1term,dad3c2term, 
                   dbd3c1term,dbd3c2term, 
                   dgd3c1term,dgd3c2term, 
                   dlam1c1term,dlam1c2term, 
                   dlam2c1term,dlam2c2term, 
                   dlam3c1term,dlam3c2term]

    return [mainterm, derivterms]

## RadauIIA s3 ##

def h3rads3triex1(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a1c1 - a1n - dt*(a11*ad1c1 + a12*ad1c2 + a13*ad1n1)

    da1c1term   = 1.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = -a11*dt
    dad1c2term  = -a12*dt
    dad1n1term  = -a13*dt
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex2(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a1c2 - a1n - dt*(a21*ad1c1 + a22*ad1c2 + a23*ad1n1)

    da1c1term   = 0.
    da1c2term   = 1.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = -a21*dt
    dad1c2term  = -a22*dt
    dad1n1term  = -a23*dt
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex3(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -a1n + a1n1 - dt*(a31*ad1c1 + a32*ad1c2 + a33*ad1n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 1.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = -a31*dt
    dad1c2term  = -a32*dt
    dad1n1term  = -a33*dt
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex4(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b1c1 - b1n - dt*(a11*bd1c1 + a12*bd1c2 + a13*bd1n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 1.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = -a11*dt
    dbd1c2term  = -a12*dt
    dbd1n1term  = -a13*dt
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex5(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b1c2 - b1n - dt*(a21*bd1c1 + a22*bd1c2 + a23*bd1n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 1.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = -a21*dt
    dbd1c2term  = -a22*dt
    dbd1n1term  = -a23*dt
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex6(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -b1n + b1n1 - dt*(a31*bd1c1 + a32*bd1c2 + a33*bd1n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 1.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = -a31*dt
    dbd1c2term  = -a32*dt
    dbd1n1term  = -a33*dt
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex7(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a11*gd1c1 + a12*gd1c2 + a13*gd1n1) + g1c1 - g1n

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 1.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = -a11*dt
    dgd1c2term  = -a12*dt
    dgd1n1term  = -a13*dt
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex8(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a21*gd1c1 + a22*gd1c2 + a23*gd1n1) + g1c2 - g1n

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 1.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = -a21*dt
    dgd1c2term  = -a22*dt
    dgd1n1term  = -a23*dt
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex9(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a31*gd1c1 + a32*gd1c2 + a33*gd1n1) - g1n + g1n1

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 1.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = -a31*dt
    dgd1c2term  = -a32*dt
    dgd1n1term  = -a33*dt
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex10(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a2c1 - a2n - dt*(a11*ad2c1 + a12*ad2c2 + a13*ad2n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 1.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = -a11*dt
    dad2c2term  = -a12*dt
    dad2n1term  = -a13*dt
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex11(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = a2c2 - a2n - dt*(a21*ad2c1 + a22*ad2c2 + a23*ad2n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 1.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = -a21*dt
    dad2c2term  = -a22*dt
    dad2n1term  = -a23*dt
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex12(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -a2n + a2n1 - dt*(a31*ad2c1 + a32*ad2c2 + a33*ad2n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 1.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = -a31*dt
    dad2c2term  = -a32*dt
    dad2n1term  = -a33*dt
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex13(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b2c1 - b2n - dt*(a11*bd2c1 + a12*bd2c2 + a13*bd2n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 1.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = -a11*dt
    dbd2c2term  = -a12*dt
    dbd2n1term  = -a13*dt
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex14(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = b2c2 - b2n - dt*(a21*bd2c1 + a22*bd2c2 + a23*bd2n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 1.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = -a21*dt
    dbd2c2term  = -a22*dt
    dbd2n1term  = -a23*dt
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex15(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -b2n + b2n1 - dt*(a31*bd2c1 + a32*bd2c2 + a33*bd2n1)

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 1.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = -a31*dt
    dbd2c2term  = -a32*dt
    dbd2n1term  = -a33*dt
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex16(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a11*gd2c1 + a12*gd2c2 + a13*gd2n1) + g2c1 - g2n

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 1.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = -a11*dt
    dgd2c2term  = -a12*dt
    dgd2n1term  = -a13*dt
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex17(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm = -dt*(a21*gd2c1 + a22*gd2c2 + a23*gd2n1) + g2c2 - g2n

    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 1.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = -a21*dt
    dgd2c2term  = -a22*dt
    dgd2n1term  = -a23*dt
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex18(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a31*gd2c1 + a32*gd2c2 + a33*gd2n1) - g2n + g2n1
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 1.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = -a31*dt
    dgd2c2term  = -a32*dt
    dgd2n1term  = -a33*dt
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex19(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = a3c1 - a3n - dt*(a11*ad3c1 + a12*ad3c2 + a13*ad3n1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 1.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = -a11*dt
    dad3c2term  = -a12*dt
    dad3n1term  = -a13*dt
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex20(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = a3c2 - a3n - dt*(a21*ad3c1 + a22*ad3c2 + a23*ad3n1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 1.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = -a21*dt
    dad3c2term  = -a22*dt
    dad3n1term  = -a23*dt
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex21(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -a3n + a3n1 - dt*(a31*ad3c1 + a32*ad3c2 + a33*ad3n1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 1.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = -a31*dt
    dad3c2term  = -a32*dt
    dad3n1term  = -a33*dt
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex22(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = b3c1 - b3n - dt*(a11*bd3c1 + a12*bd3c2 + a13*bd3n1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 1.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = -a11*dt
    dbd3c2term  = -a12*dt
    dbd3n1term  = -a13*dt
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex23(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = b3c2 - b3n - dt*(a21*bd3c1 + a22*bd3c2 + a23*bd3n1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 1.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = -a21*dt
    dbd3c2term  = -a22*dt
    dbd3n1term  = -a23*dt
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex24(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -b3n + b3n1 - dt*(a31*bd3c1 + a32*bd3c2 + a33*bd3n1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 1.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = -a31*dt
    dbd3c2term  = -a32*dt
    dbd3n1term  = -a33*dt
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex25(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a11*gd3c1 + a12*gd3c2 + a13*gd3n1) + g3c1 - g3n
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 1.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = -a11*dt
    dgd3c2term  = -a12*dt
    dgd3n1term  = -a13*dt
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex26(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a21*gd3c1 + a22*gd3c2 + a23*gd3n1) + g3c2 - g3n
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 1.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = -a21*dt
    dgd3c2term  = -a22*dt
    dgd3n1term  = -a23*dt
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex27(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a31*gd3c1 + a32*gd3c2 + a33*gd3n1) - g3n + g3n1
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 1.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = -a31*dt
    dgd3c2term  = -a32*dt
    dgd3n1term  = -a33*dt
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex28(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ad1c1 - ad1n - dt*(a11*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd1c1**2.0 + gd1c1**2.0*sin(b1c1)**2.0)*sinh(2.0*a1c1)) + a12*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd1c2**2.0 + gd1c2**2.0*sin(b1c2)**2.0)*sinh(2.0*a1c2)) + a13*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1)))
    da1c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c1**2.0 + 0.5*gd1c1**2.0*sin(b1c1)**2.0)*cosh(2.0*a1c1))
    da1c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c2**2.0 + 0.5*gd1c2**2.0*sin(b1c2)**2.0)*cosh(2.0*a1c2))
    da1n1term   = -a13*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1n1**2.0 + 0.5*gd1n1**2.0*sin(b1n1)**2.0)*cosh(2.0*a1n1))
    db1c1term   = -a11*dt*(1.0*gd1c1**2.0*sin(b1c1)**1.0*cos(b1c1)*sinh(2.0*a1c1) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(1.0*gd1c2**2.0*sin(b1c2)**1.0*cos(b1c2)*sinh(2.0*a1c2) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a13*dt*(1.0*gd1n1**2.0*sin(b1n1)**1.0*cos(b1n1)*sinh(2.0*a1n1) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a11*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a13*dt*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a13*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db2n1term   = -a13*dt*(lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg2c1term   = -a11*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a13*dt*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a13*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a13*dt*(lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a13*dt*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 1.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = -1.0*a11*bd1c1**1.0*dt*sinh(2.0*a1c1)
    dbd1c2term  = -1.0*a12*bd1c2**1.0*dt*sinh(2.0*a1c2)
    dbd1n1term  = -1.0*a13*bd1n1**1.0*dt*sinh(2.0*a1n1)
    dgd1c1term  = -1.0*a11*dt*gd1c1**1.0*sin(b1c1)**2.0*sinh(2.0*a1c1)
    dgd1c2term  = -1.0*a12*dt*gd1c2**1.0*sin(b1c2)**2.0*sinh(2.0*a1c2)
    dgd1n1term  = -1.0*a13*dt*gd1n1**1.0*sin(b1n1)**2.0*sinh(2.0*a1n1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a11*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a13*dt*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a11*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a13*dt*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex29(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ad1c2 - ad1n - dt*(a21*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd1c1**2.0 + gd1c1**2.0*sin(b1c1)**2.0)*sinh(2.0*a1c1)) + a22*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd1c2**2.0 + gd1c2**2.0*sin(b1c2)**2.0)*sinh(2.0*a1c2)) + a23*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1)))
    da1c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c1**2.0 + 0.5*gd1c1**2.0*sin(b1c1)**2.0)*cosh(2.0*a1c1))
    da1c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c2**2.0 + 0.5*gd1c2**2.0*sin(b1c2)**2.0)*cosh(2.0*a1c2))
    da1n1term   = -a23*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1n1**2.0 + 0.5*gd1n1**2.0*sin(b1n1)**2.0)*cosh(2.0*a1n1))
    db1c1term   = -a21*dt*(1.0*gd1c1**2.0*sin(b1c1)**1.0*cos(b1c1)*sinh(2.0*a1c1) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(1.0*gd1c2**2.0*sin(b1c2)**1.0*cos(b1c2)*sinh(2.0*a1c2) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a23*dt*(1.0*gd1n1**2.0*sin(b1n1)**1.0*cos(b1n1)*sinh(2.0*a1n1) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a21*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a23*dt*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a23*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db2n1term   = -a23*dt*(lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg2c1term   = -a21*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a23*dt*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a23*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a23*dt*(lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a23*dt*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 1.
    dad1n1term  = 0.
    dbd1c1term  = -1.0*a21*bd1c1**1.0*dt*sinh(2.0*a1c1)
    dbd1c2term  = -1.0*a22*bd1c2**1.0*dt*sinh(2.0*a1c2)
    dbd1n1term  = -1.0*a23*bd1n1**1.0*dt*sinh(2.0*a1n1)
    dgd1c1term  = -1.0*a21*dt*gd1c1**1.0*sin(b1c1)**2.0*sinh(2.0*a1c1)
    dgd1c2term  = -1.0*a22*dt*gd1c2**1.0*sin(b1c2)**2.0*sinh(2.0*a1c2)
    dgd1n1term  = -1.0*a23*dt*gd1n1**1.0*sin(b1n1)**2.0*sinh(2.0*a1n1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a21*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a23*dt*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a21*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a23*dt*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex30(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -ad1n + ad1n1 - dt*(a31*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd1c1**2.0 + gd1c1**2.0*sin(b1c1)**2.0)*sinh(2.0*a1c1)) + a32*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd1c2**2.0 + gd1c2**2.0*sin(b1c2)**2.0)*sinh(2.0*a1c2)) + a33*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1)))
    da1c1term   = -a31*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c1**2.0 + 0.5*gd1c1**2.0*sin(b1c1)**2.0)*cosh(2.0*a1c1))
    da1c2term   = -a32*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1c2**2.0 + 0.5*gd1c2**2.0*sin(b1c2)**2.0)*cosh(2.0*a1c2))
    da1n1term   = -a33*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1n1**2.0 + 0.5*gd1n1**2.0*sin(b1n1)**2.0)*cosh(2.0*a1n1))
    db1c1term   = -a31*dt*(1.0*gd1c1**2.0*sin(b1c1)**1.0*cos(b1c1)*sinh(2.0*a1c1) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a32*dt*(1.0*gd1c2**2.0*sin(b1c2)**1.0*cos(b1c2)*sinh(2.0*a1c2) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a33*dt*(1.0*gd1n1**2.0*sin(b1n1)**1.0*cos(b1n1)*sinh(2.0*a1n1) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a31*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a32*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a33*dt*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a31*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a32*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a33*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a31*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a32*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db2n1term   = -a33*dt*(lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg2c1term   = -a31*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a32*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a33*dt*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a31*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a32*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a33*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a31*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a32*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a33*dt*(lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a31*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a32*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a33*dt*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 1.
    dbd1c1term  = -1.0*a31*bd1c1**1.0*dt*sinh(2.0*a1c1)
    dbd1c2term  = -1.0*a32*bd1c2**1.0*dt*sinh(2.0*a1c2)
    dbd1n1term  = -1.0*a33*bd1n1**1.0*dt*sinh(2.0*a1n1)
    dgd1c1term  = -1.0*a31*dt*gd1c1**1.0*sin(b1c1)**2.0*sinh(2.0*a1c1)
    dgd1c2term  = -1.0*a32*dt*gd1c2**1.0*sin(b1c2)**2.0*sinh(2.0*a1c2)
    dgd1n1term  = -1.0*a33*dt*gd1n1**1.0*sin(b1n1)**2.0*sinh(2.0*a1n1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a31*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + sinh(a1c1)*cosh(a2c1))/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a32*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + sinh(a1c2)*cosh(a2c2))/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a33*dt*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a31*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + sinh(a1c1)*cosh(a3c1))/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a32*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + sinh(a1c2)*cosh(a3c2))/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a33*dt*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex31(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = bd1c1 - bd1n - dt*(a11*(-2.0*ad1c1*bd1c1/tanh(a1c1) + 0.5*gd1c1**2*sin(2.0*b1c1) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad1c2*bd1c2/tanh(a1c2) + 0.5*gd1c2**2*sin(2.0*b1c2) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))) + a13*(-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a11*dt*(-2.0*ad1c1*bd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 2.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a12*dt*(-2.0*ad1c2*bd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 2.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da1n1term   = -a13*dt*(-2.0*ad1n1*bd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + 2.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db1c1term   = -a11*dt*(1.0*gd1c1**2*cos(2.0*b1c1) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(1.0*gd1c2**2*cos(2.0*b1c2) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a13*dt*(1.0*gd1n1**2*cos(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a11*dt*(1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a12*dt*(1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1n1term   = -a13*dt*(1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    da2c1term   = -a11*dt*(lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da2c2term   = -a12*dt*(lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da2n1term   = -a13*dt*(lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    db2c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db2n1term   = -a13*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    dg2c1term   = -a11*dt*(-1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg2c2term   = -a12*dt*(-1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg2n1term   = -a13*dt*(-1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    da3c1term   = -a11*dt*(lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a12*dt*(lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a13*dt*(lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a13*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a11*dt*(-1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a12*dt*(-1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a13*dt*(-1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 2.0*a11*bd1c1*dt/tanh(a1c1)
    dad1c2term  = 2.0*a12*bd1c2*dt/tanh(a1c2)
    dad1n1term  = 2.0*a13*bd1n1*dt/tanh(a1n1)
    dbd1c1term  = 2.0*a11*ad1c1*dt/tanh(a1c1) + 1
    dbd1c2term  = 2.0*a12*ad1c2*dt/tanh(a1c2)
    dbd1n1term  = 2.0*a13*ad1n1*dt/tanh(a1n1)
    dgd1c1term  = -1.0*a11*dt*gd1c1*sin(2.0*b1c1)
    dgd1c2term  = -1.0*a12*dt*gd1c2*sin(2.0*b1c2)
    dgd1n1term  = -1.0*a13*dt*gd1n1*sin(2.0*b1n1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a11*dt*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a13*dt*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a11*dt*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a13*dt*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex32(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = bd1c2 - bd1n - dt*(a21*(-2.0*ad1c1*bd1c1/tanh(a1c1) + 0.5*gd1c1**2*sin(2.0*b1c1) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad1c2*bd1c2/tanh(a1c2) + 0.5*gd1c2**2*sin(2.0*b1c2) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))) + a23*(-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a21*dt*(-2.0*ad1c1*bd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 2.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a22*dt*(-2.0*ad1c2*bd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 2.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da1n1term   = -a23*dt*(-2.0*ad1n1*bd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + 2.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db1c1term   = -a21*dt*(1.0*gd1c1**2*cos(2.0*b1c1) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(1.0*gd1c2**2*cos(2.0*b1c2) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a23*dt*(1.0*gd1n1**2*cos(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a21*dt*(1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a22*dt*(1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1n1term   = -a23*dt*(1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    da2c1term   = -a21*dt*(lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da2c2term   = -a22*dt*(lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da2n1term   = -a23*dt*(lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    db2c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db2n1term   = -a23*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    dg2c1term   = -a21*dt*(-1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg2c2term   = -a22*dt*(-1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg2n1term   = -a23*dt*(-1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    da3c1term   = -a21*dt*(lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a22*dt*(lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a23*dt*(lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a23*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a21*dt*(-1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a22*dt*(-1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a23*dt*(-1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 2.0*a21*bd1c1*dt/tanh(a1c1)
    dad1c2term  = 2.0*a22*bd1c2*dt/tanh(a1c2)
    dad1n1term  = 2.0*a23*bd1n1*dt/tanh(a1n1)
    dbd1c1term  = 2.0*a21*ad1c1*dt/tanh(a1c1)
    dbd1c2term  = 2.0*a22*ad1c2*dt/tanh(a1c2) + 1
    dbd1n1term  = 2.0*a23*ad1n1*dt/tanh(a1n1)
    dgd1c1term  = -1.0*a21*dt*gd1c1*sin(2.0*b1c1)
    dgd1c2term  = -1.0*a22*dt*gd1c2*sin(2.0*b1c2)
    dgd1n1term  = -1.0*a23*dt*gd1n1*sin(2.0*b1n1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a21*dt*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a23*dt*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a21*dt*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a23*dt*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex33(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -bd1n + bd1n1 - dt*(a31*(-2.0*ad1c1*bd1c1/tanh(a1c1) + 0.5*gd1c1**2*sin(2.0*b1c1) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a32*(-2.0*ad1c2*bd1c2/tanh(a1c2) + 0.5*gd1c2**2*sin(2.0*b1c2) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))) + a33*(-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a31*dt*(-2.0*ad1c1*bd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 2.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-3.0)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a32*dt*(-2.0*ad1c2*bd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 2.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-3.0)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da1n1term   = -a33*dt*(-2.0*ad1n1*bd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + 2.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db1c1term   = -a31*dt*(1.0*gd1c1**2*cos(2.0*b1c1) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a32*dt*(1.0*gd1c2**2*cos(2.0*b1c2) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a33*dt*(1.0*gd1n1**2*cos(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a31*dt*(1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a32*dt*(1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1n1term   = -a33*dt*(1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    da2c1term   = -a31*dt*(lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da2c2term   = -a32*dt*(lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da2n1term   = -a33*dt*(lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    db2c1term   = -a31*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a32*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db2n1term   = -a33*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    dg2c1term   = -a31*dt*(-1.0*lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg2c2term   = -a32*dt*(-1.0*lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg2n1term   = -a33*dt*(-1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    da3c1term   = -a31*dt*(lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a32*dt*(lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a33*dt*(lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a31*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a1c1)**(-2.0)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a32*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a1c2)**(-2.0)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a33*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a31*dt*(-1.0*lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a32*dt*(-1.0*lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a33*dt*(-1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 2.0*a31*bd1c1*dt/tanh(a1c1)
    dad1c2term  = 2.0*a32*bd1c2*dt/tanh(a1c2)
    dad1n1term  = 2.0*a33*bd1n1*dt/tanh(a1n1)
    dbd1c1term  = 2.0*a31*ad1c1*dt/tanh(a1c1)
    dbd1c2term  = 2.0*a32*ad1c2*dt/tanh(a1c2)
    dbd1n1term  = 2.0*a33*ad1n1*dt/tanh(a1n1) + 1
    dgd1c1term  = -1.0*a31*dt*gd1c1*sin(2.0*b1c1)
    dgd1c2term  = -1.0*a32*dt*gd1c2*sin(2.0*b1c2)
    dgd1n1term  = -1.0*a33*dt*gd1n1*sin(2.0*b1n1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a31*dt*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a32*dt*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a33*dt*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a31*dt*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a1c1)**(-2.0)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a32*dt*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a1c2)**(-2.0)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a33*dt*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex34(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a11*(-2.0*ad1c1*gd1c1/tanh(a1c1) - 2.0*bd1c1*gd1c1/tan(b1c1) - lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad1c2*gd1c2/tanh(a1c2) - 2.0*bd1c2*gd1c2/tan(b1c2) - lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))) + a13*(-2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*bd1n1*gd1n1/tan(b1n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))) + gd1c1 - gd1n
    da1c1term   = -a11*dt*(-2.0*ad1c1*gd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 1.0*lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-2.0)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-2.0)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(-2.0*ad1c2*gd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 1.0*lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-2.0)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-2.0)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a13*dt*(-2.0*ad1n1*gd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + 1.0*lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-2.0)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-2.0)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(-2.0*bd1c1*gd1c1*(-tan(b1c1)**2 - 1)/tan(b1c1)**2 + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam1c1*sin(b1c1)**(-2.0)*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-2.0)*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(-2.0*bd1c2*gd1c2*(-tan(b1c2)**2 - 1)/tan(b1c2)**2 + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam1c2*sin(b1c2)**(-2.0)*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-2.0)*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a13*dt*(-2.0*bd1n1*gd1n1*(-tan(b1n1)**2 - 1)/tan(b1n1)**2 + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam1n1*sin(b1n1)**(-2.0)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 1.0*lam2n1*sin(b1n1)**(-2.0)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a11*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a13*dt*(-lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*cosh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*cosh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a13*dt*(-lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*cosh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db2n1term   = -a13*dt*(lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg2c1term   = -a11*dt*(lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a13*dt*(lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*cosh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*cosh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a13*dt*(-lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*cosh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a13*dt*(lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a13*dt*(lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 2.0*a11*dt*gd1c1/tanh(a1c1)
    dad1c2term  = 2.0*a12*dt*gd1c2/tanh(a1c2)
    dad1n1term  = 2.0*a13*dt*gd1n1/tanh(a1n1)
    dbd1c1term  = 2.0*a11*dt*gd1c1/tan(b1c1)
    dbd1c2term  = 2.0*a12*dt*gd1c2/tan(b1c2)
    dbd1n1term  = 2.0*a13*dt*gd1n1/tan(b1n1)
    dgd1c1term  = -a11*dt*(-2.0*ad1c1/tanh(a1c1) - 2.0*bd1c1/tan(b1c1)) + 1
    dgd1c2term  = -a12*dt*(-2.0*ad1c2/tanh(a1c2) - 2.0*bd1c2/tan(b1c2))
    dgd1n1term  = -a13*dt*(-2.0*ad1n1/tanh(a1n1) - 2.0*bd1n1/tan(b1n1))
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a11*dt*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a13*dt*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a11*dt*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a13*dt*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex35(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a21*(-2.0*ad1c1*gd1c1/tanh(a1c1) - 2.0*bd1c1*gd1c1/tan(b1c1) - lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad1c2*gd1c2/tanh(a1c2) - 2.0*bd1c2*gd1c2/tan(b1c2) - lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))) + a23*(-2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*bd1n1*gd1n1/tan(b1n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))) + gd1c2 - gd1n
    da1c1term   = -a21*dt*(-2.0*ad1c1*gd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 1.0*lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-2.0)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-2.0)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(-2.0*ad1c2*gd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 1.0*lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-2.0)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-2.0)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a23*dt*(-2.0*ad1n1*gd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + 1.0*lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-2.0)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-2.0)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(-2.0*bd1c1*gd1c1*(-tan(b1c1)**2 - 1)/tan(b1c1)**2 + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam1c1*sin(b1c1)**(-2.0)*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-2.0)*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(-2.0*bd1c2*gd1c2*(-tan(b1c2)**2 - 1)/tan(b1c2)**2 + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam1c2*sin(b1c2)**(-2.0)*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-2.0)*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a23*dt*(-2.0*bd1n1*gd1n1*(-tan(b1n1)**2 - 1)/tan(b1n1)**2 + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam1n1*sin(b1n1)**(-2.0)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 1.0*lam2n1*sin(b1n1)**(-2.0)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a21*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a23*dt*(-lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*cosh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*cosh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a23*dt*(-lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*cosh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db2n1term   = -a23*dt*(lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg2c1term   = -a21*dt*(lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a23*dt*(lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*cosh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*cosh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a23*dt*(-lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*cosh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a23*dt*(lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a23*dt*(lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 2.0*a21*dt*gd1c1/tanh(a1c1)
    dad1c2term  = 2.0*a22*dt*gd1c2/tanh(a1c2)
    dad1n1term  = 2.0*a23*dt*gd1n1/tanh(a1n1)
    dbd1c1term  = 2.0*a21*dt*gd1c1/tan(b1c1)
    dbd1c2term  = 2.0*a22*dt*gd1c2/tan(b1c2)
    dbd1n1term  = 2.0*a23*dt*gd1n1/tan(b1n1)
    dgd1c1term  = -a21*dt*(-2.0*ad1c1/tanh(a1c1) - 2.0*bd1c1/tan(b1c1))
    dgd1c2term  = -a22*dt*(-2.0*ad1c2/tanh(a1c2) - 2.0*bd1c2/tan(b1c2)) + 1
    dgd1n1term  = -a23*dt*(-2.0*ad1n1/tanh(a1n1) - 2.0*bd1n1/tan(b1n1))
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a21*dt*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a23*dt*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a21*dt*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a23*dt*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex36(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a31*(-2.0*ad1c1*gd1c1/tanh(a1c1) - 2.0*bd1c1*gd1c1/tan(b1c1) - lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))) + a32*(-2.0*ad1c2*gd1c2/tanh(a1c2) - 2.0*bd1c2*gd1c2/tan(b1c2) - lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))) + a33*(-2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*bd1n1*gd1n1/tan(b1n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))) - gd1n + gd1n1
    da1c1term   = -a31*dt*(-2.0*ad1c1*gd1c1*(tanh(a1c1)**2 - 1)/tanh(a1c1)**2 + 1.0*lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-2.0)*sinh(a2c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-2.0)*sinh(a3c1)*cosh(a1c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a32*dt*(-2.0*ad1c2*gd1c2*(tanh(a1c2)**2 - 1)/tanh(a1c2)**2 + 1.0*lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-2.0)*sinh(a2c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-2.0)*sinh(a3c2)*cosh(a1c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a33*dt*(-2.0*ad1n1*gd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + 1.0*lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-2.0)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-2.0)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a31*dt*(-2.0*bd1c1*gd1c1*(-tan(b1c1)**2 - 1)/tan(b1c1)**2 + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam1c1*sin(b1c1)**(-2.0)*sin(b2c1)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam2c1*sin(b1c1)**(-2.0)*sin(b3c1)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a32*dt*(-2.0*bd1c2*gd1c2*(-tan(b1c2)**2 - 1)/tan(b1c2)**2 + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam1c2*sin(b1c2)**(-2.0)*sin(b2c2)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam2c2*sin(b1c2)**(-2.0)*sin(b3c2)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a33*dt*(-2.0*bd1n1*gd1n1*(-tan(b1n1)**2 - 1)/tan(b1n1)**2 + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam1n1*sin(b1n1)**(-2.0)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 1.0*lam2n1*sin(b1n1)**(-2.0)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a31*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a32*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a33*dt*(-lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a31*dt*(-lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*cosh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a32*dt*(-lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*cosh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a33*dt*(-lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*cosh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a31*dt*(lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(2*m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db2c2term   = -a32*dt*(lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(2*m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db2n1term   = -a33*dt*(lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg2c1term   = -a31*dt*(lam1c1*sin(b1c1)**(-1.0)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b2c1)**2*sin(g1c1 - g2c1)**2*sinh(a2c1)**2/(m1*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a32*dt*(lam1c2*sin(b1c2)**(-1.0)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b2c2)**2*sin(g1c2 - g2c2)**2*sinh(a2c2)**2/(m1*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a33*dt*(lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a31*dt*(-lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*cosh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a32*dt*(-lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*cosh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a33*dt*(-lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*cosh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a31*dt*(lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(2*m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a32*dt*(lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(2*m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a33*dt*(lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a31*dt*(lam2c1*sin(b1c1)**(-1.0)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g1c1 - g3c1)**2*sinh(a3c1)**2/(m1*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a32*dt*(lam2c2*sin(b1c2)**(-1.0)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g1c2 - g3c2)**2*sinh(a3c2)**2/(m1*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a33*dt*(lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 2.0*a31*dt*gd1c1/tanh(a1c1)
    dad1c2term  = 2.0*a32*dt*gd1c2/tanh(a1c2)
    dad1n1term  = 2.0*a33*dt*gd1n1/tanh(a1n1)
    dbd1c1term  = 2.0*a31*dt*gd1c1/tan(b1c1)
    dbd1c2term  = 2.0*a32*dt*gd1c2/tan(b1c2)
    dbd1n1term  = 2.0*a33*dt*gd1n1/tan(b1n1)
    dgd1c1term  = -a31*dt*(-2.0*ad1c1/tanh(a1c1) - 2.0*bd1c1/tan(b1c1))
    dgd1c2term  = -a32*dt*(-2.0*ad1c2/tanh(a1c2) - 2.0*bd1c2/tan(b1c2))
    dgd1n1term  = -a33*dt*(-2.0*ad1n1/tanh(a1n1) - 2.0*bd1n1/tan(b1n1)) + 1
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a31*dt*sin(b1c1)**(-1.0)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)**(-1.0)*sinh(a2c1)/(m1*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a32*dt*sin(b1c2)**(-1.0)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)**(-1.0)*sinh(a2c2)/(m1*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a33*dt*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = a31*dt*sin(b1c1)**(-1.0)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)**(-1.0)*sinh(a3c1)/(m1*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a32*dt*sin(b1c2)**(-1.0)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)**(-1.0)*sinh(a3c2)/(m1*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a33*dt*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex37(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ad2c1 - ad2n - dt*(a11*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd2c1**2.0 + gd2c1**2.0*sin(b2c1)**2.0)*sinh(2.0*a2c1)) + a12*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd2c2**2.0 + gd2c2**2.0*sin(b2c2)**2.0)*sinh(2.0*a2c2)) + a13*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1)))
    da1c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a13*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db1n1term   = -a13*dt*(lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg1c1term   = -a11*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a13*dt*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c1**2.0 + 0.5*gd2c1**2.0*sin(b2c1)**2.0)*cosh(2.0*a2c1))
    da2c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c2**2.0 + 0.5*gd2c2**2.0*sin(b2c2)**2.0)*cosh(2.0*a2c2))
    da2n1term   = -a13*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2n1**2.0 + 0.5*gd2n1**2.0*sin(b2n1)**2.0)*cosh(2.0*a2n1))
    db2c1term   = -a11*dt*(1.0*gd2c1**2.0*sin(b2c1)**1.0*cos(b2c1)*sinh(2.0*a2c1) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(1.0*gd2c2**2.0*sin(b2c2)**1.0*cos(b2c2)*sinh(2.0*a2c2) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a13*dt*(1.0*gd2n1**2.0*sin(b2n1)**1.0*cos(b2n1)*sinh(2.0*a2n1) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a11*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a13*dt*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a13*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a13*dt*(lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a13*dt*(lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 1.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = -1.0*a11*bd2c1**1.0*dt*sinh(2.0*a2c1)
    dbd2c2term  = -1.0*a12*bd2c2**1.0*dt*sinh(2.0*a2c2)
    dbd2n1term  = -1.0*a13*bd2n1**1.0*dt*sinh(2.0*a2n1)
    dgd2c1term  = -1.0*a11*dt*gd2c1**1.0*sin(b2c1)**2.0*sinh(2.0*a2c1)
    dgd2c2term  = -1.0*a12*dt*gd2c2**1.0*sin(b2c2)**2.0*sinh(2.0*a2c2)
    dgd2n1term  = -1.0*a13*dt*gd2n1**1.0*sin(b2n1)**2.0*sinh(2.0*a2n1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a11*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a13*dt*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a11*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a13*dt*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex38(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ad2c2 - ad2n - dt*(a21*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd2c1**2.0 + gd2c1**2.0*sin(b2c1)**2.0)*sinh(2.0*a2c1)) + a22*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd2c2**2.0 + gd2c2**2.0*sin(b2c2)**2.0)*sinh(2.0*a2c2)) + a23*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1)))
    da1c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a23*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db1n1term   = -a23*dt*(lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg1c1term   = -a21*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a23*dt*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c1**2.0 + 0.5*gd2c1**2.0*sin(b2c1)**2.0)*cosh(2.0*a2c1))
    da2c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c2**2.0 + 0.5*gd2c2**2.0*sin(b2c2)**2.0)*cosh(2.0*a2c2))
    da2n1term   = -a23*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2n1**2.0 + 0.5*gd2n1**2.0*sin(b2n1)**2.0)*cosh(2.0*a2n1))
    db2c1term   = -a21*dt*(1.0*gd2c1**2.0*sin(b2c1)**1.0*cos(b2c1)*sinh(2.0*a2c1) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(1.0*gd2c2**2.0*sin(b2c2)**1.0*cos(b2c2)*sinh(2.0*a2c2) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a23*dt*(1.0*gd2n1**2.0*sin(b2n1)**1.0*cos(b2n1)*sinh(2.0*a2n1) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a21*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a23*dt*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a23*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a23*dt*(lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a23*dt*(lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 1.
    dad2n1term  = 0.
    dbd2c1term  = -1.0*a21*bd2c1**1.0*dt*sinh(2.0*a2c1)
    dbd2c2term  = -1.0*a22*bd2c2**1.0*dt*sinh(2.0*a2c2)
    dbd2n1term  = -1.0*a23*bd2n1**1.0*dt*sinh(2.0*a2n1)
    dgd2c1term  = -1.0*a21*dt*gd2c1**1.0*sin(b2c1)**2.0*sinh(2.0*a2c1)
    dgd2c2term  = -1.0*a22*dt*gd2c2**1.0*sin(b2c2)**2.0*sinh(2.0*a2c2)
    dgd2n1term  = -1.0*a23*dt*gd2n1**1.0*sin(b2n1)**2.0*sinh(2.0*a2n1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a21*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a23*dt*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a21*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a23*dt*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex39(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -ad2n + ad2n1 - dt*(a31*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd2c1**2.0 + gd2c1**2.0*sin(b2c1)**2.0)*sinh(2.0*a2c1)) + a32*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd2c2**2.0 + gd2c2**2.0*sin(b2c2)**2.0)*sinh(2.0*a2c2)) + a33*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1)))
    da1c1term   = -a31*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*cosh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*cosh(a1c1)*cosh(a2c1) + sinh(a1c1)*sinh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a32*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*cosh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*cosh(a1c2)*cosh(a2c2) + sinh(a1c2)*sinh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a33*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a31*dt*(lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(sin(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) - sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a32*dt*(lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(sin(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) - sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db1n1term   = -a33*dt*(lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg1c1term   = -a31*dt*(-lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a32*dt*(-lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a33*dt*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a31*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c1**2.0 + 0.5*gd2c1**2.0*sin(b2c1)**2.0)*cosh(2.0*a2c1))
    da2c2term   = -a32*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2c2**2.0 + 0.5*gd2c2**2.0*sin(b2c2)**2.0)*cosh(2.0*a2c2))
    da2n1term   = -a33*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2n1**2.0 + 0.5*gd2n1**2.0*sin(b2n1)**2.0)*cosh(2.0*a2n1))
    db2c1term   = -a31*dt*(1.0*gd2c1**2.0*sin(b2c1)**1.0*cos(b2c1)*sinh(2.0*a2c1) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a32*dt*(1.0*gd2c2**2.0*sin(b2c2)**1.0*cos(b2c2)*sinh(2.0*a2c2) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a33*dt*(1.0*gd2n1**2.0*sin(b2n1)**1.0*cos(b2n1)*sinh(2.0*a2n1) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a31*dt*(lam1c1*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a32*dt*(lam1c2*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a33*dt*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a31*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a32*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a33*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a31*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a32*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a33*dt*(lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a31*dt*(lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a32*dt*(lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a33*dt*(lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 1.
    dbd2c1term  = -1.0*a31*bd2c1**1.0*dt*sinh(2.0*a2c1)
    dbd2c2term  = -1.0*a32*bd2c2**1.0*dt*sinh(2.0*a2c2)
    dbd2n1term  = -1.0*a33*bd2n1**1.0*dt*sinh(2.0*a2n1)
    dgd2c1term  = -1.0*a31*dt*gd2c1**1.0*sin(b2c1)**2.0*sinh(2.0*a2c1)
    dgd2c2term  = -1.0*a32*dt*gd2c2**1.0*sin(b2c2)**2.0*sinh(2.0*a2c2)
    dgd2n1term  = -1.0*a33*dt*gd2n1**1.0*sin(b2n1)**2.0*sinh(2.0*a2n1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a31*dt*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + sinh(a2c1)*cosh(a1c1))/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a32*dt*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + sinh(a2c2)*cosh(a1c2))/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a33*dt*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a31*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + sinh(a2c1)*cosh(a3c1))/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a32*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + sinh(a2c2)*cosh(a3c2))/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a33*dt*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex40(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = bd2c1 - bd2n - dt*(a11*(-2.0*ad2c1*bd2c1/tanh(a2c1) + 0.5*gd2c1**2*sin(2.0*b2c1) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad2c2*bd2c2/tanh(a2c2) + 0.5*gd2c2**2*sin(2.0*b2c2) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a13*(-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a11*dt*(lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da1c2term   = -a12*dt*(lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da1n1term   = -a13*dt*(lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    db1c1term   = -a11*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a12*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db1n1term   = -a13*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    dg1c1term   = -a11*dt*(1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg1c2term   = -a12*dt*(1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg1n1term   = -a13*dt*(1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    da2c1term   = -a11*dt*(-2.0*ad2c1*bd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 + 2.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a12*dt*(-2.0*ad2c2*bd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 + 2.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da2n1term   = -a13*dt*(-2.0*ad2n1*bd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 + 2.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db2c1term   = -a11*dt*(1.0*gd2c1**2*cos(2.0*b2c1) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(1.0*gd2c2**2*cos(2.0*b2c2) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a13*dt*(1.0*gd2n1**2*cos(2.0*b2n1) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a11*dt*(-1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a12*dt*(-1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2n1term   = -a13*dt*(-1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    da3c1term   = -a11*dt*(lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a12*dt*(lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a13*dt*(lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a11*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a12*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a13*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a11*dt*(-1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a12*dt*(-1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a13*dt*(-1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 2.0*a11*bd2c1*dt/tanh(a2c1)
    dad2c2term  = 2.0*a12*bd2c2*dt/tanh(a2c2)
    dad2n1term  = 2.0*a13*bd2n1*dt/tanh(a2n1)
    dbd2c1term  = 2.0*a11*ad2c1*dt/tanh(a2c1) + 1
    dbd2c2term  = 2.0*a12*ad2c2*dt/tanh(a2c2)
    dbd2n1term  = 2.0*a13*ad2n1*dt/tanh(a2n1)
    dgd2c1term  = -1.0*a11*dt*gd2c1*sin(2.0*b2c1)
    dgd2c2term  = -1.0*a12*dt*gd2c2*sin(2.0*b2c2)
    dgd2n1term  = -1.0*a13*dt*gd2n1*sin(2.0*b2n1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a11*dt*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a12*dt*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a13*dt*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a11*dt*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a13*dt*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex41(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = bd2c2 - bd2n - dt*(a21*(-2.0*ad2c1*bd2c1/tanh(a2c1) + 0.5*gd2c1**2*sin(2.0*b2c1) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad2c2*bd2c2/tanh(a2c2) + 0.5*gd2c2**2*sin(2.0*b2c2) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a23*(-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a21*dt*(lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da1c2term   = -a22*dt*(lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da1n1term   = -a23*dt*(lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    db1c1term   = -a21*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a22*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db1n1term   = -a23*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    dg1c1term   = -a21*dt*(1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg1c2term   = -a22*dt*(1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg1n1term   = -a23*dt*(1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    da2c1term   = -a21*dt*(-2.0*ad2c1*bd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 + 2.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a22*dt*(-2.0*ad2c2*bd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 + 2.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da2n1term   = -a23*dt*(-2.0*ad2n1*bd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 + 2.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db2c1term   = -a21*dt*(1.0*gd2c1**2*cos(2.0*b2c1) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(1.0*gd2c2**2*cos(2.0*b2c2) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a23*dt*(1.0*gd2n1**2*cos(2.0*b2n1) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a21*dt*(-1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a22*dt*(-1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2n1term   = -a23*dt*(-1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    da3c1term   = -a21*dt*(lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a22*dt*(lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a23*dt*(lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a21*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a22*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a23*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a21*dt*(-1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a22*dt*(-1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a23*dt*(-1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 2.0*a21*bd2c1*dt/tanh(a2c1)
    dad2c2term  = 2.0*a22*bd2c2*dt/tanh(a2c2)
    dad2n1term  = 2.0*a23*bd2n1*dt/tanh(a2n1)
    dbd2c1term  = 2.0*a21*ad2c1*dt/tanh(a2c1)
    dbd2c2term  = 2.0*a22*ad2c2*dt/tanh(a2c2) + 1
    dbd2n1term  = 2.0*a23*ad2n1*dt/tanh(a2n1)
    dgd2c1term  = -1.0*a21*dt*gd2c1*sin(2.0*b2c1)
    dgd2c2term  = -1.0*a22*dt*gd2c2*sin(2.0*b2c2)
    dgd2n1term  = -1.0*a23*dt*gd2n1*sin(2.0*b2n1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a21*dt*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a22*dt*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a23*dt*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a21*dt*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a23*dt*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex42(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -bd2n + bd2n1 - dt*(a31*(-2.0*ad2c1*bd2c1/tanh(a2c1) + 0.5*gd2c1**2*sin(2.0*b2c1) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a32*(-2.0*ad2c2*bd2c2/tanh(a2c2) + 0.5*gd2c2**2*sin(2.0*b2c2) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a33*(-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a31*dt*(lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) + sin(b2c1)*cos(b1c1)*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    da1c2term   = -a32*dt*(lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) + sin(b2c2)*cos(b1c2)*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    da1n1term   = -a33*dt*(lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    db1c1term   = -a31*dt*(-lam1c1*(-sin(b1c1)*sin(b2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a32*dt*(-lam1c2*(-sin(b1c2)*sin(b2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    db1n1term   = -a33*dt*(-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    dg1c1term   = -a31*dt*(1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    dg1c2term   = -a32*dt*(1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    dg1n1term   = -a33*dt*(1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    da2c1term   = -a31*dt*(-2.0*ad2c1*bd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 + 2.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 2.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-3.0)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a32*dt*(-2.0*ad2c2*bd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 + 2.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 2.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-3.0)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da2n1term   = -a33*dt*(-2.0*ad2n1*bd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 + 2.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db2c1term   = -a31*dt*(1.0*gd2c1**2*cos(2.0*b2c1) - lam1c1*(sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a32*dt*(1.0*gd2c2**2*cos(2.0*b2c2) - lam1c2*(sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a33*dt*(1.0*gd2n1**2*cos(2.0*b2n1) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a31*dt*(-1.0*lam1c1*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b1c1)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a32*dt*(-1.0*lam1c2*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b1c2)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2n1term   = -a33*dt*(-1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    da3c1term   = -a31*dt*(lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a32*dt*(lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a33*dt*(lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a31*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a2c1)**(-2.0)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a32*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a2c2)**(-2.0)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a33*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a31*dt*(-1.0*lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a32*dt*(-1.0*lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a33*dt*(-1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 2.0*a31*bd2c1*dt/tanh(a2c1)
    dad2c2term  = 2.0*a32*bd2c2*dt/tanh(a2c2)
    dad2n1term  = 2.0*a33*bd2n1*dt/tanh(a2n1)
    dbd2c1term  = 2.0*a31*ad2c1*dt/tanh(a2c1)
    dbd2c2term  = 2.0*a32*ad2c2*dt/tanh(a2c2)
    dbd2n1term  = 2.0*a33*ad2n1*dt/tanh(a2n1) + 1
    dgd2c1term  = -1.0*a31*dt*gd2c1*sin(2.0*b2c1)
    dgd2c2term  = -1.0*a32*dt*gd2c2*sin(2.0*b2c2)
    dgd2n1term  = -1.0*a33*dt*gd2n1*sin(2.0*b2n1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = a31*dt*(-sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = a32*dt*(-sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = a33*dt*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a31*dt*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a2c1)**(-2.0)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a32*dt*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a2c2)**(-2.0)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a33*dt*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex43(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a11*(-2.0*ad2c1*gd2c1/tanh(a2c1) - 2.0*bd2c1*gd2c1/tan(b2c1) + lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad2c2*gd2c2/tanh(a2c2) - 2.0*bd2c2*gd2c2/tan(b2c2) + lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a13*(-2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))) + gd2c1 - gd2n
    da1c1term   = -a11*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a2c1)**(-1.0)*cosh(a1c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a2c2)**(-1.0)*cosh(a1c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a13*dt*(lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a2n1)**(-1.0)*cosh(a1n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(-lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(-lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db1n1term   = -a13*dt*(-lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg1c1term   = -a11*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a13*dt*(lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-2.0*ad2c1*gd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-2.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-2.0)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(-2.0*ad2c2*gd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-2.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-2.0)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a13*dt*(-2.0*ad2n1*gd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 - 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-2.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-2.0)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(-2.0*bd2c1*gd2c1*(-tan(b2c1)**2 - 1)/tan(b2c1)**2 - lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-2.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-2.0)*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(-2.0*bd2c2*gd2c2*(-tan(b2c2)**2 - 1)/tan(b2c2)**2 - lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-2.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-2.0)*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a13*dt*(-2.0*bd2n1*gd2n1*(-tan(b2n1)**2 - 1)/tan(b2n1)**2 - lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-2.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 1.0*lam3n1*sin(b2n1)**(-2.0)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a11*dt*(-lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(-lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a13*dt*(-lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*cosh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*cosh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a13*dt*(-lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*cosh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a13*dt*(lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a13*dt*(lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 2.0*a11*dt*gd2c1/tanh(a2c1)
    dad2c2term  = 2.0*a12*dt*gd2c2/tanh(a2c2)
    dad2n1term  = 2.0*a13*dt*gd2n1/tanh(a2n1)
    dbd2c1term  = 2.0*a11*dt*gd2c1/tan(b2c1)
    dbd2c2term  = 2.0*a12*dt*gd2c2/tan(b2c2)
    dbd2n1term  = 2.0*a13*dt*gd2n1/tan(b2n1)
    dgd2c1term  = -a11*dt*(-2.0*ad2c1/tanh(a2c1) - 2.0*bd2c1/tan(b2c1)) + 1
    dgd2c2term  = -a12*dt*(-2.0*ad2c2/tanh(a2c2) - 2.0*bd2c2/tan(b2c2))
    dgd2n1term  = -a13*dt*(-2.0*ad2n1/tanh(a2n1) - 2.0*bd2n1/tan(b2n1))
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = -a11*dt*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = -a12*dt*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = -a13*dt*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a11*dt*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a13*dt*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex44(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a21*(-2.0*ad2c1*gd2c1/tanh(a2c1) - 2.0*bd2c1*gd2c1/tan(b2c1) + lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad2c2*gd2c2/tanh(a2c2) - 2.0*bd2c2*gd2c2/tan(b2c2) + lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a23*(-2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))) + gd2c2 - gd2n
    da1c1term   = -a21*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a2c1)**(-1.0)*cosh(a1c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a2c2)**(-1.0)*cosh(a1c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a23*dt*(lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a2n1)**(-1.0)*cosh(a1n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(-lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(-lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db1n1term   = -a23*dt*(-lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg1c1term   = -a21*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a23*dt*(lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-2.0*ad2c1*gd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-2.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-2.0)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(-2.0*ad2c2*gd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-2.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-2.0)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a23*dt*(-2.0*ad2n1*gd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 - 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-2.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-2.0)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(-2.0*bd2c1*gd2c1*(-tan(b2c1)**2 - 1)/tan(b2c1)**2 - lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-2.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-2.0)*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(-2.0*bd2c2*gd2c2*(-tan(b2c2)**2 - 1)/tan(b2c2)**2 - lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-2.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-2.0)*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a23*dt*(-2.0*bd2n1*gd2n1*(-tan(b2n1)**2 - 1)/tan(b2n1)**2 - lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-2.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 1.0*lam3n1*sin(b2n1)**(-2.0)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a21*dt*(-lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(-lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a23*dt*(-lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*cosh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*cosh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a23*dt*(-lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*cosh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a23*dt*(lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a23*dt*(lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 2.0*a21*dt*gd2c1/tanh(a2c1)
    dad2c2term  = 2.0*a22*dt*gd2c2/tanh(a2c2)
    dad2n1term  = 2.0*a23*dt*gd2n1/tanh(a2n1)
    dbd2c1term  = 2.0*a21*dt*gd2c1/tan(b2c1)
    dbd2c2term  = 2.0*a22*dt*gd2c2/tan(b2c2)
    dbd2n1term  = 2.0*a23*dt*gd2n1/tan(b2n1)
    dgd2c1term  = -a21*dt*(-2.0*ad2c1/tanh(a2c1) - 2.0*bd2c1/tan(b2c1))
    dgd2c2term  = -a22*dt*(-2.0*ad2c2/tanh(a2c2) - 2.0*bd2c2/tan(b2c2)) + 1
    dgd2n1term  = -a23*dt*(-2.0*ad2n1/tanh(a2n1) - 2.0*bd2n1/tan(b2n1))
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = -a21*dt*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = -a22*dt*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = -a23*dt*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a21*dt*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a23*dt*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex45(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a31*(-2.0*ad2c1*gd2c1/tanh(a2c1) - 2.0*bd2c1*gd2c1/tan(b2c1) + lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a32*(-2.0*ad2c2*gd2c2/tanh(a2c2) - 2.0*bd2c2*gd2c2/tan(b2c2) + lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a33*(-2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))) - gd2n + gd2n1
    da1c1term   = -a31*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a2c1)**(-1.0)*cosh(a1c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a2c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a2c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a2c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a32*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a2c2)**(-1.0)*cosh(a1c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a2c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a2c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a2c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a33*dt*(lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a2n1)**(-1.0)*cosh(a1n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a31*dt*(-lam1c1*(2.0*sin(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) - 2.0*sin(b2c1)*cos(b1c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + lam1c1*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)))
    db1c2term   = -a32*dt*(-lam1c2*(2.0*sin(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) - 2.0*sin(b2c2)*cos(b1c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + lam1c2*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)))
    db1n1term   = -a33*dt*(-lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))
    dg1c1term   = -a31*dt*(lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a32*dt*(lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a33*dt*(lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a31*dt*(-2.0*ad2c1*gd2c1*(tanh(a2c1)**2 - 1)/tanh(a2c1)**2 - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-2.0)*cosh(a2c1)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) - lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*(-2.0*sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*cosh(a2c1) - 2.0*cos(b1c1)*cos(b2c1)*sinh(a1c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a1c1))*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-2.0)*sinh(a3c1)*cosh(a2c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a32*dt*(-2.0*ad2c2*gd2c2*(tanh(a2c2)**2 - 1)/tanh(a2c2)**2 - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-2.0)*cosh(a2c2)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) - lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*(-2.0*sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*cosh(a2c2) - 2.0*cos(b1c2)*cos(b2c2)*sinh(a1c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a1c2))*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-2.0)*sinh(a3c2)*cosh(a2c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a33*dt*(-2.0*ad2n1*gd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 - 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-2.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-2.0)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a31*dt*(-2.0*bd2c1*gd2c1*(-tan(b2c1)**2 - 1)/tan(b2c1)**2 - lam1c1*(-2.0*sin(b1c1)*cos(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) + 2.0*sin(b2c1)*cos(b1c1)*sinh(a1c1)*sinh(a2c1))*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(2*m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - 1.0*lam1c1*sin(b1c1)*sin(b2c1)**(-2.0)*sin(g1c1 - g2c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 1.0*lam3c1*sin(b2c1)**(-2.0)*sin(b3c1)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a32*dt*(-2.0*bd2c2*gd2c2*(-tan(b2c2)**2 - 1)/tan(b2c2)**2 - lam1c2*(-2.0*sin(b1c2)*cos(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) + 2.0*sin(b2c2)*cos(b1c2)*sinh(a1c2)*sinh(a2c2))*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(2*m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - 1.0*lam1c2*sin(b1c2)*sin(b2c2)**(-2.0)*sin(g1c2 - g2c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 1.0*lam3c2*sin(b2c2)**(-2.0)*sin(b3c2)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a33*dt*(-2.0*bd2n1*gd2n1*(-tan(b2n1)**2 - 1)/tan(b2n1)**2 - lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-2.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 1.0*lam3n1*sin(b2n1)**(-2.0)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a31*dt*(-lam1c1*sin(b1c1)*sin(b2c1)**(-1.0)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)) + 1.0*lam1c1*(-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**1.0*sin(b1c1)**2*sin(g1c1 - g2c1)**2*sinh(a1c1)**2/(m2*((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a32*dt*(-lam1c2*sin(b1c2)*sin(b2c2)**(-1.0)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)) + 1.0*lam1c2*(-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**1.0*sin(b1c2)**2*sin(g1c2 - g2c2)**2*sinh(a1c2)**2/(m2*((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a33*dt*(-lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a31*dt*(-lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*cosh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a32*dt*(-lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*cosh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a33*dt*(-lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*cosh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a31*dt*(lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(2*m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a32*dt*(lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(2*m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a33*dt*(lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a31*dt*(lam3c1*sin(b2c1)**(-1.0)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b3c1)**2*sin(g2c1 - g3c1)**2*sinh(a3c1)**2/(m2*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a32*dt*(lam3c2*sin(b2c2)**(-1.0)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b3c2)**2*sin(g2c2 - g3c2)**2*sinh(a3c2)**2/(m2*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a33*dt*(lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 2.0*a31*dt*gd2c1/tanh(a2c1)
    dad2c2term  = 2.0*a32*dt*gd2c2/tanh(a2c2)
    dad2n1term  = 2.0*a33*dt*gd2n1/tanh(a2n1)
    dbd2c1term  = 2.0*a31*dt*gd2c1/tan(b2c1)
    dbd2c2term  = 2.0*a32*dt*gd2c2/tan(b2c2)
    dbd2n1term  = 2.0*a33*dt*gd2n1/tan(b2n1)
    dgd2c1term  = -a31*dt*(-2.0*ad2c1/tanh(a2c1) - 2.0*bd2c1/tan(b2c1))
    dgd2c2term  = -a32*dt*(-2.0*ad2c2/tanh(a2c2) - 2.0*bd2c2/tan(b2c2))
    dgd2n1term  = -a33*dt*(-2.0*ad2n1/tanh(a2n1) - 2.0*bd2n1/tan(b2n1)) + 1
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = -a31*dt*sin(b1c1)*sin(b2c1)**(-1.0)*sin(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1)**(-1.0)/(m2*sqrt((-sin(b1c1)*sin(b2c1)*cos(g1c1 - g2c1)*sinh(a1c1)*sinh(a2c1) - cos(b1c1)*cos(b2c1)*sinh(a1c1)*sinh(a2c1) + cosh(a1c1)*cosh(a2c1))**2.0 - 1))
    dlam1c2term = -a32*dt*sin(b1c2)*sin(b2c2)**(-1.0)*sin(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2)**(-1.0)/(m2*sqrt((-sin(b1c2)*sin(b2c2)*cos(g1c2 - g2c2)*sinh(a1c2)*sinh(a2c2) - cos(b1c2)*cos(b2c2)*sinh(a1c2)*sinh(a2c2) + cosh(a1c2)*cosh(a2c2))**2.0 - 1))
    dlam1n1term = -a33*dt*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1))
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = a31*dt*sin(b2c1)**(-1.0)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)**(-1.0)*sinh(a3c1)/(m2*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a32*dt*sin(b2c2)**(-1.0)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)**(-1.0)*sinh(a3c2)/(m2*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a33*dt*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex46(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ad3c1 - ad3n - dt*(a11*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd3c1**2.0 + gd3c1**2.0*sin(b3c1)**2.0)*sinh(2.0*a3c1)) + a12*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd3c2**2.0 + gd3c2**2.0*sin(b3c2)**2.0)*sinh(2.0*a3c2)) + a13*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1)))
    da1c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a13*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a13*dt*(lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a11*dt*(-lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(-lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a13*dt*(-lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a13*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a13*dt*(lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a11*dt*(-lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(-lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a13*dt*(-lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c1**2.0 + 0.5*gd3c1**2.0*sin(b3c1)**2.0)*cosh(2.0*a3c1))
    da3c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c2**2.0 + 0.5*gd3c2**2.0*sin(b3c2)**2.0)*cosh(2.0*a3c2))
    da3n1term   = -a13*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3n1**2.0 + 0.5*gd3n1**2.0*sin(b3n1)**2.0)*cosh(2.0*a3n1))
    db3c1term   = -a11*dt*(1.0*gd3c1**2.0*sin(b3c1)**1.0*cos(b3c1)*sinh(2.0*a3c1) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(1.0*gd3c2**2.0*sin(b3c2)**1.0*cos(b3c2)*sinh(2.0*a3c2) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a13*dt*(1.0*gd3n1**2.0*sin(b3n1)**1.0*cos(b3n1)*sinh(2.0*a3n1) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a11*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a13*dt*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 1.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = -1.0*a11*bd3c1**1.0*dt*sinh(2.0*a3c1)
    dbd3c2term  = -1.0*a12*bd3c2**1.0*dt*sinh(2.0*a3c2)
    dbd3n1term  = -1.0*a13*bd3n1**1.0*dt*sinh(2.0*a3n1)
    dgd3c1term  = -1.0*a11*dt*gd3c1**1.0*sin(b3c1)**2.0*sinh(2.0*a3c1)
    dgd3c2term  = -1.0*a12*dt*gd3c2**1.0*sin(b3c2)**2.0*sinh(2.0*a3c2)
    dgd3n1term  = -1.0*a13*dt*gd3n1**1.0*sin(b3n1)**2.0*sinh(2.0*a3n1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = a11*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a13*dt*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = a11*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a13*dt*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex47(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ad3c2 - ad3n - dt*(a21*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd3c1**2.0 + gd3c1**2.0*sin(b3c1)**2.0)*sinh(2.0*a3c1)) + a22*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd3c2**2.0 + gd3c2**2.0*sin(b3c2)**2.0)*sinh(2.0*a3c2)) + a23*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1)))
    da1c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a23*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a23*dt*(lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a21*dt*(-lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(-lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a23*dt*(-lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a23*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a23*dt*(lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a21*dt*(-lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(-lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a23*dt*(-lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c1**2.0 + 0.5*gd3c1**2.0*sin(b3c1)**2.0)*cosh(2.0*a3c1))
    da3c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c2**2.0 + 0.5*gd3c2**2.0*sin(b3c2)**2.0)*cosh(2.0*a3c2))
    da3n1term   = -a23*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3n1**2.0 + 0.5*gd3n1**2.0*sin(b3n1)**2.0)*cosh(2.0*a3n1))
    db3c1term   = -a21*dt*(1.0*gd3c1**2.0*sin(b3c1)**1.0*cos(b3c1)*sinh(2.0*a3c1) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(1.0*gd3c2**2.0*sin(b3c2)**1.0*cos(b3c2)*sinh(2.0*a3c2) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a23*dt*(1.0*gd3n1**2.0*sin(b3n1)**1.0*cos(b3n1)*sinh(2.0*a3n1) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a21*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a23*dt*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 1.
    dad3n1term  = 0.
    dbd3c1term  = -1.0*a21*bd3c1**1.0*dt*sinh(2.0*a3c1)
    dbd3c2term  = -1.0*a22*bd3c2**1.0*dt*sinh(2.0*a3c2)
    dbd3n1term  = -1.0*a23*bd3n1**1.0*dt*sinh(2.0*a3n1)
    dgd3c1term  = -1.0*a21*dt*gd3c1**1.0*sin(b3c1)**2.0*sinh(2.0*a3c1)
    dgd3c2term  = -1.0*a22*dt*gd3c2**1.0*sin(b3c2)**2.0*sinh(2.0*a3c2)
    dgd3n1term  = -1.0*a23*dt*gd3n1**1.0*sin(b3n1)**2.0*sinh(2.0*a3n1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = a21*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a23*dt*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = a21*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a23*dt*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex48(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -ad3n + ad3n1 - dt*(a31*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 0.5*(bd3c1**2.0 + gd3c1**2.0*sin(b3c1)**2.0)*sinh(2.0*a3c1)) + a32*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 0.5*(bd3c2**2.0 + gd3c2**2.0*sin(b3c2)**2.0)*sinh(2.0*a3c2)) + a33*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1)))
    da1c1term   = -a31*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*cosh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*cosh(a1c1)*cosh(a3c1) + sinh(a1c1)*sinh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a32*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*cosh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*cosh(a1c2)*cosh(a3c2) + sinh(a1c2)*sinh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a33*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a31*dt*(lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(sin(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) - sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a32*dt*(lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(sin(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) - sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a33*dt*(lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a31*dt*(-lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a32*dt*(-lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a33*dt*(-lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a31*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*cosh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*cosh(a2c1)*cosh(a3c1) + sinh(a2c1)*sinh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a32*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*cosh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*cosh(a2c2)*cosh(a3c2) + sinh(a2c2)*sinh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a33*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a31*dt*(lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) - sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a32*dt*(lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) - sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a33*dt*(lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a31*dt*(-lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a32*dt*(-lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a33*dt*(-lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a31*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c1**2.0 + 0.5*gd3c1**2.0*sin(b3c1)**2.0)*cosh(2.0*a3c1))
    da3c2term   = -a32*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3c2**2.0 + 0.5*gd3c2**2.0*sin(b3c2)**2.0)*cosh(2.0*a3c2))
    da3n1term   = -a33*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3n1**2.0 + 0.5*gd3n1**2.0*sin(b3n1)**2.0)*cosh(2.0*a3n1))
    db3c1term   = -a31*dt*(1.0*gd3c1**2.0*sin(b3c1)**1.0*cos(b3c1)*sinh(2.0*a3c1) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a32*dt*(1.0*gd3c2**2.0*sin(b3c2)**1.0*cos(b3c2)*sinh(2.0*a3c2) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a33*dt*(1.0*gd3n1**2.0*sin(b3n1)**1.0*cos(b3n1)*sinh(2.0*a3n1) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a31*dt*(lam2c1*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a32*dt*(lam2c2*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a33*dt*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 1.
    dbd3c1term  = -1.0*a31*bd3c1**1.0*dt*sinh(2.0*a3c1)
    dbd3c2term  = -1.0*a32*bd3c2**1.0*dt*sinh(2.0*a3c2)
    dbd3n1term  = -1.0*a33*bd3n1**1.0*dt*sinh(2.0*a3n1)
    dgd3c1term  = -1.0*a31*dt*gd3c1**1.0*sin(b3c1)**2.0*sinh(2.0*a3c1)
    dgd3c2term  = -1.0*a32*dt*gd3c2**1.0*sin(b3c2)**2.0*sinh(2.0*a3c2)
    dgd3n1term  = -1.0*a33*dt*gd3n1**1.0*sin(b3n1)**2.0*sinh(2.0*a3n1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = a31*dt*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + sinh(a3c1)*cosh(a1c1))/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a32*dt*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + sinh(a3c2)*cosh(a1c2))/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a33*dt*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = a31*dt*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + sinh(a3c1)*cosh(a2c1))/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a32*dt*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + sinh(a3c2)*cosh(a2c2))/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a33*dt*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex49(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = bd3c1 - bd3n - dt*(a11*(-2.0*ad3c1*bd3c1/tanh(a3c1) + 0.5*gd3c1**2*sin(2.0*b3c1) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad3c2*bd3c2/tanh(a3c2) + 0.5*gd3c2**2*sin(2.0*b3c2) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a13*(-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a11*dt*(lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a12*dt*(lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da1n1term   = -a13*dt*(lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db1c1term   = -a11*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a12*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1n1term   = -a13*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg1c1term   = -a11*dt*(1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a12*dt*(1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1n1term   = -a13*dt*(1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    da2c1term   = -a11*dt*(lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a12*dt*(lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da2n1term   = -a13*dt*(lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db2c1term   = -a11*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a12*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2n1term   = -a13*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg2c1term   = -a11*dt*(1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a12*dt*(1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2n1term   = -a13*dt*(1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    da3c1term   = -a11*dt*(-2.0*ad3c1*bd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 + 2.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 2.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a12*dt*(-2.0*ad3c2*bd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 + 2.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 2.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a13*dt*(-2.0*ad3n1*bd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 + 2.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 2.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a11*dt*(1.0*gd3c1**2*cos(2.0*b3c1) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a12*dt*(1.0*gd3c2**2*cos(2.0*b3c2) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a13*dt*(1.0*gd3n1**2*cos(2.0*b3n1) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a11*dt*(-1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a12*dt*(-1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a13*dt*(-1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 2.0*a11*bd3c1*dt/tanh(a3c1)
    dad3c2term  = 2.0*a12*bd3c2*dt/tanh(a3c2)
    dad3n1term  = 2.0*a13*bd3n1*dt/tanh(a3n1)
    dbd3c1term  = 2.0*a11*ad3c1*dt/tanh(a3c1) + 1
    dbd3c2term  = 2.0*a12*ad3c2*dt/tanh(a3c2)
    dbd3n1term  = 2.0*a13*ad3n1*dt/tanh(a3n1)
    dgd3c1term  = -1.0*a11*dt*gd3c1*sin(2.0*b3c1)
    dgd3c2term  = -1.0*a12*dt*gd3c2*sin(2.0*b3c2)
    dgd3n1term  = -1.0*a13*dt*gd3n1*sin(2.0*b3n1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = a11*dt*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a12*dt*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a13*dt*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = a11*dt*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a12*dt*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a13*dt*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex50(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = bd3c2 - bd3n - dt*(a21*(-2.0*ad3c1*bd3c1/tanh(a3c1) + 0.5*gd3c1**2*sin(2.0*b3c1) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad3c2*bd3c2/tanh(a3c2) + 0.5*gd3c2**2*sin(2.0*b3c2) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a23*(-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a21*dt*(lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a22*dt*(lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da1n1term   = -a23*dt*(lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db1c1term   = -a21*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a22*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1n1term   = -a23*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg1c1term   = -a21*dt*(1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a22*dt*(1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1n1term   = -a23*dt*(1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    da2c1term   = -a21*dt*(lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a22*dt*(lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da2n1term   = -a23*dt*(lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db2c1term   = -a21*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a22*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2n1term   = -a23*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg2c1term   = -a21*dt*(1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a22*dt*(1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2n1term   = -a23*dt*(1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    da3c1term   = -a21*dt*(-2.0*ad3c1*bd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 + 2.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 2.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a22*dt*(-2.0*ad3c2*bd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 + 2.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 2.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a23*dt*(-2.0*ad3n1*bd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 + 2.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 2.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a21*dt*(1.0*gd3c1**2*cos(2.0*b3c1) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a22*dt*(1.0*gd3c2**2*cos(2.0*b3c2) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a23*dt*(1.0*gd3n1**2*cos(2.0*b3n1) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a21*dt*(-1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a22*dt*(-1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a23*dt*(-1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 2.0*a21*bd3c1*dt/tanh(a3c1)
    dad3c2term  = 2.0*a22*bd3c2*dt/tanh(a3c2)
    dad3n1term  = 2.0*a23*bd3n1*dt/tanh(a3n1)
    dbd3c1term  = 2.0*a21*ad3c1*dt/tanh(a3c1)
    dbd3c2term  = 2.0*a22*ad3c2*dt/tanh(a3c2) + 1
    dbd3n1term  = 2.0*a23*ad3n1*dt/tanh(a3n1)
    dgd3c1term  = -1.0*a21*dt*gd3c1*sin(2.0*b3c1)
    dgd3c2term  = -1.0*a22*dt*gd3c2*sin(2.0*b3c2)
    dgd3n1term  = -1.0*a23*dt*gd3n1*sin(2.0*b3n1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = a21*dt*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a22*dt*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a23*dt*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = a21*dt*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a22*dt*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a23*dt*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex51(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -bd3n + bd3n1 - dt*(a31*(-2.0*ad3c1*bd3c1/tanh(a3c1) + 0.5*gd3c1**2*sin(2.0*b3c1) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a32*(-2.0*ad3c2*bd3c2/tanh(a3c2) + 0.5*gd3c2**2*sin(2.0*b3c2) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a33*(-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))))
    da1c1term   = -a31*dt*(lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) + sin(b3c1)*cos(b1c1)*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    da1c2term   = -a32*dt*(lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) + sin(b3c2)*cos(b1c2)*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    da1n1term   = -a33*dt*(lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    db1c1term   = -a31*dt*(-lam2c1*(-sin(b1c1)*sin(b3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db1c2term   = -a32*dt*(-lam2c2*(-sin(b1c2)*sin(b3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db1n1term   = -a33*dt*(-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg1c1term   = -a31*dt*(1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    dg1c2term   = -a32*dt*(1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    dg1n1term   = -a33*dt*(1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    da2c1term   = -a31*dt*(lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) + sin(b3c1)*cos(b2c1)*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da2c2term   = -a32*dt*(lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) + sin(b3c2)*cos(b2c2)*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da2n1term   = -a33*dt*(lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db2c1term   = -a31*dt*(-lam3c1*(-sin(b2c1)*sin(b3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db2c2term   = -a32*dt*(-lam3c2*(-sin(b2c2)*sin(b3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db2n1term   = -a33*dt*(-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg2c1term   = -a31*dt*(1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg2c2term   = -a32*dt*(1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg2n1term   = -a33*dt*(1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    da3c1term   = -a31*dt*(-2.0*ad3c1*bd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 + 2.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 2.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-3.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*cosh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    da3c2term   = -a32*dt*(-2.0*ad3c2*bd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 + 2.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 2.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-3.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*cosh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    da3n1term   = -a33*dt*(-2.0*ad3n1*bd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 + 2.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 2.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    db3c1term   = -a31*dt*(1.0*gd3c1**2*cos(2.0*b3c1) - lam2c1*(sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*(sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sinh(a3c1)**(-2.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    db3c2term   = -a32*dt*(1.0*gd3c2**2*cos(2.0*b3c2) - lam2c2*(sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*(sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sinh(a3c2)**(-2.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    db3n1term   = -a33*dt*(1.0*gd3n1**2*cos(2.0*b3n1) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dg3c1term   = -a31*dt*(-1.0*lam2c1*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b1c1)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b2c1)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    dg3c2term   = -a32*dt*(-1.0*lam2c2*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b1c2)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b2c2)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    dg3n1term   = -a33*dt*(-1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 2.0*a31*bd3c1*dt/tanh(a3c1)
    dad3c2term  = 2.0*a32*bd3c2*dt/tanh(a3c2)
    dad3n1term  = 2.0*a33*bd3n1*dt/tanh(a3n1)
    dbd3c1term  = 2.0*a31*ad3c1*dt/tanh(a3c1)
    dbd3c2term  = 2.0*a32*ad3c2*dt/tanh(a3c2)
    dbd3n1term  = 2.0*a33*ad3n1*dt/tanh(a3n1) + 1
    dgd3c1term  = -1.0*a31*dt*gd3c1*sin(2.0*b3c1)
    dgd3c2term  = -1.0*a32*dt*gd3c2*sin(2.0*b3c2)
    dgd3n1term  = -1.0*a33*dt*gd3n1*sin(2.0*b3n1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = a31*dt*(-sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = a32*dt*(-sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = a33*dt*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = a31*dt*(-sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*sinh(a3c1)**(-2.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = a32*dt*(-sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*sinh(a3c2)**(-2.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = a33*dt*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex52(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a11*(-2.0*ad3c1*gd3c1/tanh(a3c1) - 2.0*bd3c1*gd3c1/tan(b3c1) + lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a12*(-2.0*ad3c2*gd3c2/tanh(a3c2) - 2.0*bd3c2*gd3c2/tan(b3c2) + lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a13*(-2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd3n1*gd3n1/tan(b3n1) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))) + gd3c1 - gd3n
    da1c1term   = -a11*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a1c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a12*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a1c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a13*dt*(lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a1n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a11*dt*(-lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a12*dt*(-lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a13*dt*(-lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a11*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a12*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a13*dt*(lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a11*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a2c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a12*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a2c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a13*dt*(lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a2n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a11*dt*(-lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a12*dt*(-lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a13*dt*(-lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a11*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a12*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a13*dt*(lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a11*dt*(-2.0*ad3c1*gd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a12*dt*(-2.0*ad3c2*gd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a13*dt*(-2.0*ad3n1*gd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a11*dt*(-2.0*bd3c1*gd3c1*(-tan(b3c1)**2 - 1)/tan(b3c1)**2 - lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-2.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-2.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a12*dt*(-2.0*bd3c2*gd3c2*(-tan(b3c2)**2 - 1)/tan(b3c2)**2 - lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-2.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-2.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a13*dt*(-2.0*bd3n1*gd3n1*(-tan(b3n1)**2 - 1)/tan(b3n1)**2 - lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-2.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-2.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a11*dt*(-lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a12*dt*(-lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a13*dt*(-lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 2.0*a11*dt*gd3c1/tanh(a3c1)
    dad3c2term  = 2.0*a12*dt*gd3c2/tanh(a3c2)
    dad3n1term  = 2.0*a13*dt*gd3n1/tanh(a3n1)
    dbd3c1term  = 2.0*a11*dt*gd3c1/tan(b3c1)
    dbd3c2term  = 2.0*a12*dt*gd3c2/tan(b3c2)
    dbd3n1term  = 2.0*a13*dt*gd3n1/tan(b3n1)
    dgd3c1term  = -a11*dt*(-2.0*ad3c1/tanh(a3c1) - 2.0*bd3c1/tan(b3c1)) + 1
    dgd3c2term  = -a12*dt*(-2.0*ad3c2/tanh(a3c2) - 2.0*bd3c2/tan(b3c2))
    dgd3n1term  = -a13*dt*(-2.0*ad3n1/tanh(a3n1) - 2.0*bd3n1/tan(b3n1))
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = -a11*dt*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = -a12*dt*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = -a13*dt*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = -a11*dt*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = -a12*dt*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = -a13*dt*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex53(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a21*(-2.0*ad3c1*gd3c1/tanh(a3c1) - 2.0*bd3c1*gd3c1/tan(b3c1) + lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a22*(-2.0*ad3c2*gd3c2/tanh(a3c2) - 2.0*bd3c2*gd3c2/tan(b3c2) + lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a23*(-2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd3n1*gd3n1/tan(b3n1) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))) + gd3c2 - gd3n
    da1c1term   = -a21*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a1c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a22*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a1c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a23*dt*(lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a1n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a21*dt*(-lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a22*dt*(-lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a23*dt*(-lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a21*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a22*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a23*dt*(lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a21*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a2c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a22*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a2c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a23*dt*(lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a2n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a21*dt*(-lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a22*dt*(-lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a23*dt*(-lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a21*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a22*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a23*dt*(lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a21*dt*(-2.0*ad3c1*gd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a22*dt*(-2.0*ad3c2*gd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a23*dt*(-2.0*ad3n1*gd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a21*dt*(-2.0*bd3c1*gd3c1*(-tan(b3c1)**2 - 1)/tan(b3c1)**2 - lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-2.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-2.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a22*dt*(-2.0*bd3c2*gd3c2*(-tan(b3c2)**2 - 1)/tan(b3c2)**2 - lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-2.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-2.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a23*dt*(-2.0*bd3n1*gd3n1*(-tan(b3n1)**2 - 1)/tan(b3n1)**2 - lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-2.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-2.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a21*dt*(-lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a22*dt*(-lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a23*dt*(-lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 2.0*a21*dt*gd3c1/tanh(a3c1)
    dad3c2term  = 2.0*a22*dt*gd3c2/tanh(a3c2)
    dad3n1term  = 2.0*a23*dt*gd3n1/tanh(a3n1)
    dbd3c1term  = 2.0*a21*dt*gd3c1/tan(b3c1)
    dbd3c2term  = 2.0*a22*dt*gd3c2/tan(b3c2)
    dbd3n1term  = 2.0*a23*dt*gd3n1/tan(b3n1)
    dgd3c1term  = -a21*dt*(-2.0*ad3c1/tanh(a3c1) - 2.0*bd3c1/tan(b3c1))
    dgd3c2term  = -a22*dt*(-2.0*ad3c2/tanh(a3c2) - 2.0*bd3c2/tan(b3c2)) + 1
    dgd3n1term  = -a23*dt*(-2.0*ad3n1/tanh(a3n1) - 2.0*bd3n1/tan(b3n1))
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = -a21*dt*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = -a22*dt*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = -a23*dt*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = -a21*dt*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = -a22*dt*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = -a23*dt*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex54(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -dt*(a31*(-2.0*ad3c1*gd3c1/tanh(a3c1) - 2.0*bd3c1*gd3c1/tan(b3c1) + lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))) + a32*(-2.0*ad3c2*gd3c2/tanh(a3c2) - 2.0*bd3c2*gd3c2/tan(b3c2) + lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))) + a33*(-2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd3n1*gd3n1/tan(b3n1) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))) - gd3n + gd3n1
    da1c1term   = -a31*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a1c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a3c1)*cosh(a1c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a3c1)*cosh(a1c1) + 2.0*sinh(a1c1)*cosh(a3c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da1c2term   = -a32*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a1c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a3c2)*cosh(a1c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a3c2)*cosh(a1c2) + 2.0*sinh(a1c2)*cosh(a3c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da1n1term   = -a33*dt*(lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a1n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db1c1term   = -a31*dt*(-lam2c1*(2.0*sin(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b1c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam2c1*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)))
    db1c2term   = -a32*dt*(-lam2c2*(2.0*sin(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b1c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam2c2*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)))
    db1n1term   = -a33*dt*(-lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))
    dg1c1term   = -a31*dt*(lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg1c2term   = -a32*dt*(lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg1n1term   = -a33*dt*(lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da2c1term   = -a31*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a3c1)**(-1.0)*cosh(a2c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a3c1)*cosh(a2c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a3c1)*cosh(a2c1) + 2.0*sinh(a2c1)*cosh(a3c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da2c2term   = -a32*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a3c2)**(-1.0)*cosh(a2c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a3c2)*cosh(a2c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a3c2)*cosh(a2c2) + 2.0*sinh(a2c2)*cosh(a3c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da2n1term   = -a33*dt*(lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a2n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db2c1term   = -a31*dt*(-lam3c1*(2.0*sin(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) - 2.0*sin(b3c1)*cos(b2c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) + lam3c1*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db2c2term   = -a32*dt*(-lam3c2*(2.0*sin(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) - 2.0*sin(b3c2)*cos(b2c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) + lam3c2*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db2n1term   = -a33*dt*(-lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg2c1term   = -a31*dt*(lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg2c2term   = -a32*dt*(lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg2n1term   = -a33*dt*(lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    da3c1term   = -a31*dt*(-2.0*ad3c1*gd3c1*(tanh(a3c1)**2 - 1)/tanh(a3c1)**2 - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*(-2.0*sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*cosh(a3c1) - 2.0*cos(b1c1)*cos(b3c1)*sinh(a1c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a1c1))*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-2.0)*cosh(a3c1)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*(-2.0*sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*cosh(a3c1) - 2.0*cos(b2c1)*cos(b3c1)*sinh(a2c1)*cosh(a3c1) + 2.0*sinh(a3c1)*cosh(a2c1))*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    da3c2term   = -a32*dt*(-2.0*ad3c2*gd3c2*(tanh(a3c2)**2 - 1)/tanh(a3c2)**2 - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*(-2.0*sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*cosh(a3c2) - 2.0*cos(b1c2)*cos(b3c2)*sinh(a1c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a1c2))*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-2.0)*cosh(a3c2)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*(-2.0*sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*cosh(a3c2) - 2.0*cos(b2c2)*cos(b3c2)*sinh(a2c2)*cosh(a3c2) + 2.0*sinh(a3c2)*cosh(a2c2))*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    da3n1term   = -a33*dt*(-2.0*ad3n1*gd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    db3c1term   = -a31*dt*(-2.0*bd3c1*gd3c1*(-tan(b3c1)**2 - 1)/tan(b3c1)**2 - lam2c1*(-2.0*sin(b1c1)*cos(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b1c1)*sinh(a1c1)*sinh(a3c1))*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam2c1*sin(b1c1)*sin(b3c1)**(-2.0)*sin(g1c1 - g3c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) - lam3c1*(-2.0*sin(b2c1)*cos(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) + 2.0*sin(b3c1)*cos(b2c1)*sinh(a2c1)*sinh(a3c1))*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(2*m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - 1.0*lam3c1*sin(b2c1)*sin(b3c1)**(-2.0)*sin(g2c1 - g3c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)))
    db3c2term   = -a32*dt*(-2.0*bd3c2*gd3c2*(-tan(b3c2)**2 - 1)/tan(b3c2)**2 - lam2c2*(-2.0*sin(b1c2)*cos(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b1c2)*sinh(a1c2)*sinh(a3c2))*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam2c2*sin(b1c2)*sin(b3c2)**(-2.0)*sin(g1c2 - g3c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) - lam3c2*(-2.0*sin(b2c2)*cos(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) + 2.0*sin(b3c2)*cos(b2c2)*sinh(a2c2)*sinh(a3c2))*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(2*m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - 1.0*lam3c2*sin(b2c2)*sin(b3c2)**(-2.0)*sin(g2c2 - g3c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)))
    db3n1term   = -a33*dt*(-2.0*bd3n1*gd3n1*(-tan(b3n1)**2 - 1)/tan(b3n1)**2 - lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-2.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-2.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))
    dg3c1term   = -a31*dt*(-lam2c1*sin(b1c1)*sin(b3c1)**(-1.0)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam2c1*(-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**1.0*sin(b1c1)**2*sin(g1c1 - g3c1)**2*sinh(a1c1)**2/(m3*((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1)**(3/2)) - lam3c1*sin(b2c1)*sin(b3c1)**(-1.0)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)) + 1.0*lam3c1*(-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**1.0*sin(b2c1)**2*sin(g2c1 - g3c1)**2*sinh(a2c1)**2/(m3*((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1)**(3/2)))
    dg3c2term   = -a32*dt*(-lam2c2*sin(b1c2)*sin(b3c2)**(-1.0)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam2c2*(-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**1.0*sin(b1c2)**2*sin(g1c2 - g3c2)**2*sinh(a1c2)**2/(m3*((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1)**(3/2)) - lam3c2*sin(b2c2)*sin(b3c2)**(-1.0)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)) + 1.0*lam3c2*(-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**1.0*sin(b2c2)**2*sin(g2c2 - g3c2)**2*sinh(a2c2)**2/(m3*((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1)**(3/2)))
    dg3n1term   = -a33*dt*(-lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 2.0*a31*dt*gd3c1/tanh(a3c1)
    dad3c2term  = 2.0*a32*dt*gd3c2/tanh(a3c2)
    dad3n1term  = 2.0*a33*dt*gd3n1/tanh(a3n1)
    dbd3c1term  = 2.0*a31*dt*gd3c1/tan(b3c1)
    dbd3c2term  = 2.0*a32*dt*gd3c2/tan(b3c2)
    dbd3n1term  = 2.0*a33*dt*gd3n1/tan(b3n1)
    dgd3c1term  = -a31*dt*(-2.0*ad3c1/tanh(a3c1) - 2.0*bd3c1/tan(b3c1))
    dgd3c2term  = -a32*dt*(-2.0*ad3c2/tanh(a3c2) - 2.0*bd3c2/tan(b3c2))
    dgd3n1term  = -a33*dt*(-2.0*ad3n1/tanh(a3n1) - 2.0*bd3n1/tan(b3n1)) + 1
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = -a31*dt*sin(b1c1)*sin(b3c1)**(-1.0)*sin(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b1c1)*sin(b3c1)*cos(g1c1 - g3c1)*sinh(a1c1)*sinh(a3c1) - cos(b1c1)*cos(b3c1)*sinh(a1c1)*sinh(a3c1) + cosh(a1c1)*cosh(a3c1))**2.0 - 1))
    dlam2c2term = -a32*dt*sin(b1c2)*sin(b3c2)**(-1.0)*sin(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b1c2)*sin(b3c2)*cos(g1c2 - g3c2)*sinh(a1c2)*sinh(a3c2) - cos(b1c2)*cos(b3c2)*sinh(a1c2)*sinh(a3c2) + cosh(a1c2)*cosh(a3c2))**2.0 - 1))
    dlam2n1term = -a33*dt*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1))
    dlam3c1term = -a31*dt*sin(b2c1)*sin(b3c1)**(-1.0)*sin(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1)**(-1.0)/(m3*sqrt((-sin(b2c1)*sin(b3c1)*cos(g2c1 - g3c1)*sinh(a2c1)*sinh(a3c1) - cos(b2c1)*cos(b3c1)*sinh(a2c1)*sinh(a3c1) + cosh(a2c1)*cosh(a3c1))**2.0 - 1))
    dlam3c2term = -a32*dt*sin(b2c2)*sin(b3c2)**(-1.0)*sin(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2)**(-1.0)/(m3*sqrt((-sin(b2c2)*sin(b3c2)*cos(g2c2 - g3c2)*sinh(a2c2)*sinh(a3c2) - cos(b2c2)*cos(b3c2)*sinh(a2c2)*sinh(a3c2) + cosh(a2c2)*cosh(a3c2))**2.0 - 1))
    dlam3n1term = -a33*dt*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1))

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex55(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -leq1 + arccosh(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2 - 1)
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = (sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2 - 1)
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2 - 1)
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2 - 1)
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = (-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2 - 1)
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = -sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2 - 1)
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex56(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = -((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/(2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*cosh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*sinh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*cosh(a1n1))*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = -((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0/(2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + (-ad2n1*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) + (-ad1n1*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*cos(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(g1n1 - g2n1)*cos(b1n1) - (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*sin(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = -1.0*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2) + (ad2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + (ad1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*cosh(a1n1) + (bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + (bd1n1*sin(g1n1 - g2n1)*cos(b1n1) + (gd1n1 - gd2n1)*sin(b1n1)*cos(g1n1 - g2n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*sinh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*cosh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))/(2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2))
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = -((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0/(2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + (-ad2n1*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*sinh(a1n1)*cosh(a2n1) + (-ad1n1*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*cosh(a1n1) + (-(bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*sin(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*cos(b2n1))*sinh(a1n1))*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 1.0*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2) + (-ad2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + (-ad1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*cosh(a1n1) + (-bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + (-bd1n1*sin(g1n1 - g2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*cos(g1n1 - g2n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = 0.
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = 0.
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 0.
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = ((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = (sin(b1n1)*cos(b2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1)/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = ((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = (-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + sin(b2n1)*cos(b1n1))*sinh(a1n1)*sinh(a2n1)/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = -sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex57(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = (-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad1n1*ad2n1*sinh(a1n1)*sinh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad1n1**2.0*cosh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad2n1**2.0*cosh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a1n1) - (2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) + 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1**2.0*cos(b1n1)*cos(b2n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*cos(b1n1)*cos(b2n1) - (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = (-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*cosh(a2n1) + 2.0*ad1n1*ad2n1*sinh(a2n1)*cosh(a1n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a2n1)*cosh(a1n1) + ad1n1**2.0*sinh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*cosh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a2n1)*cosh(a1n1) + ad2n1**2.0*sinh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(2.0*(ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*cosh(a1n1)*cosh(a2n1) + 2.0*((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*sinh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*cosh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*sinh(a2n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*cosh(a1n1)*cosh(a2n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1n1**2.0 + 0.5*gd1n1**2.0*sin(b1n1)**2.0)*cosh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*cosh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*sinh(a2n1) + (-(-lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad1n1*bd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + 2.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (2.0*ad1n1*bd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 - 2.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 2.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (2.0*ad1n1*gd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a2n1)**(-1.0)*cosh(a1n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - 1.0*lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-2.0)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-2.0)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1n1**2.0 + 0.5*gd1n1**2.0*sin(b1n1)**2.0)*cosh(2.0*a1n1))*sinh(a1n1)*cosh(a2n1) + (-2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) - 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) + bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + bd1n1**2.0*cos(b1n1)*cos(b2n1) + 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + bd2n1**2.0*cos(b1n1)*cos(b2n1) + (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) + (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad1n1*ad2n1*sinh(a1n1)*sinh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad1n1**2.0*cosh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad2n1**2.0*cosh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a1n1) - (2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) + 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1**2.0*cos(b1n1)*cos(b2n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*cos(b1n1)*cos(b2n1) - (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/(2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2))
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = -(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad1n1*ad2n1*sinh(a1n1)*sinh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad1n1**2.0*cosh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad2n1**2.0*cosh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a1n1) - (2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) + 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1**2.0*cos(b1n1)*cos(b2n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*cos(b1n1)*cos(b2n1) - (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/(2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + (-2.0*ad1n1*ad2n1*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*cosh(a1n1)*cosh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1*cos(b1n1)*cos(b2n1) + bd2n1*sin(b1n1)*sin(b2n1) + bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + (-gd1n1 + gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1*cos(b1n1)*cos(b2n1) + bd2n1*sin(b1n1)*sin(b2n1) + bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + (-gd1n1 + gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1) + (sin(b1n1)*cos(b2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) + (sin(b1n1)*cos(b2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(-2.0*ad2n1*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) + 2.0*(-ad1n1*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*cos(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(g1n1 - g2n1)*cos(b1n1) - (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*sin(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a1n1)*cosh(a2n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(1.0*gd1n1**2.0*sin(b1n1)**1.0*cos(b1n1)*sinh(2.0*a1n1) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a1n1) + (lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a2n1)*cosh(a1n1) + (1.0*gd1n1**2.0*sin(b1n1)**1.0*cos(b1n1)*sinh(2.0*a1n1) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a2n1) + (2.0*bd1n1*bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*bd1n1*bd2n1*sin(b2n1)*cos(b1n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) - bd1n1**2.0*sin(b1n1)*cos(b2n1) + bd1n1**2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + 2.0*bd2n1*(gd1n1 - gd2n1)*sin(g1n1 - g2n1)*cos(b1n1)*cos(b2n1) - bd2n1**2.0*sin(b1n1)*cos(b2n1) + bd2n1**2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + (gd1n1 - gd2n1)**2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b1n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (2.0*ad1n1*bd1n1/tanh(a1n1) - 0.5*gd1n1**2*sin(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*cos(b1n1)*cos(b2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + (2.0*ad2n1*bd2n1/tanh(a2n1) - 0.5*gd2n1**2*sin(2.0*b2n1) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1) - (-1.0*gd1n1**2*cos(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (1.0*gd1n1**2*cos(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (2.0*bd1n1*gd1n1*(-tan(b1n1)**2 - 1)/tan(b1n1)**2 - lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - 1.0*lam1n1*sin(b1n1)**(-2.0)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)**(-2.0)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) - (2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*bd1n1*gd1n1/tan(b1n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = (2.0*ad1n1*ad2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + (-gd1n1 + gd2n1)*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) + ad1n1**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + (-gd1n1 + gd2n1)*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) + ad2n1**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(2.0*ad2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*(ad1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*cosh(a1n1) + (bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + (bd1n1*sin(g1n1 - g2n1)*cos(b1n1) + (gd1n1 - gd2n1)*sin(b1n1)*cos(g1n1 - g2n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + 2.0*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + (-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (2.0*bd1n1*bd2n1*sin(g1n1 - g2n1)*cos(b1n1)*cos(b2n1) + 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - bd1n1**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) + 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) - (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) - (-1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - (-1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) - (2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*bd1n1*gd1n1/tan(b1n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - 1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad1n1*ad2n1*sinh(a1n1)*sinh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad1n1**2.0*cosh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad2n1**2.0*cosh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a1n1) - (2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) + 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1**2.0*cos(b1n1)*cos(b2n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*cos(b1n1)*cos(b2n1) - (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = (-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a2n1)*cosh(a1n1) + 2.0*ad1n1*ad2n1*sinh(a1n1)*cosh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*cosh(a1n1)*cosh(a2n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*cosh(a2n1) + ad1n1**2.0*sinh(a2n1)*cosh(a1n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*cosh(a2n1) + ad2n1**2.0*sinh(a2n1)*cosh(a1n1) - (2.0*(ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*sinh(a2n1) + 2.0*((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*cosh(a2n1))*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*cosh(a1n1)*cosh(a2n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*sinh(a2n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2n1**2.0 + 0.5*gd2n1**2.0*sin(b2n1)**2.0)*cosh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*sinh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*cosh(a1n1)*cosh(a2n1) + (-(-lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 + 2.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (2.0*ad2n1*bd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 - 2.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 2.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-2.0*ad2n1*gd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 - 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-2.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*cosh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-2.0)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2n1**2.0 + 0.5*gd2n1**2.0*sin(b2n1)**2.0)*cosh(2.0*a2n1))*sinh(a2n1)*cosh(a1n1) + (-2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) - 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) + bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + bd1n1**2.0*cos(b1n1)*cos(b2n1) + 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + bd2n1**2.0*cos(b1n1)*cos(b2n1) + (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) + (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad1n1*ad2n1*sinh(a1n1)*sinh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad1n1**2.0*cosh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad2n1**2.0*cosh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a1n1) - (2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) + 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1**2.0*cos(b1n1)*cos(b2n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*cos(b1n1)*cos(b2n1) - (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/(2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2))
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = -(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad1n1*ad2n1*sinh(a1n1)*sinh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad1n1**2.0*cosh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad2n1**2.0*cosh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a1n1) - (2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) + 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1**2.0*cos(b1n1)*cos(b2n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*cos(b1n1)*cos(b2n1) - (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/(2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + (-2.0*ad1n1*ad2n1*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*cosh(a1n1)*cosh(a2n1) - 2.0*ad1n1*(bd1n1*sin(b1n1)*sin(b2n1) + bd1n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1*cos(b1n1)*cos(b2n1) + (-gd1n1 + gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*sinh(a1n1)*sinh(a2n1) - 2.0*ad2n1*(bd1n1*sin(b1n1)*sin(b2n1) + bd1n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1*cos(b1n1)*cos(b2n1) + (-gd1n1 + gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*sinh(a1n1)*sinh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(-2.0*ad2n1*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*sinh(a1n1)*cosh(a2n1) + 2.0*(-ad1n1*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*cosh(a1n1) + (-(bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*sin(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*cos(b2n1))*sinh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**2 - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a2n1)*cosh(a1n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(1.0*gd2n1**2.0*sin(b2n1)**1.0*cos(b2n1)*sinh(2.0*a2n1) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a2n1) + (-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + sin(b2n1)*cos(b1n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) + (-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + sin(b2n1)*cos(b1n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a1n1)*cosh(a2n1) + (1.0*gd2n1**2.0*sin(b2n1)**1.0*cos(b2n1)*sinh(2.0*a2n1) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a1n1) + (-2.0*bd1n1*bd2n1*sin(b1n1)*cos(b2n1) + 2.0*bd1n1*bd2n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + 2.0*bd1n1*(gd1n1 - gd2n1)*sin(g1n1 - g2n1)*cos(b1n1)*cos(b2n1) + bd1n1**2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd1n1**2.0*sin(b2n1)*cos(b1n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) + bd2n1**2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*sin(b2n1)*cos(b1n1) + (gd1n1 - gd2n1)**2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + (2.0*ad1n1*bd1n1/tanh(a1n1) - 0.5*gd1n1**2*sin(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (2.0*ad2n1*bd2n1/tanh(a2n1) - 0.5*gd2n1**2*sin(2.0*b2n1) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*cos(b1n1)*cos(b2n1) - (-1.0*gd2n1**2*cos(2.0*b2n1) + lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (1.0*gd2n1**2*cos(2.0*b2n1) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*bd2n1*gd2n1*(-tan(b2n1)**2 - 1)/tan(b2n1)**2 - lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-2.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 1.0*lam3n1*sin(b2n1)**(-2.0)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) - (2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*bd1n1*gd1n1/tan(b1n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = (-2.0*ad1n1*ad2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - 2.0*ad1n1*(bd1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) + bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - (-gd1n1 + gd2n1)*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*ad2n1*(bd1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) + bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - (-gd1n1 + gd2n1)*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(-2.0*ad2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*(-ad1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*cosh(a1n1) + (-bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + (-bd1n1*sin(g1n1 - g2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*cos(g1n1 - g2n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - 2.0*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) - (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + (lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-2.0*bd1n1*bd2n1*sin(g1n1 - g2n1)*cos(b1n1)*cos(b2n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd1n1**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + bd2n1**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) + (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) - (-1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - (-1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) + (2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*bd1n1*gd1n1/tan(b1n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + 1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*ad1n1*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad1n1*ad2n1*sinh(a1n1)*sinh(a2n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad1n1**2.0*cosh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(-bd1n1*sin(b1n1)*cos(b2n1) + bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - bd2n1*sin(b2n1)*cos(b1n1) - (gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) - ad2n1**2.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + ad2n1**2.0*cosh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a2n1)*cosh(a1n1) - (sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a1n1) - (2.0*bd1n1*bd2n1*sin(b1n1)*sin(b2n1) + 2.0*bd1n1*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*bd1n1*(gd1n1 - gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd1n1**2.0*cos(b1n1)*cos(b2n1) - 2.0*bd2n1*(gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - bd2n1**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - bd2n1**2.0*cos(b1n1)*cos(b2n1) - (gd1n1 - gd2n1)**2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = ((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-(-lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (-lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*cosh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*cosh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = ((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a1n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a2n1) + (lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a2n1) + (lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a1n1) + (-(-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b2n1) - (-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b1n1) - (-lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = ((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a2n1) + (lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a1n1) + (-(-1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - (1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1) - (-1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - (1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b1n1) - (-lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = (-2.0*ad1n1**1.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + 2.0*ad1n1**1.0*cosh(a1n1)*cosh(a2n1) - 2.0*ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad2n1*sinh(a1n1)*sinh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + (-2.0*bd1n1*sin(b1n1)*cos(b2n1)/tanh(a1n1) + 2.0*bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)/tanh(a1n1) - 2.0*gd1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)/tanh(a1n1))*sinh(a1n1)*sinh(a2n1) + (2.0*bd1n1*sin(b1n1)*cos(b2n1) - 2.0*bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - 2.0*bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + 2.0*bd2n1*sin(b2n1)*cos(b1n1) + 2.0*(gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = (-2.0*ad1n1*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*sinh(a2n1)*cosh(a1n1) - 2.0*ad2n1*(-sin(b1n1)*cos(b2n1) + sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1) + 1.0*bd1n1**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*sinh(2.0*a1n1)*sinh(a2n1)*cosh(a1n1) + 1.0*bd1n1**1.0*sinh(a1n1)*sinh(2.0*a1n1)*cosh(a2n1) - 2.0*(sin(b1n1)*cos(b2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1))*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + (-2.0*ad1n1*sin(b1n1)*cos(b2n1)/tanh(a1n1) + 2.0*ad1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)/tanh(a1n1) + 2.0*bd1n1**1.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + 2.0*bd1n1**1.0*cos(b1n1)*cos(b2n1) - 2.0*bd2n1*sin(b1n1)*sin(b2n1) - 2.0*bd2n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - 2.0*gd1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)/tan(b1n1) - (-2.0*gd1n1 + 2.0*gd2n1)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = (2.0*ad1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*ad2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + 1.0*gd1n1**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*sin(b1n1)**2.0*sinh(2.0*a1n1)*sinh(a2n1)*cosh(a1n1) + 1.0*gd1n1**1.0*sin(b1n1)**2.0*sinh(a1n1)*sinh(2.0*a1n1)*cosh(a2n1) - 2.0*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + (2.0*bd1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) + 2.0*bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) + 1.0*gd1n1*sin(b1n1)*sin(2.0*b1n1)*cos(b2n1) - 1.0*gd1n1*sin(2.0*b1n1)*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) + 2.0*(gd1n1 - gd2n1)**1.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (2.0*ad1n1/tanh(a1n1) + 2.0*bd1n1/tan(b1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = (-2.0*ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*cosh(a1n1)*cosh(a2n1) + 2.0*ad1n1*sinh(a1n1)*sinh(a2n1) - 2.0*ad2n1**1.0*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1) + 2.0*ad2n1**1.0*cosh(a1n1)*cosh(a2n1) - ((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(2.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + (2.0*bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)/tanh(a2n1) - 2.0*bd2n1*sin(b2n1)*cos(b1n1)/tanh(a2n1) + 2.0*gd2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)/tanh(a2n1))*sinh(a1n1)*sinh(a2n1) + (2.0*bd1n1*sin(b1n1)*cos(b2n1) - 2.0*bd1n1*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1) - 2.0*bd2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + 2.0*bd2n1*sin(b2n1)*cos(b1n1) + 2.0*(gd1n1 - gd2n1)*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*cosh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = (-2.0*ad1n1*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*sinh(a2n1)*cosh(a1n1) - 2.0*ad2n1*(sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) - sin(b2n1)*cos(b1n1))*sinh(a1n1)*cosh(a2n1) + 1.0*bd2n1**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*sinh(a1n1)*sinh(2.0*a2n1)*cosh(a2n1) + 1.0*bd2n1**1.0*sinh(a2n1)*sinh(2.0*a2n1)*cosh(a1n1) - 2.0*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + sin(b2n1)*cos(b1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + (2.0*ad2n1*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)/tanh(a2n1) - 2.0*ad2n1*sin(b2n1)*cos(b1n1)/tanh(a2n1) - 2.0*bd1n1*sin(b1n1)*sin(b2n1) - 2.0*bd1n1*cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1) + 2.0*bd2n1**1.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + 2.0*bd2n1**1.0*cos(b1n1)*cos(b2n1) + 2.0*gd2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)/tan(b2n1) - (-2.0*gd1n1 + 2.0*gd2n1)*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = (-2.0*ad1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*ad2n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + 1.0*gd2n1**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*sin(b2n1)**2.0*sinh(a1n1)*sinh(2.0*a2n1)*cosh(a2n1) + 1.0*gd2n1**1.0*sin(b2n1)**2.0*sinh(a2n1)*sinh(2.0*a2n1)*cosh(a1n1) + 2.0*((ad1n1 - ad2n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)))*sinh(a1n1)*cosh(a2n1) + ((-ad1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) + cos(b1n1)*cos(b2n1)) + ad2n1)*cosh(a1n1) + ((bd1n1 - bd2n1*cos(g1n1 - g2n1))*sin(b1n1)*cos(b2n1) + ((gd1n1 - gd2n1)*sin(b1n1)*sin(g1n1 - g2n1) + (-bd1n1*cos(g1n1 - g2n1) + bd2n1)*cos(b1n1))*sin(b2n1))*sinh(a1n1))*sinh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1) + (-2.0*bd1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1) - 2.0*bd2n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1) - 1.0*gd2n1*sin(b1n1)*sin(2.0*b2n1)*cos(b2n1)*cos(g1n1 - g2n1) + 1.0*gd2n1*sin(b2n1)*sin(2.0*b2n1)*cos(b1n1) - 2.0*(gd1n1 - gd2n1)**1.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - (-2.0*ad2n1/tanh(a2n1) - 2.0*bd2n1/tan(b2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1))*sinh(a1n1)*sinh(a2n1))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = ((-(sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1) + (-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - (-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sin(b2n1)*cos(b1n1)*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - (sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sin(b1n1)*cos(b2n1)*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + (sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a1n1)*sinh(a2n1) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sinh(a2n1)*cosh(a1n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sinh(a1n1)*cosh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = ((-(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sin(b1n1)*cos(b2n1)*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + (sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - sin(b2n1)*sin(b3n1)*sin(g1n1 - g2n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*sinh(a2n1) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sinh(a1n1)*cosh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = (((sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sin(b2n1)*cos(b1n1)*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + sin(b1n1)*sin(b3n1)*sin(g1n1 - g2n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*sinh(a2n1) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1) - cos(b1n1)*cos(b2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sinh(a2n1)*cosh(a1n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))/sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex58(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -leq2 + arccosh(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2 - 1)
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = (sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2 - 1)
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2 - 1)
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2 - 1)
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = (-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2 - 1)
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = -sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2 - 1)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex59(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = -((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/(2*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*cosh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*sinh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*cosh(a1n1))*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = -((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0/(2*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + (-ad3n1*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) + (-ad1n1*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*cos(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(g1n1 - g3n1)*cos(b1n1) - (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*sin(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = -1.0*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2) + (ad3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + (ad1n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*cosh(a1n1) + (bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + (bd1n1*sin(g1n1 - g3n1)*cos(b1n1) + (gd1n1 - gd3n1)*sin(b1n1)*cos(g1n1 - g3n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = 0.
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = 0.
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = 0.
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*sinh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*cosh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))/(2*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2))
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = -((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0/(2*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + (-ad3n1*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*sinh(a1n1)*cosh(a3n1) + (-ad1n1*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*cosh(a1n1) + (-(bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*sin(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*cos(b3n1))*sinh(a1n1))*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 1.0*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2) + (-ad3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + (-ad1n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*cosh(a1n1) + (-bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + (-bd1n1*sin(g1n1 - g3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*cos(g1n1 - g3n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = ((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = (sin(b1n1)*cos(b3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1)/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = ((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = (-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + sin(b3n1)*cos(b1n1))*sinh(a1n1)*sinh(a3n1)/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = -sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex60(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = (-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad1n1*ad3n1*sinh(a1n1)*sinh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad1n1**2.0*cosh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad3n1**2.0*cosh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a1n1) - (2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) + 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1**2.0*cos(b1n1)*cos(b3n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*cos(b1n1)*cos(b3n1) - (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = (-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*cosh(a3n1) + 2.0*ad1n1*ad3n1*sinh(a3n1)*cosh(a1n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a3n1)*cosh(a1n1) + ad1n1**2.0*sinh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*cosh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a3n1)*cosh(a1n1) + ad3n1**2.0*sinh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(2.0*(ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*cosh(a1n1)*cosh(a3n1) + 2.0*((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*sinh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*cosh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*sinh(a3n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*cosh(a1n1)*cosh(a3n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1n1**2.0 + 0.5*gd1n1**2.0*sin(b1n1)**2.0)*cosh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*cosh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*sinh(a3n1) + (-(-lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad1n1*bd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 + 2.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (2.0*ad1n1*bd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 - 2.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 2.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-3.0)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (2.0*ad1n1*gd1n1*(tanh(a1n1)**2 - 1)/tanh(a1n1)**2 - 1.0*lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-2.0)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a1n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-2.0)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd1n1**2.0 + 0.5*gd1n1**2.0*sin(b1n1)**2.0)*cosh(2.0*a1n1))*sinh(a1n1)*cosh(a3n1) + (-2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) - 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) + bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + bd1n1**2.0*cos(b1n1)*cos(b3n1) + 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + bd3n1**2.0*cos(b1n1)*cos(b3n1) + (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) + (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad1n1*ad3n1*sinh(a1n1)*sinh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad1n1**2.0*cosh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad3n1**2.0*cosh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a1n1) - (2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) + 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1**2.0*cos(b1n1)*cos(b3n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*cos(b1n1)*cos(b3n1) - (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/(2*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2))
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = -(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad1n1*ad3n1*sinh(a1n1)*sinh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad1n1**2.0*cosh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad3n1**2.0*cosh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a1n1) - (2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) + 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1**2.0*cos(b1n1)*cos(b3n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*cos(b1n1)*cos(b3n1) - (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/(2*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + (-2.0*ad1n1*ad3n1*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*cosh(a1n1)*cosh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1*cos(b1n1)*cos(b3n1) + bd3n1*sin(b1n1)*sin(b3n1) + bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + (-gd1n1 + gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1*cos(b1n1)*cos(b3n1) + bd3n1*sin(b1n1)*sin(b3n1) + bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + (-gd1n1 + gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1) + (sin(b1n1)*cos(b3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) + (sin(b1n1)*cos(b3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(-2.0*ad3n1*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) + 2.0*(-ad1n1*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*cos(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(g1n1 - g3n1)*cos(b1n1) - (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*sin(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a3n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(1.0*gd1n1**2.0*sin(b1n1)**1.0*cos(b1n1)*sinh(2.0*a1n1) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a1n1) + (lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a1n1) + (1.0*gd1n1**2.0*sin(b1n1)**1.0*cos(b1n1)*sinh(2.0*a1n1) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a3n1) + (2.0*bd1n1*bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*bd1n1*bd3n1*sin(b3n1)*cos(b1n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) - bd1n1**2.0*sin(b1n1)*cos(b3n1) + bd1n1**2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + 2.0*bd3n1*(gd1n1 - gd3n1)*sin(g1n1 - g3n1)*cos(b1n1)*cos(b3n1) - bd3n1**2.0*sin(b1n1)*cos(b3n1) + bd3n1**2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + (gd1n1 - gd3n1)**2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b1n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (2.0*ad1n1*bd1n1/tanh(a1n1) - 0.5*gd1n1**2*sin(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*cos(b1n1)*cos(b3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + (2.0*ad3n1*bd3n1/tanh(a3n1) - 0.5*gd3n1**2*sin(2.0*b3n1) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1) - (-1.0*gd1n1**2*cos(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (1.0*gd1n1**2*cos(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (2.0*bd1n1*gd1n1*(-tan(b1n1)**2 - 1)/tan(b1n1)**2 - lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - 1.0*lam1n1*sin(b1n1)**(-2.0)*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)**(-2.0)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) - (2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*ad3n1*gd3n1/tanh(a3n1) + 2.0*bd1n1*gd1n1/tan(b1n1) - 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = (2.0*ad1n1*ad3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + (-gd1n1 + gd3n1)*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) + ad1n1**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + (-gd1n1 + gd3n1)*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) + ad3n1**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(2.0*ad3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*(ad1n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*cosh(a1n1) + (bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + (bd1n1*sin(g1n1 - g3n1)*cos(b1n1) + (gd1n1 - gd3n1)*sin(b1n1)*cos(g1n1 - g3n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + 2.0*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + (-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (2.0*bd1n1*bd3n1*sin(g1n1 - g3n1)*cos(b1n1)*cos(b3n1) + 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - bd1n1**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) + 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) - (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) - (-1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - (-1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) - (2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*ad3n1*gd3n1/tanh(a3n1) + 2.0*bd1n1*gd1n1/tan(b1n1) - 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - 1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad1n1*ad3n1*sinh(a1n1)*sinh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad1n1**2.0*cosh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad3n1**2.0*cosh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a1n1) - (2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) + 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1**2.0*cos(b1n1)*cos(b3n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*cos(b1n1)*cos(b3n1) - (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = ((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-(-lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (-lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*cosh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a2n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = ((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a3n1)*cosh(a1n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a3n1) + (lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a1n1)*cosh(a3n1) + (lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a1n1) + (-(-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b3n1) - (-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b1n1) - (-lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(2*m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = ((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (-lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-(-1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (1.0*lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b2n1)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (-1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b2n1)**2*sin(g1n1 - g2n1)**2*sinh(a2n1)**2/(m1*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = (-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a3n1)*cosh(a1n1) + 2.0*ad1n1*ad3n1*sinh(a1n1)*cosh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*cosh(a1n1)*cosh(a3n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*cosh(a3n1) + ad1n1**2.0*sinh(a3n1)*cosh(a1n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*cosh(a3n1) + ad3n1**2.0*sinh(a3n1)*cosh(a1n1) - (2.0*(ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*sinh(a3n1) + 2.0*((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*cosh(a3n1))*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*cosh(a1n1)*cosh(a3n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*sinh(a3n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3n1**2.0 + 0.5*gd3n1**2.0*sin(b3n1)**2.0)*cosh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*sinh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*cosh(a1n1)*cosh(a3n1) + (-(-lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 + 2.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 2.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (2.0*ad3n1*bd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 - 2.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 2.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-2.0*ad3n1*gd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*cosh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3n1**2.0 + 0.5*gd3n1**2.0*sin(b3n1)**2.0)*cosh(2.0*a3n1))*sinh(a3n1)*cosh(a1n1) + (-2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) - 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) + bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + bd1n1**2.0*cos(b1n1)*cos(b3n1) + 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + bd3n1**2.0*cos(b1n1)*cos(b3n1) + (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) + (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad1n1*ad3n1*sinh(a1n1)*sinh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad1n1**2.0*cosh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad3n1**2.0*cosh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a1n1) - (2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) + 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1**2.0*cos(b1n1)*cos(b3n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*cos(b1n1)*cos(b3n1) - (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/(2*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2))
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = -(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad1n1*ad3n1*sinh(a1n1)*sinh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad1n1**2.0*cosh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad3n1**2.0*cosh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a1n1) - (2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) + 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1**2.0*cos(b1n1)*cos(b3n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*cos(b1n1)*cos(b3n1) - (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/(2*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + (-2.0*ad1n1*ad3n1*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*cosh(a1n1)*cosh(a3n1) - 2.0*ad1n1*(bd1n1*sin(b1n1)*sin(b3n1) + bd1n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1*cos(b1n1)*cos(b3n1) + (-gd1n1 + gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*sinh(a1n1)*sinh(a3n1) - 2.0*ad3n1*(bd1n1*sin(b1n1)*sin(b3n1) + bd1n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1*cos(b1n1)*cos(b3n1) + (-gd1n1 + gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*sinh(a1n1)*sinh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(-2.0*ad3n1*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*sinh(a1n1)*cosh(a3n1) + 2.0*(-ad1n1*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*cosh(a1n1) + (-(bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*sin(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*cos(b3n1))*sinh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**2 - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a1n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(1.0*gd3n1**2.0*sin(b3n1)**1.0*cos(b3n1)*sinh(2.0*a3n1) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a3n1) + (-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + sin(b3n1)*cos(b1n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) + (-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + sin(b3n1)*cos(b1n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*cosh(a3n1) + (1.0*gd3n1**2.0*sin(b3n1)**1.0*cos(b3n1)*sinh(2.0*a3n1) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a1n1) + (-2.0*bd1n1*bd3n1*sin(b1n1)*cos(b3n1) + 2.0*bd1n1*bd3n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + 2.0*bd1n1*(gd1n1 - gd3n1)*sin(g1n1 - g3n1)*cos(b1n1)*cos(b3n1) + bd1n1**2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd1n1**2.0*sin(b3n1)*cos(b1n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) + bd3n1**2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*sin(b3n1)*cos(b1n1) + (gd1n1 - gd3n1)**2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a1n1)**(-2.0)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + (2.0*ad1n1*bd1n1/tanh(a1n1) - 0.5*gd1n1**2*sin(2.0*b1n1) + lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (2.0*ad3n1*bd3n1/tanh(a3n1) - 0.5*gd3n1**2*sin(2.0*b3n1) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*cos(b1n1)*cos(b3n1) - (-1.0*gd3n1**2*cos(2.0*b3n1) + lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b1n1) - (1.0*gd3n1**2*cos(2.0*b3n1) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*bd3n1*gd3n1*(-tan(b3n1)**2 - 1)/tan(b3n1)**2 - lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-2.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(2*m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-2.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) - (2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*ad3n1*gd3n1/tanh(a3n1) + 2.0*bd1n1*gd1n1/tan(b1n1) - 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = (-2.0*ad1n1*ad3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - 2.0*ad1n1*(bd1n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) + bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - (-gd1n1 + gd3n1)*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*ad3n1*(bd1n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) + bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - (-gd1n1 + gd3n1)*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(-2.0*ad3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*(-ad1n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*cosh(a1n1) + (-bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + (-bd1n1*sin(g1n1 - g3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*cos(g1n1 - g3n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - 2.0*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) + (lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a1n1)*cosh(a3n1) - (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + (lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a1n1) + (-2.0*bd1n1*bd3n1*sin(g1n1 - g3n1)*cos(b1n1)*cos(b3n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd1n1**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + bd3n1**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) + (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) - (-1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - (1.0*lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - (-1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g1n1 - g3n1)**2*sinh(a3n1)**2/(m1*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) + (2.0*ad1n1*gd1n1/tanh(a1n1) - 2.0*ad3n1*gd3n1/tanh(a3n1) + 2.0*bd1n1*gd1n1/tan(b1n1) - 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + 1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*ad1n1*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad1n1*ad3n1*sinh(a1n1)*sinh(a3n1) - 2.0*ad1n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - ad1n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad1n1**2.0*cosh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(-bd1n1*sin(b1n1)*cos(b3n1) + bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - bd3n1*sin(b3n1)*cos(b1n1) - (gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) - ad3n1**2.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + ad3n1**2.0*cosh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a3n1)*cosh(a1n1) - (sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a1n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd1n1**2.0 + gd1n1**2.0*sin(b1n1)**2.0)*sinh(2.0*a1n1))*sinh(a1n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a1n1) - (2.0*bd1n1*bd3n1*sin(b1n1)*sin(b3n1) + 2.0*bd1n1*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*bd1n1*(gd1n1 - gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - bd1n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd1n1**2.0*cos(b1n1)*cos(b3n1) - 2.0*bd3n1*(gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - bd3n1**2.0*cos(b1n1)*cos(b3n1) - (gd1n1 - gd3n1)**2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1) + (-2.0*ad1n1*bd1n1/tanh(a1n1) + 0.5*gd1n1**2*sin(2.0*b1n1) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b1n1) - (-2.0*ad1n1*gd1n1/tanh(a1n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd1n1*gd1n1/tan(b1n1) + 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)**(-1.0)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = (-2.0*ad1n1**1.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + 2.0*ad1n1**1.0*cosh(a1n1)*cosh(a3n1) - 2.0*ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad3n1*sinh(a1n1)*sinh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + (-2.0*bd1n1*sin(b1n1)*cos(b3n1)/tanh(a1n1) + 2.0*bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)/tanh(a1n1) - 2.0*gd1n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)/tanh(a1n1))*sinh(a1n1)*sinh(a3n1) + (2.0*bd1n1*sin(b1n1)*cos(b3n1) - 2.0*bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - 2.0*bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + 2.0*bd3n1*sin(b3n1)*cos(b1n1) + 2.0*(gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = (-2.0*ad1n1*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*sinh(a3n1)*cosh(a1n1) - 2.0*ad3n1*(-sin(b1n1)*cos(b3n1) + sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1) + 1.0*bd1n1**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*sinh(2.0*a1n1)*sinh(a3n1)*cosh(a1n1) + 1.0*bd1n1**1.0*sinh(a1n1)*sinh(2.0*a1n1)*cosh(a3n1) - 2.0*(sin(b1n1)*cos(b3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1))*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + (-2.0*ad1n1*sin(b1n1)*cos(b3n1)/tanh(a1n1) + 2.0*ad1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)/tanh(a1n1) + 2.0*bd1n1**1.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + 2.0*bd1n1**1.0*cos(b1n1)*cos(b3n1) - 2.0*bd3n1*sin(b1n1)*sin(b3n1) - 2.0*bd3n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - 2.0*gd1n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)/tan(b1n1) - (-2.0*gd1n1 + 2.0*gd3n1)*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = (2.0*ad1n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*ad3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + 1.0*gd1n1**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*sin(b1n1)**2.0*sinh(2.0*a1n1)*sinh(a3n1)*cosh(a1n1) + 1.0*gd1n1**1.0*sin(b1n1)**2.0*sinh(a1n1)*sinh(2.0*a1n1)*cosh(a3n1) - 2.0*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + (2.0*bd1n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) + 2.0*bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) + 1.0*gd1n1*sin(b1n1)*sin(2.0*b1n1)*cos(b3n1) - 1.0*gd1n1*sin(2.0*b1n1)*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) + 2.0*(gd1n1 - gd3n1)**1.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (2.0*ad1n1/tanh(a1n1) + 2.0*bd1n1/tan(b1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = (-2.0*ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*cosh(a1n1)*cosh(a3n1) + 2.0*ad1n1*sinh(a1n1)*sinh(a3n1) - 2.0*ad3n1**1.0*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1) + 2.0*ad3n1**1.0*cosh(a1n1)*cosh(a3n1) - ((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(2.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + (2.0*bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)/tanh(a3n1) - 2.0*bd3n1*sin(b3n1)*cos(b1n1)/tanh(a3n1) + 2.0*gd3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)/tanh(a3n1))*sinh(a1n1)*sinh(a3n1) + (2.0*bd1n1*sin(b1n1)*cos(b3n1) - 2.0*bd1n1*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1) - 2.0*bd3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + 2.0*bd3n1*sin(b3n1)*cos(b1n1) + 2.0*(gd1n1 - gd3n1)*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*cosh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = (-2.0*ad1n1*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*sinh(a3n1)*cosh(a1n1) - 2.0*ad3n1*(sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) - sin(b3n1)*cos(b1n1))*sinh(a1n1)*cosh(a3n1) + 1.0*bd3n1**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*sinh(a1n1)*sinh(2.0*a3n1)*cosh(a3n1) + 1.0*bd3n1**1.0*sinh(a3n1)*sinh(2.0*a3n1)*cosh(a1n1) - 2.0*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + sin(b3n1)*cos(b1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + (2.0*ad3n1*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)/tanh(a3n1) - 2.0*ad3n1*sin(b3n1)*cos(b1n1)/tanh(a3n1) - 2.0*bd1n1*sin(b1n1)*sin(b3n1) - 2.0*bd1n1*cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1) + 2.0*bd3n1**1.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + 2.0*bd3n1**1.0*cos(b1n1)*cos(b3n1) + 2.0*gd3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)/tan(b3n1) - (-2.0*gd1n1 + 2.0*gd3n1)*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = (-2.0*ad1n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*ad3n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + 1.0*gd3n1**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*sin(b3n1)**2.0*sinh(a1n1)*sinh(2.0*a3n1)*cosh(a3n1) + 1.0*gd3n1**1.0*sin(b3n1)**2.0*sinh(a3n1)*sinh(2.0*a3n1)*cosh(a1n1) + 2.0*((ad1n1 - ad3n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)))*sinh(a1n1)*cosh(a3n1) + ((-ad1n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) + cos(b1n1)*cos(b3n1)) + ad3n1)*cosh(a1n1) + ((bd1n1 - bd3n1*cos(g1n1 - g3n1))*sin(b1n1)*cos(b3n1) + ((gd1n1 - gd3n1)*sin(b1n1)*sin(g1n1 - g3n1) + (-bd1n1*cos(g1n1 - g3n1) + bd3n1)*cos(b1n1))*sin(b3n1))*sinh(a1n1))*sinh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1) + (-2.0*bd1n1*sin(b3n1)*sin(g1n1 - g3n1)*cos(b1n1) - 2.0*bd3n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1) - 1.0*gd3n1*sin(b1n1)*sin(2.0*b3n1)*cos(b3n1)*cos(g1n1 - g3n1) + 1.0*gd3n1*sin(b3n1)*sin(2.0*b3n1)*cos(b1n1) - 2.0*(gd1n1 - gd3n1)**1.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - (-2.0*ad3n1/tanh(a3n1) - 2.0*bd3n1/tan(b3n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1))*sinh(a1n1)*sinh(a3n1))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = ((-(sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sin(b1n1)*cos(b3n1)*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + (sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - sin(b2n1)*sin(b3n1)*sin(g1n1 - g2n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a2n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a1n1)*sinh(a3n1) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + sinh(a1n1)*cosh(a2n1))*sinh(a1n1)*cosh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = ((-(sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + sin(b1n1)**(-1.0)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)**(-1.0)*sinh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1) + (-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sin(b3n1)*cos(b1n1)*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - (sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sin(b1n1)*cos(b3n1)*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + (sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)**(-2.0)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*sinh(a3n1) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sinh(a3n1)*cosh(a1n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sinh(a3n1)*cosh(a1n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + sinh(a1n1)*cosh(a3n1))*sinh(a1n1)*cosh(a3n1)/(m1*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = (((-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sin(b3n1)*cos(b1n1)*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - sin(b1n1)*sin(b2n1)*sin(g1n1 - g3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a1n1)*sinh(a3n1) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1) - cos(b1n1)*cos(b3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sinh(a3n1)*cosh(a1n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))/sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex61(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = -leq3 + arccosh(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2 - 1)
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = (sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2 - 1)
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2 - 1)
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2 - 1)
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = (-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2 - 1)
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = -sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2 - 1)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = 0.
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = 0.
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = 0.
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = 0.
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = 0.
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = 0.
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex62(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = 0.
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = 0.
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = 0.
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = -((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/(2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*cosh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*sinh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*cosh(a2n1))*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = -((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0/(2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + (-ad3n1*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) + (-ad2n1*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*cos(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(g2n1 - g3n1)*cos(b2n1) - (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*sin(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = -1.0*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2) + (ad3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + (ad2n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*cosh(a2n1) + (bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + (bd2n1*sin(g2n1 - g3n1)*cos(b2n1) + (gd2n1 - gd3n1)*sin(b2n1)*cos(g2n1 - g3n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*sinh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*cosh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))/(2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2))
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = -((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0/(2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + (-ad3n1*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*sinh(a2n1)*cosh(a3n1) + (-ad2n1*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*cosh(a2n1) + (-(bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*sin(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*cos(b3n1))*sinh(a2n1))*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = 1.0*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2) + (-ad3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + (-ad2n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*cosh(a2n1) + (-bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + (-bd2n1*sin(g2n1 - g3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*cos(g2n1 - g3n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = ((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = (sin(b2n1)*cos(b3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1)/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = ((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = (-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + sin(b3n1)*cos(b2n1))*sinh(a2n1)*sinh(a3n1)/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = -sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = 0.
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = 0.
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = 0.

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]

def h3rads3triex63(stepn,stepc1,stepc2,stepn1,dt,params):
    root6 = sqrt(6.)
    # Set to run RadauIIA 3-stage method
    a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
    a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
    a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
    bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

    a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
    a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
    a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
    a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
    m1,m2,m3,leq1,leq2,leq3 = params

    mainterm    = (-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad2n1*ad3n1*sinh(a2n1)*sinh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad2n1**2.0*cosh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad3n1**2.0*cosh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a2n1) - (2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) + 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1**2.0*cos(b2n1)*cos(b3n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*cos(b2n1)*cos(b3n1) - (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    da1c1term   = 0.
    da1c2term   = 0.
    da1n1term   = ((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*cosh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*cosh(a1n1)*cosh(a2n1) + sinh(a1n1)*sinh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*cosh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*cosh(a1n1)*cosh(a3n1) + sinh(a1n1)*sinh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-(-lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) + sin(b2n1)*cos(b1n1)*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (-lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) + sin(b3n1)*cos(b1n1)*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a2n1)**(-1.0)*cosh(a1n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a2n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a2n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a2n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a1n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a3n1)*cosh(a1n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a3n1)*cosh(a1n1) + 2.0*sinh(a1n1)*cosh(a3n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    db1c1term   = 0.
    db1c2term   = 0.
    db1n1term   = ((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a3n1)*cosh(a2n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a3n1) + (lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(sin(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) - sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a2n1)*cosh(a3n1) + (lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(sin(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) - sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a2n1) + (-(-lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (lam1n1*(-sin(b1n1)*sin(b2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b3n1) - (-lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (lam2n1*(-sin(b1n1)*sin(b3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b2n1) - (lam1n1*(2.0*sin(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) - 2.0*sin(b2n1)*cos(b1n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*(2.0*sin(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b1n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dg1c1term   = 0.
    dg1c2term   = 0.
    dg1n1term   = ((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-(-1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (-1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    da2c1term   = 0.
    da2c2term   = 0.
    da2n1term   = (-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*cosh(a3n1) + 2.0*ad2n1*ad3n1*sinh(a3n1)*cosh(a2n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a3n1)*cosh(a2n1) + ad2n1**2.0*sinh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*cosh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a3n1)*cosh(a2n1) + ad3n1**2.0*sinh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(2.0*(ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*cosh(a2n1)*cosh(a3n1) + 2.0*((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*sinh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*cosh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*sinh(a3n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*cosh(a2n1)*cosh(a3n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2n1**2.0 + 0.5*gd2n1**2.0*sin(b2n1)**2.0)*cosh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) + (-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*cosh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*sinh(a3n1) + (-(-lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad2n1*bd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 + 2.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 2.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (2.0*ad2n1*bd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 - 2.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 2.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-3.0)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (2.0*ad2n1*gd2n1*(tanh(a2n1)**2 - 1)/tanh(a2n1)**2 + 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-2.0)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a3n1)**(-1.0)*cosh(a2n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-2.0)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-2.0*sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - 2.0*cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a1n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd2n1**2.0 + 0.5*gd2n1**2.0*sin(b2n1)**2.0)*cosh(2.0*a2n1))*sinh(a2n1)*cosh(a3n1) + (-2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) - 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) + bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + bd2n1**2.0*cos(b2n1)*cos(b3n1) + 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + bd3n1**2.0*cos(b2n1)*cos(b3n1) + (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) + (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad2n1*ad3n1*sinh(a2n1)*sinh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad2n1**2.0*cosh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad3n1**2.0*cosh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a2n1) - (2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) + 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1**2.0*cos(b2n1)*cos(b3n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*cos(b2n1)*cos(b3n1) - (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/(2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2))
    db2c1term   = 0.
    db2c2term   = 0.
    db2n1term   = -(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad2n1*ad3n1*sinh(a2n1)*sinh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad2n1**2.0*cosh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad3n1**2.0*cosh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a2n1) - (2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) + 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1**2.0*cos(b2n1)*cos(b3n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*cos(b2n1)*cos(b3n1) - (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/(2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + (-2.0*ad2n1*ad3n1*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*cosh(a2n1)*cosh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1*cos(b2n1)*cos(b3n1) + bd3n1*sin(b2n1)*sin(b3n1) + bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + (-gd2n1 + gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1*cos(b2n1)*cos(b3n1) + bd3n1*sin(b2n1)*sin(b3n1) + bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + (-gd2n1 + gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1) + (sin(b2n1)*cos(b3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) + (sin(b2n1)*cos(b3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(-2.0*ad3n1*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) + 2.0*(-ad2n1*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*cos(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(g2n1 - g3n1)*cos(b2n1) - (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*sin(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a3n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(1.0*gd2n1**2.0*sin(b2n1)**1.0*cos(b2n1)*sinh(2.0*a2n1) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a2n1) + (lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a2n1) + (1.0*gd2n1**2.0*sin(b2n1)**1.0*cos(b2n1)*sinh(2.0*a2n1) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*cosh(a2n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a3n1) + (2.0*bd2n1*bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*bd2n1*bd3n1*sin(b3n1)*cos(b2n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) - bd2n1**2.0*sin(b2n1)*cos(b3n1) + bd2n1**2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + 2.0*bd3n1*(gd2n1 - gd3n1)*sin(g2n1 - g3n1)*cos(b2n1)*cos(b3n1) - bd3n1**2.0*sin(b2n1)*cos(b3n1) + bd3n1**2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + (gd2n1 - gd3n1)**2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b2n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (2.0*ad2n1*bd2n1/tanh(a2n1) - 0.5*gd2n1**2*sin(2.0*b2n1) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*cos(b2n1)*cos(b3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + (2.0*ad3n1*bd3n1/tanh(a3n1) - 0.5*gd3n1**2*sin(2.0*b3n1) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1) - (-1.0*gd2n1**2*cos(2.0*b2n1) + lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (1.0*gd2n1**2*cos(2.0*b2n1) - lam1n1*(sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (2.0*bd2n1*gd2n1*(-tan(b2n1)**2 - 1)/tan(b2n1)**2 + lam1n1*(-2.0*sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + 2.0*sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(2*m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + 1.0*lam1n1*sin(b1n1)*sin(b2n1)**(-2.0)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(2.0*sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)**(-2.0)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) - (2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*ad3n1*gd3n1/tanh(a3n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dg2c1term   = 0.
    dg2c2term   = 0.
    dg2n1term   = (2.0*ad2n1*ad3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + (-gd2n1 + gd3n1)*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) + ad2n1**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + (-gd2n1 + gd3n1)*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) + ad3n1**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(2.0*ad3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*(ad2n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*cosh(a2n1) + (bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + (bd2n1*sin(g2n1 - g3n1)*cos(b2n1) + (gd2n1 - gd3n1)*sin(b2n1)*cos(g2n1 - g3n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + 2.0*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + (lam1n1*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (2.0*bd2n1*bd3n1*sin(g2n1 - g3n1)*cos(b2n1)*cos(b3n1) + 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - bd2n1**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) + 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) - (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) - (-1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - (-1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + 1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (1.0*lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)*sin(b2n1)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) - lam1n1*sin(b1n1)*sin(g1n1 - g2n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - 1.0*lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**1.0*sin(b1n1)**2*sin(g1n1 - g2n1)**2*sinh(a1n1)**2/(m2*((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) - (2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*ad3n1*gd3n1/tanh(a3n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - 1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad2n1*ad3n1*sinh(a2n1)*sinh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad2n1**2.0*cosh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad3n1**2.0*cosh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a2n1) - (2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) + 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1**2.0*cos(b2n1)*cos(b3n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*cos(b2n1)*cos(b3n1) - (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)
    da3c1term   = 0.
    da3c2term   = 0.
    da3n1term   = (-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a3n1)*cosh(a2n1) + 2.0*ad2n1*ad3n1*sinh(a2n1)*cosh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*cosh(a2n1)*cosh(a3n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*cosh(a3n1) + ad2n1**2.0*sinh(a3n1)*cosh(a2n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*cosh(a3n1) + ad3n1**2.0*sinh(a3n1)*cosh(a2n1) - (2.0*(ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*sinh(a3n1) + 2.0*((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*cosh(a3n1))*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*cosh(a2n1)*cosh(a3n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*sinh(a3n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3n1**2.0 + 0.5*gd3n1**2.0*sin(b3n1)**2.0)*cosh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (-lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*cosh(a2n1)*cosh(a3n1) + sinh(a2n1)*sinh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*sinh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*cosh(a2n1)*cosh(a3n1) + (-(-lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 + 2.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 2.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (2.0*ad3n1*bd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 - 2.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 2.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-3.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-2.0*ad3n1*gd3n1*(tanh(a3n1)**2 - 1)/tanh(a3n1)**2 - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-2.0)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*cosh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-2.0*sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - 2.0*cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a1n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + 2.0*(0.5*bd3n1**2.0 + 0.5*gd3n1**2.0*sin(b3n1)**2.0)*cosh(2.0*a3n1))*sinh(a3n1)*cosh(a2n1) + (-2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) - 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) + bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + bd2n1**2.0*cos(b2n1)*cos(b3n1) + 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + bd3n1**2.0*cos(b2n1)*cos(b3n1) + (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) + (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - 2.0*cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad2n1*ad3n1*sinh(a2n1)*sinh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad2n1**2.0*cosh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad3n1**2.0*cosh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a2n1) - (2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) + 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1**2.0*cos(b2n1)*cos(b3n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*cos(b2n1)*cos(b3n1) - (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/(2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2))
    db3c1term   = 0.
    db3c2term   = 0.
    db3n1term   = -(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad2n1*ad3n1*sinh(a2n1)*sinh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad2n1**2.0*cosh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad3n1**2.0*cosh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a2n1) - (2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) + 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1**2.0*cos(b2n1)*cos(b3n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*cos(b2n1)*cos(b3n1) - (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/(2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + (-2.0*ad2n1*ad3n1*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*cosh(a2n1)*cosh(a3n1) - 2.0*ad2n1*(bd2n1*sin(b2n1)*sin(b3n1) + bd2n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1*cos(b2n1)*cos(b3n1) + (-gd2n1 + gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*sinh(a2n1)*sinh(a3n1) - 2.0*ad3n1*(bd2n1*sin(b2n1)*sin(b3n1) + bd2n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1*cos(b2n1)*cos(b3n1) + (-gd2n1 + gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*sinh(a2n1)*sinh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(-2.0*ad3n1*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*sinh(a2n1)*cosh(a3n1) + 2.0*(-ad2n1*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*cosh(a2n1) + (-(bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*sin(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*cos(b3n1))*sinh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**2 - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a2n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(1.0*gd3n1**2.0*sin(b3n1)**1.0*cos(b3n1)*sinh(2.0*a3n1) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a3n1) + (-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + sin(b3n1)*cos(b2n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) + (-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + sin(b3n1)*cos(b2n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + sin(b3n1)*cos(b2n1)*sinh(a3n1)*cosh(a2n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*cosh(a3n1) + (1.0*gd3n1**2.0*sin(b3n1)**1.0*cos(b3n1)*sinh(2.0*a3n1) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*cosh(a3n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*cosh(a3n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a3n1)*cosh(a2n1) + (-2.0*bd2n1*bd3n1*sin(b2n1)*cos(b3n1) + 2.0*bd2n1*bd3n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + 2.0*bd2n1*(gd2n1 - gd3n1)*sin(g2n1 - g3n1)*cos(b2n1)*cos(b3n1) + bd2n1**2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd2n1**2.0*sin(b3n1)*cos(b2n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) + bd3n1**2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*sin(b3n1)*cos(b2n1) + (gd2n1 - gd3n1)**2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (lam3n1*(-sin(b2n1)*sin(b3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a2n1)**(-2.0)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + (2.0*ad2n1*bd2n1/tanh(a2n1) - 0.5*gd2n1**2*sin(2.0*b2n1) + lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (2.0*ad3n1*bd3n1/tanh(a3n1) - 0.5*gd3n1**2*sin(2.0*b3n1) + lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*cos(b2n1)*cos(b3n1) - (-1.0*gd3n1**2*cos(2.0*b3n1) + lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b3n1)*cos(b2n1) - (1.0*gd3n1**2*cos(2.0*b3n1) - lam2n1*(sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sinh(a3n1)**(-2.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*bd3n1*gd3n1*(-tan(b3n1)**2 - 1)/tan(b3n1)**2 - lam2n1*(-2.0*sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam2n1*sin(b1n1)*sin(b3n1)**(-2.0)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(2*m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - 1.0*lam3n1*sin(b2n1)*sin(b3n1)**(-2.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-2.0*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + 2.0*sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(2*m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)**(-1.0)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) - (2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*ad3n1*gd3n1/tanh(a3n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dg3c1term   = 0.
    dg3c2term   = 0.
    dg3n1term   = (-2.0*ad2n1*ad3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*cosh(a2n1)*cosh(a3n1) - 2.0*ad2n1*(bd2n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) + bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - (-gd2n1 + gd3n1)*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - 2.0*ad3n1*(bd2n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) + bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - (-gd2n1 + gd3n1)*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(-2.0*ad3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + 2.0*(-ad2n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*cosh(a2n1) + (-bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + (-bd2n1*sin(g2n1 - g3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*cos(g2n1 - g3n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - 2.0*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**2 + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) + (lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a2n1)*cosh(a3n1) - (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + (lam2n1*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sinh(a3n1)*cosh(a2n1) + (-2.0*bd2n1*bd3n1*sin(g2n1 - g3n1)*cos(b2n1)*cos(b3n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd2n1**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + bd3n1**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) + (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) - (-1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - (1.0*lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - (-1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - 1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) + lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (1.0*lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)*sin(b3n1)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam2n1*sin(b1n1)*sin(g1n1 - g3n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**1.0*sin(b1n1)**2*sin(g1n1 - g3n1)**2*sinh(a1n1)**2/(m3*((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b2n1)**2*sin(g2n1 - g3n1)**2*sinh(a2n1)**2/(m3*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 1.0*lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*sin(b3n1)**2*sin(g2n1 - g3n1)**2*sinh(a3n1)**2/(m2*((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) + (2.0*ad2n1*gd2n1/tanh(a2n1) - 2.0*ad3n1*gd3n1/tanh(a3n1) + 2.0*bd2n1*gd2n1/tan(b2n1) - 2.0*bd3n1*gd3n1/tan(b3n1) - lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + 1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**1.0*(-2.0*ad2n1*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad2n1*ad3n1*sinh(a2n1)*sinh(a3n1) - 2.0*ad2n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - ad2n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad2n1**2.0*cosh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(-bd2n1*sin(b2n1)*cos(b3n1) + bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - bd3n1*sin(b3n1)*cos(b2n1) - (gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) - ad3n1**2.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + ad3n1**2.0*cosh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a3n1)*cosh(a2n1) - (sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*(-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a2n1)*cosh(a3n1) + (-lam1n1*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd2n1**2.0 + gd2n1**2.0*sin(b2n1)**2.0)*sinh(2.0*a2n1))*sinh(a2n1)*cosh(a3n1) + (-lam2n1*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + 0.5*(bd3n1**2.0 + gd3n1**2.0*sin(b3n1)**2.0)*sinh(2.0*a3n1))*sinh(a3n1)*cosh(a2n1) - (2.0*bd2n1*bd3n1*sin(b2n1)*sin(b3n1) + 2.0*bd2n1*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*bd2n1*(gd2n1 - gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - bd2n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd2n1**2.0*cos(b2n1)*cos(b3n1) - 2.0*bd3n1*(gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - bd3n1**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - bd3n1**2.0*cos(b2n1)*cos(b3n1) - (gd2n1 - gd3n1)**2.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1) + (-2.0*ad2n1*bd2n1/tanh(a2n1) + 0.5*gd2n1**2*sin(2.0*b2n1) - lam1n1*(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam3n1*(sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1*bd3n1/tanh(a3n1) + 0.5*gd3n1**2*sin(2.0*b3n1) - lam2n1*(-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b3n1)*cos(b2n1) - (-2.0*ad2n1*gd2n1/tanh(a2n1) + 2.0*ad3n1*gd3n1/tanh(a3n1) - 2.0*bd2n1*gd2n1/tan(b2n1) + 2.0*bd3n1*gd3n1/tan(b3n1) + lam1n1*sin(b1n1)*sin(b2n1)**(-1.0)*sin(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - lam2n1*sin(b1n1)*sin(b3n1)**(-1.0)*sin(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - lam3n1*sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)**(3/2)
    dad1c1term  = 0.
    dad1c2term  = 0.
    dad1n1term  = 0.
    dbd1c1term  = 0.
    dbd1c2term  = 0.
    dbd1n1term  = 0.
    dgd1c1term  = 0.
    dgd1c2term  = 0.
    dgd1n1term  = 0.
    dad2c1term  = 0.
    dad2c2term  = 0.
    dad2n1term  = (-2.0*ad2n1**1.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + 2.0*ad2n1**1.0*cosh(a2n1)*cosh(a3n1) - 2.0*ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad3n1*sinh(a2n1)*sinh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*sinh(a3n1)*cosh(a2n1) + 2.0*sinh(a2n1)*cosh(a3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + (-2.0*bd2n1*sin(b2n1)*cos(b3n1)/tanh(a2n1) + 2.0*bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)/tanh(a2n1) - 2.0*gd2n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)/tanh(a2n1))*sinh(a2n1)*sinh(a3n1) + (2.0*bd2n1*sin(b2n1)*cos(b3n1) - 2.0*bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - 2.0*bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + 2.0*bd3n1*sin(b3n1)*cos(b2n1) + 2.0*(gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dbd2c1term  = 0.
    dbd2c2term  = 0.
    dbd2n1term  = (-2.0*ad2n1*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*sinh(a3n1)*cosh(a2n1) - 2.0*ad3n1*(-sin(b2n1)*cos(b3n1) + sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1) + 1.0*bd2n1**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*sinh(2.0*a2n1)*sinh(a3n1)*cosh(a2n1) + 1.0*bd2n1**1.0*sinh(a2n1)*sinh(2.0*a2n1)*cosh(a3n1) - 2.0*(sin(b2n1)*cos(b3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1))*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + (-2.0*ad2n1*sin(b2n1)*cos(b3n1)/tanh(a2n1) + 2.0*ad2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)/tanh(a2n1) + 2.0*bd2n1**1.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + 2.0*bd2n1**1.0*cos(b2n1)*cos(b3n1) - 2.0*bd3n1*sin(b2n1)*sin(b3n1) - 2.0*bd3n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - 2.0*gd2n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)/tan(b2n1) - (-2.0*gd2n1 + 2.0*gd3n1)*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dgd2c1term  = 0.
    dgd2c2term  = 0.
    dgd2n1term  = (2.0*ad2n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) + 2.0*ad3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + 1.0*gd2n1**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*sin(b2n1)**2.0*sinh(2.0*a2n1)*sinh(a3n1)*cosh(a2n1) + 1.0*gd2n1**1.0*sin(b2n1)**2.0*sinh(a2n1)*sinh(2.0*a2n1)*cosh(a3n1) - 2.0*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + (2.0*bd2n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) + 2.0*bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) + 1.0*gd2n1*sin(b2n1)*sin(2.0*b2n1)*cos(b3n1) - 1.0*gd2n1*sin(2.0*b2n1)*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) + 2.0*(gd2n1 - gd3n1)**1.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (2.0*ad2n1/tanh(a2n1) + 2.0*bd2n1/tan(b2n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dad3c1term  = 0.
    dad3c2term  = 0.
    dad3n1term  = (-2.0*ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*cosh(a2n1)*cosh(a3n1) + 2.0*ad2n1*sinh(a2n1)*sinh(a3n1) - 2.0*ad3n1**1.0*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1) + 2.0*ad3n1**1.0*cosh(a2n1)*cosh(a3n1) - ((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(2.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*sinh(a2n1)*cosh(a3n1) + 2.0*sinh(a3n1)*cosh(a2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + (2.0*bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)/tanh(a3n1) - 2.0*bd3n1*sin(b3n1)*cos(b2n1)/tanh(a3n1) + 2.0*gd3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)/tanh(a3n1))*sinh(a2n1)*sinh(a3n1) + (2.0*bd2n1*sin(b2n1)*cos(b3n1) - 2.0*bd2n1*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1) - 2.0*bd3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + 2.0*bd3n1*sin(b3n1)*cos(b2n1) + 2.0*(gd2n1 - gd3n1)*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*cosh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dbd3c1term  = 0.
    dbd3c2term  = 0.
    dbd3n1term  = (-2.0*ad2n1*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*sinh(a3n1)*cosh(a2n1) - 2.0*ad3n1*(sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) - sin(b3n1)*cos(b2n1))*sinh(a2n1)*cosh(a3n1) + 1.0*bd3n1**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*sinh(a2n1)*sinh(2.0*a3n1)*cosh(a3n1) + 1.0*bd3n1**1.0*sinh(a3n1)*sinh(2.0*a3n1)*cosh(a2n1) - 2.0*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + sin(b3n1)*cos(b2n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + (2.0*ad3n1*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)/tanh(a3n1) - 2.0*ad3n1*sin(b3n1)*cos(b2n1)/tanh(a3n1) - 2.0*bd2n1*sin(b2n1)*sin(b3n1) - 2.0*bd2n1*cos(b2n1)*cos(b3n1)*cos(g2n1 - g3n1) + 2.0*bd3n1**1.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + 2.0*bd3n1**1.0*cos(b2n1)*cos(b3n1) + 2.0*gd3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)/tan(b3n1) - (-2.0*gd2n1 + 2.0*gd3n1)*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dgd3c1term  = 0.
    dgd3c2term  = 0.
    dgd3n1term  = (-2.0*ad2n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - 2.0*ad3n1*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) + 1.0*gd3n1**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*sin(b3n1)**2.0*sinh(a2n1)*sinh(2.0*a3n1)*cosh(a3n1) + 1.0*gd3n1**1.0*sin(b3n1)**2.0*sinh(a3n1)*sinh(2.0*a3n1)*cosh(a2n1) + 2.0*((ad2n1 - ad3n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)))*sinh(a2n1)*cosh(a3n1) + ((-ad2n1*(sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) + cos(b2n1)*cos(b3n1)) + ad3n1)*cosh(a2n1) + ((bd2n1 - bd3n1*cos(g2n1 - g3n1))*sin(b2n1)*cos(b3n1) + ((gd2n1 - gd3n1)*sin(b2n1)*sin(g2n1 - g3n1) + (-bd2n1*cos(g2n1 - g3n1) + bd3n1)*cos(b2n1))*sin(b3n1))*sinh(a2n1))*sinh(a3n1))**1.0*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)/((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1) + (-2.0*bd2n1*sin(b3n1)*sin(g2n1 - g3n1)*cos(b2n1) - 2.0*bd3n1*sin(b2n1)*sin(g2n1 - g3n1)*cos(b3n1) - 1.0*gd3n1*sin(b2n1)*sin(2.0*b3n1)*cos(b3n1)*cos(g2n1 - g3n1) + 1.0*gd3n1*sin(b3n1)*sin(2.0*b3n1)*cos(b2n1) - 2.0*(gd2n1 - gd3n1)**1.0*sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - (-2.0*ad3n1/tanh(a3n1) - 2.0*bd3n1/tan(b3n1))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1))*sinh(a2n1)*sinh(a3n1))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dlam1c1term = 0.
    dlam1c2term = 0.
    dlam1n1term = ((-(-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sin(b2n1)*cos(b3n1)*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + (-sin(b1n1)*cos(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) + sin(b2n1)*cos(b1n1)*sinh(a1n1)*sinh(a2n1))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) + sin(b1n1)*sin(b3n1)*sin(g1n1 - g2n1)*sin(g2n1 - g3n1)*sinh(a1n1)*sinh(a2n1)**(-1.0)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))*sinh(a2n1)*sinh(a3n1) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)) - (-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*cosh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*cosh(a2n1) + sinh(a2n1)*cosh(a1n1))*sinh(a2n1)*cosh(a3n1)/(m2*sqrt((-sin(b1n1)*sin(b2n1)*cos(g1n1 - g2n1)*sinh(a1n1)*sinh(a2n1) - cos(b1n1)*cos(b2n1)*sinh(a1n1)*sinh(a2n1) + cosh(a1n1)*cosh(a2n1))**2.0 - 1)))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dlam2c1term = 0.
    dlam2c2term = 0.
    dlam2n1term = (((-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b1n1)*cos(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) + sin(b3n1)*cos(b1n1)*sinh(a1n1)*sinh(a3n1))*sin(b3n1)*cos(b2n1)*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - sin(b1n1)*sin(b2n1)*sin(g1n1 - g3n1)*sin(g2n1 - g3n1)*sinh(a1n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*sinh(a3n1) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*cosh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*cosh(a3n1) + sinh(a3n1)*cosh(a1n1))*sinh(a3n1)*cosh(a2n1)/(m3*sqrt((-sin(b1n1)*sin(b3n1)*cos(g1n1 - g3n1)*sinh(a1n1)*sinh(a3n1) - cos(b1n1)*cos(b3n1)*sinh(a1n1)*sinh(a3n1) + cosh(a1n1)*cosh(a3n1))**2.0 - 1)))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)
    dlam3c1term = 0.
    dlam3c2term = 0.
    dlam3n1term = ((-(sin(b2n1)*sin(b3n1)**(-1.0)*sin(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1)**(-1.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + sin(b2n1)**(-1.0)*sin(b3n1)*sin(g2n1 - g3n1)*sinh(a2n1)**(-1.0)*sinh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sin(b2n1)*sin(b3n1)*sin(g2n1 - g3n1) + (-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b2n1)*cos(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) + sin(b3n1)*cos(b2n1)*sinh(a2n1)*sinh(a3n1))*sin(b3n1)*cos(b2n1)*sinh(a3n1)**(-2.0)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sin(b2n1)*cos(b3n1)*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) + (sin(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) - sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1))*sin(b3n1)*cos(b2n1)*cos(g2n1 - g3n1)*sinh(a2n1)**(-2.0)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))*sinh(a2n1)*sinh(a3n1) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sinh(a2n1)*cosh(a3n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*cosh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*cosh(a3n1) + sinh(a3n1)*cosh(a2n1))*sinh(a3n1)*cosh(a2n1)/(m3*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1) - cos(b2n1)*cos(b3n1))*(-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sinh(a3n1)*cosh(a2n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)) - (-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a3n1)*cosh(a2n1) - cos(b2n1)*cos(b3n1)*sinh(a3n1)*cosh(a2n1) + sinh(a2n1)*cosh(a3n1))*sinh(a2n1)*cosh(a3n1)/(m2*sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)))/sqrt((-sin(b2n1)*sin(b3n1)*cos(g2n1 - g3n1)*sinh(a2n1)*sinh(a3n1) - cos(b2n1)*cos(b3n1)*sinh(a2n1)*sinh(a3n1) + cosh(a2n1)*cosh(a3n1))**2.0 - 1)

    derivterms = [da1c1term,da1c2term,da1n1term,
                   db1c1term,db1c2term,db1n1term,
                   dg1c1term,dg1c2term,dg1n1term,
                   da2c1term,da2c2term,da2n1term,
                   db2c1term,db2c2term,db2n1term,
                   dg2c1term,dg2c2term,dg2n1term,
                   da3c1term,da3c2term,da3n1term,
                   db3c1term,db3c2term,db3n1term,
                   dg3c1term,dg3c2term,dg3n1term,
                   dad1c1term,dad1c2term,dad1n1term,
                   dbd1c1term,dbd1c2term,dbd1n1term,
                   dgd1c1term,dgd1c2term,dgd1n1term,
                   dad2c1term,dad2c2term,dad2n1term,
                   dbd2c1term,dbd2c2term,dbd2n1term,
                   dgd2c1term,dgd2c2term,dgd2n1term,
                   dad3c1term,dad3c2term,dad3n1term,
                   dbd3c1term,dbd3c2term,dbd3n1term,
                   dgd3c1term,dgd3c2term,dgd3n1term,
                   dlam1c1term,dlam1c2term,dlam1n1term, 
                   dlam2c1term,dlam2c2term,dlam2n1term,
                   dlam3c1term,dlam3c2term,dlam3n1term]

    return [mainterm, derivterms]


# triangle 2-stage template
# def s2triangletemplate(stepn,stepc1,stepc2,dt,params):
#     # Set to run RadauIIA 2-stage method
#     a11,a12 = [5./12., -1./12.]
#     a21,a22 = [3./4., 1./4.]

#     a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
#     a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
#     a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
#     m1,m2,m3,leq1,leq2,leq3 = params

#     mainterm = a1c1 - a1n - dt*(a11*ad1c1 + a12*ad1c2)

#     da1c1term   = 0.
#     da1c2term   = 0.
#     db1c1term   = 0.
#     db1c2term   = 0.
#     dg1c1term   = 0.
#     dg1c2term   = 0.
#     da2c1term   = 0.
#     da2c2term   = 0.
#     db2c1term   = 0.
#     db2c2term   = 0.
#     dg2c1term   = 0.
#     dg2c2term   = 0.
#     da3c1term   = 0.
#     da3c2term   = 0.
#     db3c1term   = 0.
#     db3c2term   = 0.
#     dg3c1term   = 0.
#     dg3c2term   = 0.
#     dad1c1term  = 0.
#     dad1c2term  = 0.
#     dbd1c1term  = 0.
#     dbd1c2term  = 0.
#     dgd1c1term  = 0.
#     dgd1c2term  = 0.
#     dad2c1term  = 0.
#     dad2c2term  = 0.
#     dbd2c1term  = 0.
#     dbd2c2term  = 0.
#     dgd2c1term  = 0.
#     dgd2c2term  = 0.
#     dad3c1term  = 0.
#     dad3c2term  = 0.
#     dbd3c1term  = 0.
#     dbd3c2term  = 0.
#     dgd3c1term  = 0.
#     dgd3c2term  = 0.
#     dlam1c1term = 0.
#     dlam1c2term = 0.
#     dlam2c1term = 0.
#     dlam2c2term = 0.
#     dlam3c1term = 0.
#     dlam3c2term = 0.

#     derivterms = [da1c1term,da1c2term,
#                    db1c1term,db1c2term, 
#                    dg1c1term,dg1c2term, 
#                    da2c1term,da2c2term, 
#                    db2c1term,db2c2term, 
#                    dg2c1term,dg2c2term,  
#                    da3c1term,da3c2term, 
#                    db3c1term,db3c2term, 
#                    dg3c1term,dg3c2term, 
#                    dad1c1term,dad1c2term, 
#                    dbd1c1term,dbd1c2term, 
#                    dgd1c1term,dgd1c2term, 
#                    dad2c1term,dad2c2term, 
#                    dbd2c1term,dbd2c2term, 
#                    dgd2c1term,dgd2c2term, 
#                    dad3c1term,dad3c2term, 
#                    dbd3c1term,dbd3c2term, 
#                    dgd3c1term,dgd3c2term, 
#                    dlam1c1term,dlam1c2term, 
#                    dlam2c1term,dlam2c2term, 
#                    dlam3c1term,dlam3c2term]

#     return [mainterm, derivterms]

# triangle 3-stage template
# def s3triangletemplate(stepn,stepc1,stepc2,stepn1,dt,params):
#     root6 = sqrt(6.)
#     # Set to run RadauIIA 3-stage method
#     a11,a12,a13 = [(88.-7.*root6)/360., (296.-169.*root6)/1800., (-2.+3.*root6)/225.]
#     a21,a22,a23 = [(296.+169.*root6)/1800., (88.+7.*root6)/360., (-2.-3.*root6)/225.]
#     a31,a32,a33 = [(16.-root6)/36., (16.+root6)/36., 1./9.]
#     bs1,bs2,bs3 = [(16.-root6)/36., (16.+root6)/36., 1./9.]

#     a1n,b1n,g1n,a2n,b2n,g2n,a3n,b3n,g3n,ad1n,bd1n,gd1n,ad2n,bd2n,gd2n,ad3n,bd3n,gd3n,lam1n,lam2n,lam3n = stepn
#     a1c1,b1c1,g1c1,a2c1,b2c1,g2c1,a3c1,b3c1,g3c1,ad1c1,bd1c1,gd1c1,ad2c1,bd2c1,gd2c1,ad3c1,bd3c1,gd3c1,lam1c1,lam2c1,lam3c1 = stepc1
#     a1c2,b1c2,g1c2,a2c2,b2c2,g2c2,a3c2,b3c2,g3c2,ad1c2,bd1c2,gd1c2,ad2c2,bd2c2,gd2c2,ad3c2,bd3c2,gd3c2,lam1c2,lam2c2,lam3c2 = stepc2
#     a1n1,b1n1,g1n1,a2n1,b2n1,g2n1,a3n1,b3n1,g3n1,ad1n1,bd1n1,gd1n1,ad2n1,bd2n1,gd2n1,ad3n1,bd3n1,gd3n1,lam1n1,lam2n1,lam3n1 = stepn1
#     m1,m2,m3,leq1,leq2,leq3 = params

#     mainterm = a1c1 - a1n - dt*(a11*ad1c1 + a12*ad1c2)

#     da1c1term   = 0.
#     da1c2term   = 0.
#     da1n1term   = 0.
#     db1c1term   = 0.
#     db1c2term   = 0.
#     db1n1term   = 0.
#     dg1c1term   = 0.
#     dg1c2term   = 0.
#     dg1n1term   = 0.
#     da2c1term   = 0.
#     da2c2term   = 0.
#     da2n1term   = 0.
#     db2c1term   = 0.
#     db2c2term   = 0.
#     db2n1term   = 0.
#     dg2c1term   = 0.
#     dg2c2term   = 0.
#     dg2n1term   = 0.
#     da3c1term   = 0.
#     da3c2term   = 0.
#     da3n1term   = 0.
#     db3c1term   = 0.
#     db3c2term   = 0.
#     db3n1term   = 0.
#     dg3c1term   = 0.
#     dg3c2term   = 0.
#     dg3n1term   = 0.
#     dad1c1term  = 0.
#     dad1c2term  = 0.
#     dad1n1term  = 0.
#     dbd1c1term  = 0.
#     dbd1c2term  = 0.
#     dbd1n1term  = 0.
#     dgd1c1term  = 0.
#     dgd1c2term  = 0.
#     dgd1n1term  = 0.
#     dad2c1term  = 0.
#     dad2c2term  = 0.
#     dad2n1term  = 0.
#     dbd2c1term  = 0.
#     dbd2c2term  = 0.
#     dbd2n1term  = 0.
#     dgd2c1term  = 0.
#     dgd2c2term  = 0.
#     dgd2n1term  = 0.
#     dad3c1term  = 0.
#     dad3c2term  = 0.
#     dad3n1term  = 0.
#     dbd3c1term  = 0.
#     dbd3c2term  = 0.
#     dbd3n1term  = 0.
#     dgd3c1term  = 0.
#     dgd3c2term  = 0.
#     dgd3n1term  = 0.
#     dlam1c1term = 0.
#     dlam1c2term = 0.
#     dlam1n1term = 0.
#     dlam2c1term = 0.
#     dlam2c2term = 0.
#     dlam2n1term = 0.
#     dlam3c1term = 0.
#     dlam3c2term = 0.
#     dlam3n1term = 0.

#     derivterms = [da1c1term,da1c2term,da1n1term,
#                    db1c1term,db1c2term,db1n1term,
#                    dg1c1term,dg1c2term,dg1n1term,
#                    da2c1term,da2c2term,da2n1term,
#                    db2c1term,db2c2term,db2n1term,
#                    dg2c1term,dg2c2term,dg2n1term,
#                    da3c1term,da3c2term,da3n1term,
#                    db3c1term,db3c2term,db3n1term,
#                    dg3c1term,dg3c2term,dg3n1term,
#                    dad1c1term,dad1c2term,dad1n1term,
#                    dbd1c1term,dbd1c2term,dbd1n1term,
#                    dgd1c1term,dgd1c2term,dgd1n1term,
#                    dad2c1term,dad2c2term,dad2n1term,
#                    dbd2c1term,dbd2c2term,dbd2n1term,
#                    dgd2c1term,dgd2c2term,dgd2n1term,
#                    dad3c1term,dad3c2term,dad3n1term,
#                    dbd3c1term,dbd3c2term,dbd3n1term,
#                    dgd3c1term,dgd3c2term,dgd3n1term,
#                    dlam1c1term,dlam1c2term,dlam1n1term, 
#                    dlam2c1term,dlam2c2term,dlam2n1term,
#                    dlam3c1term,dlam3c2term,dlam3n1term]

#     return [mainterm, derivterms]




